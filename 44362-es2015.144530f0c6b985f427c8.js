(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[44362],{37718:function(t,i,e){"use strict";e.d(i,{J:function(){return v}});var n=e(29609),o=e(55959),a=e(79996),r=e(47701),s=e(44019),l=e(45908);class d{constructor(t,i,e,n,o,a,r,s,d,c,u,g,p,m,h,f,b,y,v,N,D,Z,x,A,I,M,C,P,w,T,q){switch(this.hasUnreadedNotes=p,this.isCalculated=i,this.assignedExerciseProgramDays=f,this.traineeId=t,this.traineeName=e,this.mobile=n,this.sex=o===l.Y0.Female?"::Female":"::Male",this.age=a,this.startDate=r,this.traineePhotoAttachmentId=h,this.programEndDate=c,this.paid=b,this.packageType=m,this.packageTypeName=y,this.coordinator=u,this.coachAppUserName=g,this.assignExerciseForFutuerAlert=v,this.assignNutritionForFutuerAlert=N,this.subscriptionDate=D,this.subscriptionStatus=Z,this.hasAssignedExerciseProgram=x,this.hasAssignedNutritionProgram=A,this.fatProgress=I,this.varTargetDaysMeasured=M,this.musclesProgress=C,this.targetProgress=P,this.hasExerciseToday=w,this.hasNutritionToday=T,this.coachNote=q,this.exerciseIsDone=m===l.ij.Exercise||m===l.ij.ExerciseAndNutrition?s:-1,this.nutritionIsDone=m===l.ij.Nutrition||m===l.ij.ExerciseAndNutrition?d:-1,m){case l.ij.Exercise:this.packageTypeName="Exercise";break;case l.ij.Nutrition:this.packageTypeName="ANutrition";break;case l.ij.ExerciseAndNutrition:this.packageTypeName="ExerciseAndNutrition"}}}var c=e(28450),u=e(95965),g=e(35366),p=e(55679),m=e(46700);let h=(()=>{class t{constructor(){this.queue=[]}push(t){this.queue.push(t)}pop(){return 0===this.queue.length?null:this.queue.shift()}clear(){this.queue=[]}size(){return this.queue.length}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=g.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=e(43117),b=e(23915),y=e(28157);let v=(()=>{class t{constructor(t,i,e,l,g,p){this.confirmation=t,this.localizationService=i,this.queueService=e,this.localCacheService=l,this.perf=g,this.traineeService=p,this.currentDate=new o.xQ,this.traineeFilter=new o.xQ,this.traineeFilter2=new o.xQ,this.getRefreshTrainee=t=>this.traineeService.getRefreshTrainee(t),this.updateTraineeOverviewByInput=t=>this.traineeService.updateTraineeOverviewByInput(t),this.getGeneralStatistics=()=>this.traineeService.getGeneralStatistics(),this.getTraineeProfileSummary=t=>(console.log("getTraineeProfileSummary"),this.getGetTraineeProfileGeneralById(t).pipe((0,a.U)(t=>t.profileSummary))),this.getSimpleListSummary=t=>this.traineeService.getSimpleListSummary(t),this.getTraineeOverviewBasicInfo=t=>(console.log("getTraineeOverviewBasicInfo"),this.getGetTraineeProfileGeneralById(t).pipe((0,r.b)(100)).pipe((0,a.U)(t=>t.basicInfo))),this.weight=0,this.getGetTraineeProfileGeneralById=t=>{console.log("getGetTraineeProfileGeneralById");const i=this,e=`GetTraineeProfileGeneral${t}`;return this.traineeService.getGetTraineeProfileGeneralById(t).pipe((0,c.z)(i.localCacheService,e,3)).pipe((0,u.S)(i.perf,"TraineeProfile")).pipe((0,s.b)(t=>i.weight=t.profileSummary.weight))},this.getList=t=>this.traineeService.getListByStatus(t).pipe((0,a.U)(t=>({totalCount:t.totalCount,items:t.items.map(t=>new d(t.id,t.isCalculated,t.appUserName,t.appUserPhoneNumber,t.genderGeneralLookupId,t.age,t.startDate?n(t.startDate).format("DD/MM/yyyy"):"",t.exerciseIsDone,t.nutritionIsDone,t.endDate?n(t.endDate).format("DD/MM/yyyy"):"",t.coordinatorAppUserName,t.coachAppUserName,t.hasUnreadedNotes,t.packageType,t.traineePhotoAttachmentId,t.assignedExerciseProgramDays,t.paidPrice,t.packageTypeName,t.assignExerciseForFutuerAlert,t.assignNutritionForFutuerAlert,t.subscriptionDate&&n(t.subscriptionDate).isValid()?n(t.subscriptionDate).format("DD/MM/yyyy"):"",t.subscriptionStatus,t.hasAssignedExerciseProgram,t.hasAssignedNutritionProgram,t.fatProgress,t.varTargetDaysMeasured,t.musclesProgress,t.targetProgress,t.hasExerciseToday,t.hasNutritionToday,t.coachNote))}))),this.exportListPayments=this.traineeService.exportListPayments,this.getListPayments=t=>this.traineeService.getListPayments(t).pipe((0,a.U)(t=>({totalCount:t.totalCount,items:t.items.map(t=>new d(t.id,t.isCalculated,t.appUserName,t.appUserPhoneNumber,t.genderGeneralLookupId,t.age,t.startDate?n(t.startDate).format("DD/MM/yyyy"):"",t.exerciseIsDone,t.nutritionIsDone,t.endDate?n(t.endDate).format("DD/MM/yyyy"):"",t.coordinatorAppUserName,t.coachAppUserName,t.hasUnreadedNotes,t.packageType,t.traineePhotoAttachmentId,t.assignedExerciseProgramDays,t.paidPrice,t.packageTypeName,t.assignExerciseForFutuerAlert,t.assignNutritionForFutuerAlert,t.subscriptionDate&&n(t.subscriptionDate).isValid()?n(t.subscriptionDate).format("DD/MM/yyyy"):"",t.subscriptionStatus,t.hasAssignedExerciseProgram,t.hasAssignedNutritionProgram,t.fatProgress,t.varTargetDaysMeasured,t.musclesProgress,t.targetProgress,t.hasExerciseToday,t.hasNutritionToday,t.coachNote))})))}ChangeFilter(t){this.traineeFilter.next(t)}ChangeFilter2(t){this.traineeFilter2.next(t)}enqueCachedItem(t){}processQueue(){}clearUserCache(t){this.localCacheService.put(`GetTraineeProfileGeneral${t}`,null)}}return t.\u0275fac=function(i){return new(i||t)(g.LFG(p.YP),g.LFG(m.oQ8),g.LFG(h),g.LFG(f.F),g.LFG(b.WC),g.LFG(y.s))},t.\u0275prov=g.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},16952:function(t,i,e){"use strict";e.r(i),e.d(i,{AssignedNutritionProgramDayModule:function(){return f}});var n=e(69244),o=e(46700),a=e(55679),r=e(10135),s=e(99046),l=e(83845),d=e(73756),c=e(56410),u=e(35366);const g=[];let p=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[c.Bz.forChild(g)],c.Bz]}),t})();var m=e(56137),h=e(88562);let f=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[p,o.IR2,a.e2,d.Ck,l.vv,s.h2,r.lQ,r.M,h.NutritionModule,n._t,m.m,r.XC]]}),t})()},44362:function(t,i,e){"use strict";e.r(i),e.d(i,{AssignedNutritionProgramModule:function(){return b}});var n=e(46700),o=e(55679),a=e(10135),r=e(99046),s=e(83845),l=e(73756),d=e(56410),c=e(39829),u=e(35366);const g=[{path:"assigned/:id",component:c.e,canActivate:[n.a1M,n.nG9]}];let p=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[d.Bz.forChild(g)],d.Bz]}),t})();var m=e(56137),h=e(56874),f=e(16952);let b=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.oAB({type:t}),t.\u0275inj=u.cJS({imports:[[p,n.IR2,o.e2,l.Ck,s.vv,r.h2,a.lQ,a.M,m.m,a.XC,h.e,f.AssignedNutritionProgramDayModule]]}),t})()},6194:function(t,i,e){"use strict";e.d(i,{v:function(){return U}});var n=e(55679),o=e(31041),a=e(2996),r=e(11520),s=e(43835),l=e(44689),d=e(35366),c=e(46700),u=e(28157),g=e(94773),p=e(43117),m=e(73545),h=e(71149),f=e(99046),b=e(61116),y=e(55794),v=e(23733),N=e(42163),D=e(28451),Z=e(40739);function x(t,i){if(1&t&&(d.TgZ(0,"h3"),d._uU(1),d.ALo(2,"abpLocalization"),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.hij(" ",d.lcZ(2,1,t.selected?"AbpUi::Edit":"::AssignNutritionProgram")," ")}}function A(t,i){1&t&&(d.TgZ(0,"div",21),d._uU(1),d.ALo(2,"abpLocalization"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"::AllProgramsIncluded")," "))}function I(t,i){1&t&&(d.TgZ(0,"div",12),d.TgZ(1,"label",22),d._uU(2),d.ALo(3,"abpLocalization"),d.qZA(),d._UZ(4,"sw-date-picker",23),d.qZA()),2&t&&(d.xp6(2),d.hij(" ",d.lcZ(3,1,"::StartDate")," "))}function M(t,i){if(1&t&&(d.TgZ(0,"span",30),d._uU(1),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.selectionCount," ")}}function C(t,i){1&t&&(d.TgZ(0,"span",31),d._uU(1),d.ALo(2,"abpLocalization"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"::FromDateGrid")," "))}function P(t,i){if(1&t&&(d.TgZ(0,"span",32),d._uU(1),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(1),d.Oqu(t.caloriesFrom)}}function w(t,i){1&t&&(d.TgZ(0,"span"),d._uU(1),d.ALo(2,"abpLocalization"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"::ToDateGrid")," "))}function T(t,i){if(1&t&&(d.TgZ(0,"span",32),d._uU(1),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(1),d.Oqu(t.caloriesTo)}}function q(t,i){1&t&&(d.TgZ(0,"span",33),d._uU(1),d.ALo(2,"abpLocalization"),d.qZA()),2&t&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"::Calories")," "))}function O(t,i){if(1&t&&(d.TgZ(0,"p",24),d._uU(1),d.YNc(2,M,2,1,"span",25),d.qZA(),d.TgZ(3,"p"),d.YNc(4,C,3,3,"span",26),d.YNc(5,P,2,1,"span",27),d.YNc(6,w,3,3,"span",28),d.YNc(7,T,2,1,"span",27),d.YNc(8,q,3,3,"span",29),d.qZA()),2&t){const t=i.$implicit,e=d.oxw(2);d.xp6(1),d.hij(" ",e.langService.isRtl?t.nutriitionProgramName:t.nutriitionProgramNameEn," "),d.xp6(1),d.Q6J("ngIf",t.selectionCount>0),d.xp6(2),d.Q6J("ngIf",t.caloriesFrom&&t.caloriesTo),d.xp6(1),d.Q6J("ngIf",t.caloriesFrom),d.xp6(1),d.Q6J("ngIf",t.caloriesFrom&&t.caloriesTo),d.xp6(1),d.Q6J("ngIf",t.caloriesTo),d.xp6(1),d.Q6J("ngIf",t.caloriesFrom&&t.caloriesTo)}}const S=function(){return{standalone:!0}};function _(t,i){if(1&t){const t=d.EpF();d.TgZ(0,"form",3),d.NdJ("ngSubmit",function(){return d.CHM(t),d.oxw().submitForm()}),d.TgZ(1,"div",4),d.TgZ(2,"div",5),d.YNc(3,A,3,3,"div",6),d.qZA(),d.YNc(4,I,5,3,"div",7),d.TgZ(5,"div",8),d.TgZ(6,"label",9),d._uU(7),d.ALo(8,"abpLocalization"),d.qZA(),d.TgZ(9,"span",10),d._uU(10),d.qZA(),d.TgZ(11,"input",11),d.NdJ("ngModelChange",function(i){return d.CHM(t),d.oxw().userTdee=i}),d.qZA(),d.qZA(),d.TgZ(12,"div",12),d.TgZ(13,"label",13),d._uU(14),d.ALo(15,"abpLocalization"),d.qZA(),d.TgZ(16,"p-autoComplete",14),d.NdJ("onClear",function(){return d.CHM(t),d.oxw().onClear()})("completeMethod",function(i){return d.CHM(t),d.oxw().startSearchProgram(i)})("search",function(i){return d.CHM(t),d.oxw().startSearchProgram(i)}),d.ALo(17,"abpLocalization"),d.YNc(18,O,9,7,"ng-template",15),d.qZA(),d.qZA(),d.qZA(),d.TgZ(19,"div",16),d.TgZ(20,"button",17,18),d._uU(22),d.ALo(23,"abpLocalization"),d.qZA(),d.TgZ(24,"button",19),d._UZ(25,"i",20),d._uU(26),d.ALo(27,"abpLocalization"),d.qZA(),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.Q6J("formGroup",t.form),d.xp6(3),d.Q6J("ngIf",t.allProgramsIncluded),d.xp6(1),d.Q6J("ngIf",!t.isMutipleAssign),d.xp6(3),d.hij(" ",d.lcZ(8,16,"::TDEE")," "),d.xp6(3),d.hij(" ",t.userTdee," "),d.xp6(1),d.Q6J("step",1)("ngModel",t.userTdee)("ngModelOptions",d.DdM(26,S)),d.xp6(3),d.hij(" ",d.lcZ(15,18,"::NutritionProgram")," "),d.xp6(2),d.s9C("placeholder",d.lcZ(17,20,"::NutritionProgram")),d.Q6J("suggestions",t.AllPrograms)("type",t.searchType())("dropdown",!0)("field",t.langService.isRtl?"nutriitionProgramName":"nutriitionProgramNameEn"),d.xp6(6),d.hij(" ",d.lcZ(23,22,"AbpUi::Cancel")," "),d.xp6(4),d.hij(" ",d.lcZ(27,24,"::Ok")," ")}}let U=(()=>{class t{constructor(t,i,e,n,o,a,r,s,l,d,c,u){this.list=t,this.track=i,this.traineeService=e,this.service=n,this.localCacheService=o,this.confirmation=a,this.dateService=r,this.langService=s,this.l=l,this.toaster=d,this.assignNutritionProgramService=c,this.fb=u,this.isModalBusy=!1,this.isModalOpen=!1,this.filters={},this.isMutipleAssign=!1,this.allProgramsIncluded=!1,this._userTdee=0}ngOnInit(){}buildForm(){var t;const{nutritionProgramId:i}=(null===(t=this.selected)||void 0===t?void 0:t.assignedNutritionProgram)||{};this.form=this.fb.group({nutritionProgramId:[null!=i?i:null,[o.kI.required]],users:[[]],startDate:[void 0,[o.kI.required]]})}createUser(){return this.fb.group({value:"",label:""})}hideForm(){this.isModalOpen=!1,setTimeout(()=>{this.form.reset()},100)}showForm(){this.buildForm(),this.isModalOpen=!0,this.getTdeeForUser()}submitFormInternalForMultiple(){const t=this;let i={items:[]},e=this.form.get("nutritionProgramId").value;e&&e.id&&(e=e.id),this.mutipleAssignItems.filter(t=>t.isSelected&&t.startSateTraining).forEach(t=>{const n={};n.nutritionProgramId=e,n.startDate=t.startSateTraining,n.traineeId=t.id,i.items.push(n)}),this.service.assignMultipleByAssignInput(i).subscribe(i=>{if(t.clearStorage(),t.localCacheService.tempDisable(60),i.scheduled>0){const e=this.l.instant("::ProgramScheduledSuccessFullyFor",i.scheduled.toString());t.toaster.success(e)}if(i.succeeded>0){const e=this.l.instant("::ProgramAssignedSuccessFullyFor",i.succeeded.toString());t.toaster.info(e)}if(i.faild>0){const e=this.l.instant("::ProgramAssignedFailedFor",i.faild.toString());t.toaster.error(e)}t.assignNutritionProgramService.onAssigned.emit(e),setTimeout(()=>{t.hideForm()},1)})}clearStorage(){for(var t in console.log("clearing storage"),this.localCacheService.clearAll(),localStorage)t.startsWith("assinged_")&&localStorage.removeItem(t)}submitForm(){this.submitFormInternal(!1)}submitFormInternal(t){let i=this;if(this.isMutipleAssign)return void this.submitFormInternalForMultiple();if(this.form.invalid)return;this.filters.nutritionProgramId=this.form.get("nutritionProgramId").value;let e=this.filters.nutritionProgramId;e&&e.id&&(e=e.id),this.filters.nutritionProgramId=e,this.filters.nutritionProgramId||(this.filters.nutritionProgramId=void 0);let o=this.form.get("startDate").value;this.filters.startDate=this.dateService.parseMomentToString(o),this.filters.isOverride=t,this.service.assignByAssignInput(this.filters).pipe((0,r.x)(()=>this.isModalBusy=!1)).subscribe(t=>{t?(setTimeout(()=>{i.assignNutritionProgramService.onAssigned.emit(i.filters.nutritionProgramId)},2),i.toaster.success("::ProgramAssignedSuccessFully"),setTimeout(()=>{i.hideForm()},1)):i.confirmation.warn("::ProgramOverride","::AreYouSure",{messageLocalizationParams:[]}).pipe((0,s.h)(t=>t===n.Tv.Status.confirm),(0,l.w)(()=>(i.submitFormInternal(!0),null))).subscribe(()=>{})})}getAssignDate(t,i){const e=this;if(null==i)this.service.getNextProgramStartDaysByTraineeUserId(t).subscribe(n=>{i=n.startDays;let o=new Date;null!=i&&(o=this.addDays(o,i));let a=o.toLocalISOString();e.assignNutritionProgramService.onGetAssignDate.emit({id:t,dateString:a})});else{i++;let n=new Date;null!=i&&(n=this.addDays(n,i));let o=n.toLocalISOString();e.assignNutritionProgramService.onGetAssignDate.emit({id:t,dateString:o})}}autoAssigne(t,i,e){null==e?(this.service.getNextProgramStartDaysByTraineeUserId(t).subscribe(t=>{e=t.startDays}),this.autoAssigneInternal(t,i,e)):(e>0&&e++,this.autoAssigneInternal(t,i,e||0))}autoAssigneInternal(t,i,e){let n=new Date;null!=e&&(n=this.addDays(n,e));let o=this,a=this.dateService.parseMomentToString(n);this.service.assignByAssignInput({nutritionProgramId:i,isOverride:!0,traineeId:t,startDate:a}).subscribe(t=>{o.localCacheService.clearAll(),o.assignNutritionProgramService.onAssigned.emit(o.filters.nutritionProgramId)})}create(t,i){const e=this;this.filters.traineeId=t,this.selected=void 0,this.showForm();let n=new Date;if(null!=i){i>0&&i++,n=this.addDays(n,i);let t=this.dateService.dateToMoment(n);this.form.get("startDate").setValue(t)}else this.service.getNextProgramStartDaysByTraineeUserId(t).subscribe(t=>{n=e.addDays(n,i=t.startDays);let o=e.dateService.dateToMoment(n);e.form.get("startDate").setValue(o)})}createMultiple(t){this.filters.traineeId=void 0,this.isMutipleAssign=!0,this.selected=void 0,this.mutipleAssignItems=t,this.showForm(),this.form.get("startDate").setValue(new Date)}addDays(t,i){if(0===i)return t;var e=new Date(t);return e.setDate(e.getDate()+i),e}get userTdee(){return this._userTdee}set userTdee(t){t!=this._userTdee&&(this.AllPrograms=[],this.form&&this.form.get("nutritionProgramId").setValue(void 0)),this._userTdee=t}getTdeeForUser(){let t={};t.traineeId=this.filters.traineeId,t.traineeId&&t.traineeId>0&&this.traineeService.getTraineeIntensityLevelForUserByInput(t).subscribe(t=>{this.userTdee=t.tdee})}startSearchProgram(t){this.service.getNutritionProgramLookup(t.query,this.filters.traineeId,this.userTdee,!1).subscribe(t=>{this.AllPrograms=t.items,this.allProgramsIncluded=t.allProgramsIncluded})}onSelect(t){}onClear(){this.filters.nutritionProgramId=void 0}searchType(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)?"text":"search"}}return t.\u0275fac=function(i){return new(i||t)(d.Y36(c.XNV),d.Y36(c.vR3),d.Y36(u.s),d.Y36(g.Jq),d.Y36(p.F),d.Y36(n.YP),d.Y36(a.R),d.Y36(m.C),d.Y36(c.oQ8),d.Y36(n.MJ),d.Y36(h.v),d.Y36(o.qu))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-assign-nutrition-program"]],outputs:{getAssignDate:"getAssignDate",autoAssigne:"autoAssigne",create:"create",createMultiple:"createMultiple"},features:[d._Bn([a.R])],decls:5,vars:2,consts:[["size","md",3,"busy","visible","visibleChange"],["abpHeader",""],["abpBody",""],["validateOnSubmit","",1,"app-assign-nutrition-program",3,"formGroup","ngSubmit"],[1,"mt-2","fade-in-top","row"],[1,"col-12"],["class","alert alert-warning",4,"ngIf"],["class","form-group col-md-12",4,"ngIf"],[1,"form-group","col-12"],["for","exercise-program-tdee"],[1,"float-right"],["type","range","min","1","max","4000","id","exercise-program-tdee","name","tdee",1,"form-control-range",3,"step","ngModel","ngModelOptions","ngModelChange"],[1,"form-group","col-md-12"],["for","app-user-coordinator-app-user-id",2,"display","block"],["formControlName","nutritionProgramId","styleClass","dropdown-with-table","id","coachAppUserId","name","coachAppUserId","dataKey","id","forceSelection","true",1,"",3,"suggestions","type","dropdown","placeholder","field","onClear","completeMethod","search"],["pTemplate","item"],[1,"col-12","modal-footer"],["type","button",1,"btn","btn-secondary","btn-cancel"],["abpClose",""],["type","submit",1,"btn","btn-success","btn-save"],[1,"fa","fa-check"],[1,"alert","alert-warning"],["for","app-user-coordinator-app-user-id"],["id","startDate","formControlName","startDate","name","startDate"],[1,"program-name"],["class","badge badge-secondary","style","display: inline-block;",4,"ngIf"],["class","d-none d-sm-inline",4,"ngIf"],["class","badge badge-secondary",4,"ngIf"],[4,"ngIf"],["class","calories",4,"ngIf"],[1,"badge","badge-secondary",2,"display","inline-block"],[1,"d-none","d-sm-inline"],[1,"badge","badge-secondary"],[1,"calories"]],template:function(t,i){1&t&&(d.TgZ(0,"abp-modal",0),d.NdJ("visibleChange",function(t){return i.isModalOpen=t}),d.YNc(1,x,3,3,"ng-template",null,1,d.W1O),d.YNc(3,_,28,27,"ng-template",null,2,d.W1O),d.qZA()),2&t&&d.Q6J("busy",i.isModalBusy)("visible",i.isModalOpen)},directives:[n.zS,o._Y,o.JL,c.YzZ,o.sg,f.hL,b.O5,o.eT,o.Fj,y.a,o.JJ,v.m,o.On,N.Qc,o.u,f.J5,D.jx,Z.L],pipes:[c.fuE],styles:["@media (max-width:768px){  .app-assign-nutrition-program .p-autocomplete-panel{max-width:100%}}  .app-assign-nutrition-program .program-name{white-space:normal}  .app-assign-nutrition-program .badge{min-width:40px;font-size:90%;text-align:center}  .app-assign-nutrition-program .calories{font-size:80%;display:inline-block;width:30px;white-space:normal;line-height:9px;vertical-align:sub;padding-right:5px;color:#999}"]}),t})()},71149:function(t,i,e){"use strict";e.d(i,{v:function(){return o}});var n=e(35366);let o=(()=>{class t{constructor(){this.onAssigned=new n.vpe,this.onGetAssignDate=new n.vpe}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac}),t})()},39829:function(t,i,e){"use strict";e.d(i,{e:function(){return Kt}});var n=e(46700),o=e(35366),a=e(2996),r=e(67917),s=e(83865),l=e(77266),d=e(71149),c=e(62914),u=e(28450),g=e(65122),p=e(94773),m=e(55679),h=e(56410),f=e(43117),b=e(73545),y=e(31041),v=e(61116),N=e(69244),D=e(42373),Z=e(43252),x=e(37718),A=e(53181),I=e(57066),M=e(23733),C=e(42163),P=e(99046),w=e(9445),T=e(52201);function q(t,i){1&t&&(o.TgZ(0,"h3"),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"::Meals")))}function O(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"legend",40),o._uU(1),o.TgZ(2,"button",41),o.NdJ("click",function(){return o.CHM(t),o.oxw().$implicit.isEditingMealName=!0}),o._UZ(3,"i",42),o.qZA(),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.xp6(1),o.hij("",t.name," ")}}function S(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"legend",40),o.TgZ(1,"div",43),o.TgZ(2,"input",44),o.NdJ("ngModelChange",function(i){return o.CHM(t),o.oxw().$implicit.name=i}),o.qZA(),o.TgZ(3,"div",45),o.TgZ(4,"button",46),o.NdJ("click",function(){return o.CHM(t),o.oxw().$implicit.isEditingMealName=!1}),o._UZ(5,"i",47),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.xp6(2),o.Q6J("ngModel",t.name)}}function _(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",27),o.NdJ("click",function(){return o.CHM(t),o.oxw().$implicit.selectedOptionId=2}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.ekj("active",2===t.selectedOptionId),o.xp6(1),o.hij(" ",o.lcZ(2,3,"::Option2")," ")}}function U(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",27),o.NdJ("click",function(){return o.CHM(t),o.oxw().$implicit.selectedOptionId=3}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.ekj("active",3===t.selectedOptionId),o.xp6(1),o.hij(" ",o.lcZ(2,3,"::Option3")," ")}}function k(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",48),o.NdJ("click",function(){return o.CHM(t),o.oxw().$implicit.addOption()}),o._UZ(1,"i",49),o.qZA()}}function L(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",24),o.NdJ("click",function(){o.CHM(t);const i=o.oxw(),e=i.$implicit,n=i.index,a=o.oxw().$implicit;return o.oxw(3).down(e,a,n,a.selectedOptionId)}),o._UZ(1,"i",25),o.qZA()}}function F(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",24),o.NdJ("click",function(){o.CHM(t);const i=o.oxw(),e=i.$implicit,n=i.index,a=o.oxw().$implicit;return o.oxw(3).up(e,a,n,a.selectedOptionId)}),o._UZ(1,"i",26),o.qZA()}}const J=function(t){return{attachmentId:t,entity:"Nutrition"}};function Y(t,i){if(1&t&&(o.TgZ(0,"div"),o._UZ(1,"img",70),o.ALo(2,"async"),o.ALo(3,"imgdownload"),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.Q6J("src",o.lcZ(2,2,o.lcZ(3,4,o.VKq(6,J,t.getImage()))),o.LSH)("title",t.getImage())}}function E(t,i){if(1&t&&(o.TgZ(0,"div",71),o.TgZ(1,"span",72),o._uU(2),o.qZA(),o.TgZ(3,"span",73),o._uU(4),o.qZA(),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(2),o.Oqu(null==t||null==t.nutrition?null:t.nutrition.nutritionName),o.xp6(2),o.Oqu(null==t||null==t.nutrition?null:t.nutrition.nutritionNameEn)}}function Q(t,i){1&t&&o._UZ(0,"i",82)}function z(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"p-autoComplete",83),o.NdJ("completeMethod",function(i){return o.CHM(t),o.oxw(6).startSearchNutrition(i)})("onClear",function(){return o.CHM(t),o.oxw(6).onClear()})("search",function(i){return o.CHM(t),o.oxw(6).startSearchNutrition(i)})("ngModelChange",function(i){return o.CHM(t),o.oxw(2).$implicit.nutrition=i}),o.ALo(1,"abpLocalization"),o.qZA()}if(2&t){const t=o.oxw(2).$implicit,i=o.oxw(4);o.s9C("placeholder",o.lcZ(1,6,"::AddNutritionRequiredLabel")),o.Q6J("ngModel",t.nutrition)("dropdown",!0)("suggestions",i.AllNutritions)("type",i.searchType())("field",i.langService.isRtl?"nutritionName":"nutritionNameEn")}}function B(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",84),o.NdJ("click",function(){o.CHM(t);const i=o.oxw(2).$implicit,e=o.oxw(4),n=o.MAs(6);return e.createNewNutrition(n,i)}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"::AddNutritionIfNotExist")))}function j(t,i){1&t&&(o.TgZ(0,"div",85),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::ExcludedFoodCategory")," "))}function H(t,i){if(1&t&&(o.TgZ(0,"option",89),o._uU(1),o.qZA()),2&t){const t=i.$implicit,e=o.oxw(7);o.Q6J("ngValue",t),o.xp6(1),o.Oqu(e.langService.isRtl?t.nutritionName:t.nutritionNameEn)}}const $=function(){return{standalone:!0}};function G(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",86),o.TgZ(1,"div",87),o.TgZ(2,"label",75),o._uU(3),o.ALo(4,"abpLocalization"),o.qZA(),o.TgZ(5,"select",88),o.NdJ("ngModelChange",function(i){return o.CHM(t),o.oxw(2).$implicit.nutrition=i}),o._UZ(6,"option",89),o.YNc(7,H,2,2,"option",90),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(2).$implicit,i=o.oxw(4);o.xp6(3),o.Oqu(o.lcZ(4,4,"::AddNutritionRequiredLabel")),o.xp6(2),o.Q6J("ngModel",t.nutrition)("ngModelOptions",o.DdM(6,$)),o.xp6(2),o.Q6J("ngForOf",i.AllNutritions)}}const V=function(t){return{"has-error":t}};function R(t,i){if(1&t&&(o.TgZ(0,"div",74),o.TgZ(1,"label",75),o._uU(2),o.ALo(3,"abpLocalization"),o.YNc(4,Q,1,0,"i",76),o.qZA(),o.TgZ(5,"div",77),o.YNc(6,z,2,8,"p-autoComplete",78),o.YNc(7,B,3,3,"button",79),o.YNc(8,j,3,3,"div",80),o.qZA(),o.YNc(9,G,8,7,"div",81),o.qZA()),2&t){const t=o.oxw().$implicit,i=o.oxw(4);o.xp6(2),o.hij("",o.lcZ(3,7,"::AddNutritionRequiredLabel")," "),o.xp6(2),o.Q6J("ngIf",16===(null==t||null==t.nutrition?null:t.nutrition.statusGeneralLookupId)),o.xp6(1),o.Q6J("ngClass",o.VKq(9,V,t.nutritionIsInvalid())),o.xp6(1),o.Q6J("ngIf",!i.isMobile),o.xp6(1),o.Q6J("ngIf",i.isShowAddingNutrition),o.xp6(1),o.Q6J("ngIf",i.isDislikedNutrition(t.nutrition)),o.xp6(1),o.Q6J("ngIf",i.isMobile)}}function W(t,i){if(1&t&&(o.TgZ(0,"div",71),o._uU(1),o.ALo(2,"number"),o.TgZ(3,"span",72),o._uU(4),o.qZA(),o.TgZ(5,"span",73),o._uU(6),o.qZA(),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.hij(" ",o.xi3(2,3,t.quantity,"1.0-1")," "),o.xp6(3),o.Oqu(null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitName),o.xp6(2),o.Oqu(null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitNameEn)}}function X(t,i){if(1&t&&(o.TgZ(0,"span",72),o._uU(1),o.qZA()),2&t){const t=o.oxw(2).$implicit;o.xp6(1),o.Oqu(null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitName)}}function K(t,i){if(1&t&&(o.TgZ(0,"span",73),o._uU(1),o.qZA()),2&t){const t=o.oxw(2).$implicit;o.xp6(1),o.Oqu(null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitNameEn)}}function tt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",74),o.TgZ(1,"label"),o.YNc(2,X,2,1,"span",91),o.YNc(3,K,2,1,"span",92),o.qZA(),o.TgZ(4,"input",93),o.NdJ("ngModelChange",function(i){return o.CHM(t),o.oxw().$implicit.quantity=i}),o.ALo(5,"abpLocalization"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw().$implicit;o.xp6(2),o.Q6J("ngIf",null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitName),o.xp6(1),o.Q6J("ngIf",null==t.nutrition||null==t.nutrition.unit?null:t.nutrition.unit.unitNameEn),o.xp6(1),o.s9C("placeholder",o.lcZ(5,5,"::AddQuantityRequiredLabel")),o.Q6J("ngModel",t.quantity)("ngClass",o.VKq(7,V,t.quantityIsInvalid()))}}function it(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",94),o.NdJ("click",function(){o.CHM(t);const i=o.oxw().$implicit;return i.NutritionNoteVisible=!i.NutritionNoteVisible}),o._UZ(1,"i",95),o.qZA()}}function et(t,i){if(1&t&&(o.TgZ(0,"div",37),o._UZ(1,"app-nutrition-totals",31),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.Q6J("isShowPercent",!1)("defaultCalories",t.getCalorie()||0)("proteins",(null==t?null:t.getNutritionTotals().proteins)||0)("carbs",(null==t?null:t.getNutritionTotals().carbs)||0)("fats",(null==t?null:t.getNutritionTotals().fats)||0)}}function nt(t,i){if(1&t&&(o.TgZ(0,"div",71),o._uU(1),o.qZA()),2&t){const t=o.oxw(2).$implicit;o.xp6(1),o.hij(" ",t.nutritionNote," ")}}function ot(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",74),o.TgZ(1,"input",39),o.NdJ("ngModelChange",function(i){return o.CHM(t),o.oxw(2).$implicit.nutritionNote=i}),o.ALo(2,"abpLocalization"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(2).$implicit;o.xp6(1),o.s9C("placeholder",o.lcZ(2,2,"::AddNutritionNote")),o.Q6J("ngModel",t.nutritionNote)}}function at(t,i){if(1&t&&(o.TgZ(0,"div",67),o.YNc(1,nt,2,1,"div",59),o.YNc(2,ot,3,4,"div",60),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.Q6J("ngIf",!t.isEditing),o.xp6(1),o.Q6J("ngIf",t.isEditing)}}function rt(t,i){if(1&t&&(o.TgZ(0,"div",50),o.TgZ(1,"div",9),o.TgZ(2,"div",51),o.TgZ(3,"div"),o.O4$(),o.TgZ(4,"svg",52),o._UZ(5,"path",53),o._UZ(6,"path",54),o.qZA(),o.qZA(),o.kcU(),o.TgZ(7,"div",55),o.YNc(8,L,2,0,"button",56),o._UZ(9,"br"),o.YNc(10,F,2,0,"button",56),o.qZA(),o.YNc(11,Y,4,8,"div",57),o.qZA(),o.TgZ(12,"div",58),o.TgZ(13,"div",9),o.TgZ(14,"div",58),o.YNc(15,E,5,2,"div",59),o.YNc(16,R,10,11,"div",60),o.qZA(),o.TgZ(17,"div",61),o.YNc(18,W,7,6,"div",59),o.YNc(19,tt,6,9,"div",60),o.qZA(),o.TgZ(20,"div",62),o.TgZ(21,"div",63),o.YNc(22,it,2,0,"button",64),o.TgZ(23,"button",65),o.NdJ("click",function(){return i.$implicit.delete()}),o._UZ(24,"i",21),o.TgZ(25,"span",66),o._uU(26),o.ALo(27,"abpLocalization"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(28,"div",9),o.TgZ(29,"div",67),o.YNc(30,et,2,5,"div",68),o.qZA(),o.YNc(31,at,3,2,"div",69),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t){const t=i.$implicit,e=i.index,n=o.oxw().$implicit;o.xp6(8),o.Q6J("ngIf",e>0),o.xp6(2),o.Q6J("ngIf",e<n.detailsUnDeletedForActiveOption.length-1),o.xp6(1),o.Q6J("ngIf",t.getImage()),o.xp6(4),o.Q6J("ngIf",!t.isEditing),o.xp6(1),o.Q6J("ngIf",t.isEditing),o.xp6(2),o.Q6J("ngIf",!t.isEditing),o.xp6(1),o.Q6J("ngIf",t.isEditing),o.xp6(3),o.Q6J("ngIf",null==t?null:t.nutrition),o.xp6(4),o.Oqu(o.lcZ(27,11,"AbpUi::Delete")),o.xp6(4),o.Q6J("ngIf",null==t?null:t.nutrition),o.xp6(1),o.Q6J("ngIf",null==t?null:t.NutritionNoteVisible)}}function st(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",96),o.NdJ("click",function(){o.CHM(t);const i=o.oxw().$implicit;return o.oxw(3).addNewNutrition(i)}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::AddNutrition")," "))}const lt=function(t){return{"selected-fieldset":t}};function dt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"fieldset",17),o.YNc(1,O,4,1,"legend",18),o.YNc(2,S,6,1,"legend",18),o.TgZ(3,"div",19),o.TgZ(4,"button",20),o.NdJ("click",function(){return i.$implicit.delete()}),o._UZ(5,"i",21),o.qZA(),o.qZA(),o.TgZ(6,"div",22),o.TgZ(7,"div",23),o.TgZ(8,"button",24),o.NdJ("click",function(){const i=o.CHM(t).$implicit;return o.oxw(3).assignedNutritionDayModel.down(i)}),o._UZ(9,"i",25),o.qZA(),o.TgZ(10,"button",24),o.NdJ("click",function(){const i=o.CHM(t).$implicit;return o.oxw(3).assignedNutritionDayModel.up(i)}),o._UZ(11,"i",26),o.qZA(),o.TgZ(12,"div",27),o.NdJ("click",function(){return i.$implicit.selectedOptionId=1}),o._uU(13),o.ALo(14,"abpLocalization"),o.qZA(),o.YNc(15,_,3,5,"div",28),o.YNc(16,U,3,5,"div",28),o.YNc(17,k,2,0,"div",29),o.qZA(),o.TgZ(18,"div",30),o._UZ(19,"app-nutrition-totals",31),o.qZA(),o.qZA(),o._UZ(20,"div"),o.TgZ(21,"div",32),o.NdJ("cdkDropListDropped",function(i){const e=o.CHM(t).$implicit;return o.oxw(3).drop(i,e,e.selectedOptionId)}),o.YNc(22,rt,32,13,"div",33),o.qZA(),o.TgZ(23,"div",34),o.TgZ(24,"div",23),o.YNc(25,st,3,3,"button",35),o.qZA(),o.TgZ(26,"div",36),o.TgZ(27,"div",37),o.TgZ(28,"div",38),o.TgZ(29,"input",39),o.NdJ("ngModelChange",function(t){return i.$implicit.mealNotes=t}),o.ALo(30,"abpLocalization"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=i.$implicit,e=o.oxw(3);o.Q6J("ngClass",o.VKq(23,lt,!(!e.isHasOneMeal()&&t!==e.lastAddedNutritionDayItem))),o.xp6(1),o.Q6J("ngIf",!t.isEditingMealName),o.xp6(1),o.Q6J("ngIf",t.isEditingMealName),o.xp6(10),o.ekj("active",1===t.selectedOptionId),o.xp6(1),o.hij(" ",o.lcZ(14,19,"::Option1")," "),o.xp6(2),o.Q6J("ngIf",t.GetDetailsUnDeletedForActiveOptionVisible(2)),o.xp6(1),o.Q6J("ngIf",t.GetDetailsUnDeletedForActiveOptionVisible(3)),o.xp6(1),o.Q6J("ngIf",!t.GetDetailsUnDeletedForActiveOptionVisible(3)||!t.GetDetailsUnDeletedForActiveOptionVisible(2)),o.xp6(2),o.Q6J("isShowPercent",!0)("defaultCalories",t.getCalorie()||0)("proteins",(null==t?null:t.getNutritionTotals().proteins)||0)("carbs",(null==t?null:t.getCarbs())||0)("fats",(null==t?null:t.getFats())||0),o.xp6(3),o.Q6J("ngForOf",t.detailsUnDeletedForActiveOption)("ngForTrackBy",e.trackByAssignedNutritionDayItemDetailModel),o.xp6(3),o.Q6J("ngIf",!e.isHasOneMeal()&&t!==e.lastAddedNutritionDayItem),o.xp6(4),o.s9C("placeholder",o.lcZ(30,21,"::AddMealNote")),o.Q6J("ngModel",t.mealNotes)}}function ct(t,i){if(1&t&&(o.TgZ(0,"div",97),o._uU(1),o.ALo(2,"abpLocalization"),o.ALo(3,"abpLocalization"),o.qZA()),2&t){const t=o.oxw(3);o.xp6(1),o.lnq(" ",o.lcZ(2,3,"::MaxMealsNumberIs")," ",t.programConstrains.numberOfMeals," ",o.lcZ(3,5,"::AMeal")," ")}}function ut(t,i){if(1&t&&(o.TgZ(0,"div",98),o._uU(1),o.ALo(2,"abpLocalization"),o.ALo(3,"abpLocalization"),o.ALo(4,"abpLocalization"),o.ALo(5,"abpLocalization"),o.qZA()),2&t){const t=o.oxw(3);o.xp6(1),o.gL8(" ",o.lcZ(2,6,"::AllowedCalorieRange")," ",o.lcZ(3,8,"::FromDateGrid")," ",t.programConstrains.caloriesFrom," ",o.lcZ(4,10,"::ToDateGrid")," ",t.programConstrains.caloriesTo," ",o.lcZ(5,12,"::Calories")," ")}}function gt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",103),o.NdJ("click",function(){return o.CHM(t),o.oxw(4).showNutritionForm()}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"::AddMeal")))}function pt(t,i){1&t&&(o.TgZ(0,"div",108),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"::ExceededMinProtineLimit")))}function mt(t,i){1&t&&(o.TgZ(0,"div",108),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.Oqu(o.lcZ(2,1,"::ExceededMaxProtineLimit")))}function ht(t,i){if(1&t&&(o.TgZ(0,"span",104),o._UZ(1,"app-nutrition-totals",105),o.YNc(2,pt,3,3,"div",106),o.YNc(3,mt,3,3,"div",107),o.qZA()),2&t){const t=o.oxw(4);o.xp6(1),o.Q6J("defaultCalories",t.assignedNutritionDayModel.getCalorie()||0)("proteins",t.assignedNutritionDayModel.getNutritionTotals().proteins)("carbs",t.assignedNutritionDayModel.getNutritionTotals().carbs)("fats",t.assignedNutritionDayModel.getNutritionTotals().fats),o.xp6(1),o.Q6J("ngIf",t.getMinProtineAlert()),o.xp6(1),o.Q6J("ngIf",t.getMaxProtineAlert())}}function ft(t,i){if(1&t&&(o.TgZ(0,"div",36),o.TgZ(1,"div",99),o._UZ(2,"hr",100),o.TgZ(3,"div",9),o.TgZ(4,"div",30),o.YNc(5,gt,3,3,"button",101),o.qZA(),o.TgZ(6,"div",36),o.YNc(7,ht,4,6,"span",102),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t){const t=o.oxw(3);o.xp6(5),o.Q6J("ngIf",t.canAddMoreMeals()),o.xp6(2),o.Q6J("ngIf",t.assignedNutritionDayModel.getNutritionTotals())}}function bt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",109),o.TgZ(1,"div",110),o.TgZ(2,"form",111),o.NdJ("ngSubmit",function(){return o.CHM(t),o.oxw(3).submitForm()}),o.TgZ(3,"div",112),o.TgZ(4,"div",113),o.TgZ(5,"div",114),o.TgZ(6,"div",115),o.TgZ(7,"label",116),o._uU(8),o.ALo(9,"abpLocalization"),o.qZA(),o.TgZ(10,"div",43),o._UZ(11,"input",117),o.TgZ(12,"div",45),o._UZ(13,"input",118),o.ALo(14,"abpLocalization"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(15,"div",119),o._UZ(16,"i",120),o._UZ(17,"br"),o.TgZ(18,"span",121),o._uU(19),o.ALo(20,"abpLocalization"),o.qZA(),o._UZ(21,"br"),o._UZ(22,"br"),o._UZ(23,"br"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.xp6(2),o.Q6J("formGroup",t.form),o.xp6(6),o.Oqu(o.lcZ(9,4,"::MealName")),o.xp6(5),o.s9C("value",o.lcZ(14,6,"::Save")),o.xp6(6),o.Oqu(o.lcZ(20,8,"::AddMealTip"))}}function yt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",109),o.TgZ(1,"h3"),o._uU(2),o.ALo(3,"abpLocalization"),o.qZA(),o.TgZ(4,"app-nutrition-selector",122),o.NdJ("productSelected",function(i){return o.CHM(t),o.oxw(3).productSelected(i,null)}),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.xp6(2),o.AsE(" ",o.lcZ(3,2,"::AddNutrition")," (",t.lastAddedNutritionDayItem.name,") ")}}function vt(t,i){1&t&&(o.TgZ(0,"div",109),o.TgZ(1,"div",123),o._UZ(2,"i",120),o._UZ(3,"br"),o.TgZ(4,"span",121),o._uU(5),o.ALo(6,"abpLocalization"),o.qZA(),o._UZ(7,"br"),o._UZ(8,"br"),o._UZ(9,"br"),o.qZA(),o.qZA()),2&t&&(o.xp6(5),o.Oqu(o.lcZ(6,1,"::SearchNutrition")))}function Nt(t,i){if(1&t&&(o.TgZ(0,"div",8),o.TgZ(1,"div",9),o.TgZ(2,"div",10),o.TgZ(3,"div",9),o.TgZ(4,"div",11),o.YNc(5,dt,31,25,"fieldset",12),o.qZA(),o.YNc(6,ct,4,7,"div",13),o.YNc(7,ut,6,14,"div",14),o.YNc(8,ft,8,2,"div",15),o.qZA(),o.qZA(),o.YNc(9,bt,24,10,"div",16),o.YNc(10,yt,5,4,"div",16),o.YNc(11,vt,10,3,"div",16),o.qZA(),o.qZA()),2&t){const t=o.oxw(2);o.xp6(5),o.Q6J("ngForOf",t.assignedNutritionDayModel.nutritionDayItemsUnDeleted)("ngForTrackBy",t.trackByAssignedNutritionDayItemModel),o.xp6(1),o.Q6J("ngIf",!t.canAddMoreMeals()),o.xp6(1),o.Q6J("ngIf",t.isCaloriesError()),o.xp6(1),o.Q6J("ngIf",!t.isAddingNewExcercise),o.xp6(1),o.Q6J("ngIf",t.isAddingNewExcercise),o.xp6(1),o.Q6J("ngIf",!t.isAddingNewExcercise&&t.lastAddedNutritionDayItem),o.xp6(1),o.Q6J("ngIf",!t.isAddingNewExcercise&&!t.lastAddedNutritionDayItem)}}function Dt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",124),o.TgZ(1,"button",125,126),o._uU(3),o.ALo(4,"abpLocalization"),o.qZA(),o.TgZ(5,"button",127),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).save()}),o._UZ(6,"i",47),o._uU(7),o.ALo(8,"abpLocalization"),o.qZA(),o.qZA()}2&t&&(o.xp6(3),o.hij(" ",o.lcZ(4,2,"AbpUi::Cancel")," "),o.xp6(4),o.hij(" ",o.lcZ(8,4,"AbpUi::Save")," "))}function Zt(t,i){if(1&t&&(o.TgZ(0,"div",5),o.YNc(1,Nt,12,8,"div",6),o.YNc(2,Dt,9,6,"div",7),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.assignedNutritionDayModel),o.xp6(1),o.Q6J("ngIf",t.isCanSave)}}let xt=(()=>{class t{constructor(t,i,e,n,a,r,s,l,d,u,g,p,m,h,f,b,y){this.list=t,this.track=i,this.service2=e,this.service=n,this.localization=a,this.nutritionManageService=r,this.langService=s,this.mobileHelperService=l,this._attachmentService=d,this.confirmation=u,this.environment=g,this.dateService=p,this.toaster=m,this.localCacheService=h,this.analyticsService=f,this.traineeMiddleService=b,this.fb=y,this.dataChanged=new o.vpe,this.trackByAssignedNutritionDayItemModel=(t,i)=>null==i?void 0:i.id,this.trackByAssignedNutritionDayItemDetailModel=(t,i)=>null==i?void 0:i.id,this.trackByNutrition=(t,i)=>null==i?void 0:i.id,this.isModalBusy=!1,this.isModalOpen=!1,this.apiUrl="",this.isMobile=!1,this.programConstrains=new c.C,this.ttl=900,this.isAddingNewExcercise=!1,this.isCanSave=!1,this.lastSearchedNutrition="",this.isShowAddingNutrition=!1,this.nutritionCategories=[]}ngOnInit(){this.apiUrl=this.environment.getApiUrl()}getMinProtine(){return 1.2*this.traineeMiddleService.weight}getMaxProtine(){return 2.2*this.traineeMiddleService.weight}getMinProtineAlert(){return 0!==this.assignedNutritionDayModel.getProteins()&&0!==this.traineeMiddleService.weight&&this.assignedNutritionDayModel.getProteins()<this.getMinProtine()}getMaxProtineAlert(){return 0!==this.assignedNutritionDayModel.getProteins()&&0!==this.traineeMiddleService.weight&&this.assignedNutritionDayModel.getProteins()>this.getMaxProtine()}hideForm(){this.isModalOpen=!1,this.form&&this.form.reset()}showForm(){this.lastAddedNutritionDayItem=void 0,this.form&&this.form.reset(),this.isModalOpen=!0,this.isShowAddingNutrition=!1,this.isMobile&&this.startSearchNutrition({query:""})}create(t,i,e){let n=this;n.nutritionCategories&&0!==n.nutritionCategories.length||n.service2.getDislikedCategoriesByTraineeId(e.traineeId).subscribe(t=>{n.nutritionCategories=t}),this.programConstrains=e,this.isCanSave=!0,this.day=t;let o={};o.dayNumber=t.dayId,o.assignedNutritionProgramId=i,o.calendarDate=this.dateService.removeUtcDate(t.startDate).toISOString(),this.assignedNutritionDayModel=new l.k(o.nutritionProgramName,o.nutritionProgramId,o);for(let a=0;a<e.numberOfMeals;a++)this.assignedNutritionDayModel.addNewDetail(this.localization.instant("::AMeal")+" "+(a+1));this.hideNutritionForm(),this.showForm(),this.assignedNutritionDayModel.onDelete.subscribe(t=>{0===t?this.showNutritionForm():1===t&&(this.lastAddedNutritionDayItem=this.assignedNutritionDayModel.nutritionDayItemsUnDeleted[0])})}update(t,i,e){let n=this;n.nutritionCategories&&0!==n.nutritionCategories.length||n.service2.getDislikedCategoriesByTraineeId(e.traineeId).subscribe(t=>{n.nutritionCategories=t}),this.programConstrains=e,this.day=t,this.isCanSave=!0,this.assignedNutritionDayModel=new l.k(i.nutritionProgramName,i.nutritionProgramId,i.convertToDto()),this.hideNutritionForm(),this.showForm(),this.assignedNutritionDayModel.onDelete.subscribe(t=>{0===t?this.showNutritionForm():1===t&&(this.lastAddedNutritionDayItem=this.assignedNutritionDayModel.nutritionDayItemsUnDeleted[0])}),1===this.assignedNutritionDayModel.nutritionDayItemsUnDeleted.length&&(this.lastAddedNutritionDayItem=this.assignedNutritionDayModel.nutritionDayItemsUnDeleted[0])}isHasOneMeal(){return 1===this.assignedNutritionDayModel.nutritionDayItemsUnDeleted.length}cancel(){}getDayKey(t){const i=`assinged_nt_${t.assignedNutritionProgramId}_${t.calendarDate}`.replace("T00:00:00Z","").replace("T00:00:00","");return console.log("key",i),i}setSelectedDay(t){try{const i=this.getDayKey(t.assignedNutritionProgramDay),e=JSON.stringify({on:Date(),data:t});this.localCacheService.put(i,e,this.ttl)}catch(i){this.clearStorage()}}clearStorage(){for(var t in console.log("clearing storage"),this.localCacheService.clearAll(),localStorage)t.startsWith("assinged_")&&localStorage.removeItem(t)}save(){if(this.assignedNutritionDayModel&&!this.assignedNutritionDayModel.isAllSuperSetsValid())return;if(this.isCaloriesError())return;const t=this;let i=this.assignedNutritionDayModel.convertToDto();if(t.analyticsService.log(g.O.do_save_Program_assigned_nutrition),this.assignedNutritionDayModel.id){let e={};e.dayNumber=i.id,e.assignedNutritionProgramId=i.assignedNutritionProgramId,e.calendarDate=i.calendarDate,e.assignedNutritionProgramDayItems=i.assignedNutritionProgramDayItems,e.nutritionProgramId=i.nutritionProgramId,e.name=i.name,this.service.update(this.assignedNutritionDayModel.id,e).subscribe(i=>{let e=new s.h(i.id,i.name,this.day,new l.k(i.nutritionProgramName,i.nutritionProgramId,i));t.day.clearItems(),t.day.addItem(e);const n={};n.assignedNutritionProgramDay=i,t.setSelectedDay(n),t.hideForm(),t.dataChanged.emit(t.assignedNutritionDayModel)})}else{let e={};e.dayNumber=i.dayNumber,e.assignedNutritionProgramId=i.assignedNutritionProgramId,e.calendarDate=i.calendarDate,e.assignedNutritionProgramDayItems=i.assignedNutritionProgramDayItems,e.nutritionProgramId=i.nutritionProgramId,e.name=i.name,this.service.create(e).subscribe(i=>{i.nutritionProgramName=this.assignedNutritionDayModel.nutritionProgramName,t.day.addItem(new s.h(i.id,i.name,this.day,new l.k(i.nutritionProgramName,i.nutritionProgramId,i)));const e={};e.assignedNutritionProgramDay=i,t.setSelectedDay(e),t.hideForm(),t.dataChanged.emit(t.assignedNutritionDayModel)})}}showNutritionForm(){this.buildForm(),this.isAddingNewExcercise=!0}hideNutritionForm(){this.isAddingNewExcercise=!1}canAddMoreMeals(){return!0}isCaloriesError(){return!1}buildForm(){this.form=this.fb.group({mealName:[null,[y.kI.required]]})}submitForm(){if(this.form.invalid)return;const t=this.form.get("mealName").value;this.isCanSave=!0,this.hideNutritionForm(),this.assignedNutritionDayModel.addNewDetail(t),this.lastAddedNutritionDayItem=this.assignedNutritionDayModel.nutritionDayItemsUnDeleted[this.assignedNutritionDayModel.nutritionDayItemsUnDeleted.length-1]}startSearchNutrition(t){let i={};i.filter=t.query,i.maxResultCount=50,this.lastSearchedNutrition=t.query||"",this.service2.getNutritionLookupAll(i).subscribe(t=>{this.AllNutritions=t.items,this.isShowAddingNutrition=0==t.items.length})}onSelect(t){}onClear(){}searchType(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)?"text":"search"}saveItem(t){let i={};i.nutritionId=t.nutrition.id,i.traineeId=this.programConstrains.traineeId,this.service2.validateNutrition(i).subscribe(i=>{i.isValid?t.save():this.confirmation.warn("::AreYouSureToAssignExcludedFoods","::AreYouSure",{messageLocalizationParams:[t.nutrition.nutritionName]}).subscribe(i=>{i==m.Tv.Status.confirm&&t.save()})})}createNewNutrition(t,i){this.selctedNutritionDayItemGroup=i,t.create(this.lastSearchedNutrition)}onCreateNewNutrition(t){this.startSearchNutrition({query:t.nutritionName}),setTimeout(()=>{this.selctedNutritionDayItemGroup.nutrition=t},1e3)}isDislikedNutrition(t){return this.nutritionCategories.some(i=>{var e;return null!==(e=i===(null==t?void 0:t.nutritionCategoryId))&&void 0!==e?e:0})}drop(t,i,e){let n=[...i.detailsUnDeleted].filter(t=>t.optionId!=e),o=[...i.detailsUnDeletedForActiveOption];(0,N.bA)(o,t.previousIndex,t.currentIndex),i.details=[...o,...n]}up(t,i,e,n){if(e<i.details.length-1){let t=[...i.detailsUnDeleted].filter(t=>t.optionId!=n),o=[...i.detailsUnDeletedForActiveOption];(0,N.bA)(o,e,e+1),i.details=[...o,...t]}}down(t,i,e,n){if(e>0){let t=[...i.detailsUnDeleted].filter(t=>t.optionId!=n),o=[...i.detailsUnDeletedForActiveOption];(0,N.bA)(o,e,e-1),i.details=[...o,...t]}}addNewNutrition(t){t.isAddingNewItem=!t.isAddingNewItem,this.lastAddedNutritionDayItem=t,this.isAddingNewExcercise=!1}productSelected(t,i){console.log("adding-detail-3",t),null!=i||(i=this.lastAddedNutritionDayItem),i&&(i.isAddingNewItem=!1,i.addNewDetail(t))}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(n.XNV),o.Y36(n.vR3),o.Y36(p.Jq),o.Y36(p.BA),o.Y36(n.oQ8),o.Y36(p.iJ),o.Y36(b.C),o.Y36(D.k4),o.Y36(Z.L),o.Y36(m.YP),o.Y36(n.L$R),o.Y36(a.R),o.Y36(m.MJ),o.Y36(f.F),o.Y36(g.y),o.Y36(x.J),o.Y36(y.qu))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-assigned-nutrition-program-modal-day"]],outputs:{dataChanged:"dataChanged"},features:[o._Bn([n.XNV,a.R])],decls:7,vars:3,consts:[["size","xl",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],[3,"hideList","onSaved"],["appNutrition",""],[1,"program-popup","small-scrollbar"],["class","mt-2 fade-in-top",4,"ngIf"],["class","col-sm-12 modal-footer mt-0 p-1",4,"ngIf"],[1,"mt-2","fade-in-top"],[1,"row"],[1,"col-8"],[1,"col-12",2,"height","calc(100vh - 180px)","overflow-y","auto","min-height","200px"],["class","hiding-container bg-light-2 round-borders",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","alert alert-info text-center col-12",4,"ngIf"],["class","alert alert-danger text-center col-12",4,"ngIf"],["class","col",4,"ngIf"],["class","col-4",4,"ngIf"],[1,"hiding-container","bg-light-2","round-borders",3,"ngClass"],["class","set-item text-center",4,"ngIf"],[1,"delete-nutrition-day-item"],[1,"btn","btn-danger","delete-nutrition","auto-hide",3,"click"],[1,"fa","fa-times"],[1,"option-container","row"],[1,"btn-group","col-auto"],[1,"btn","btn-sm",3,"click"],[1,"fa","fa-arrow-up"],[1,"fa","fa-arrow-down"],[1,"btn","btn-secondary",3,"click"],["class","btn btn-secondary",3,"active","click",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"col-auto"],[3,"isShowPercent","defaultCalories","proteins","carbs","fats"],["cdkDropList","",1,"nutritions-con",3,"cdkDropListDropped"],["cdkDrag","","class","nutrition-row",4,"ngFor","ngForOf","ngForTrackBy"],[1,"excercise-footer"],["class","btn-sm btn btn-outline-success auto-hide",3,"click",4,"ngIf"],[1,"col"],[1,"mt-2","text-center"],[1,"d-block","input-containers","input-group","mb-2"],[1,"rounded","w-100","form-control",3,"ngModel","placeholder","ngModelChange"],[1,"set-item","text-center"],[1,"btn","no-shadow","btn-sm","text-primary","m-0","p-0",3,"click"],[1,"fa","fa-pen"],[1,"input-group"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-sm","text-success","m-0","p-0",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-plus"],["cdkDrag","",1,"nutrition-row"],[1,"col-3","my-auto","d-flex"],["cdkDragHandle","","width","24px","fill","currentColor","viewBox","0 0 24 24",1,"holder"],["d","M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"],["d","M0 0h24v24H0z","fill","none"],[2,"display","inline-block","text-align","center"],["class","btn btn-sm",3,"click",4,"ngIf"],[4,"ngIf"],[1,"col","my-auto"],["class","value-containers",4,"ngIf"],["class","d-block input-containers input-group",4,"ngIf"],[1,"col-auto","my-auto"],[1,"col-auto","text-center","text-lg-right","text-sm-center","my-auto"],[1,"action-btns"],["class","btn btn-link",3,"click",4,"ngIf"],[1,"btn","btn-sm","px-1","text-danger",3,"click"],[1,"d-lg-none","d-inline-block","ml-2"],[1,"col-6"],["class","mt-2 text-center",4,"ngIf"],["class","col-6",4,"ngIf"],[1,"img-fluid","rounded",3,"src","title"],[1,"value-containers"],[1,"view-rtl"],[1,"view-ltr"],[1,"d-block","input-containers","input-group"],["for","general-lookup-store-type-general-lookup-id"],["class","fa fa-exclamation  text-danger",4,"ngIf"],[3,"ngClass"],["class","w-100","dataKey","id","forceSelection","true","id","nutritionItem","name","nutritionItem",3,"ngModel","dropdown","suggestions","type","field","placeholder","completeMethod","onClear","search","ngModelChange",4,"ngIf"],["class","btn btn-sm btn-outline-success btn-block",3,"click",4,"ngIf"],["class","badge badge-warning",4,"ngIf"],["class","form-inline",4,"ngIf"],[1,"fa","fa-exclamation","text-danger"],["dataKey","id","forceSelection","true","id","nutritionItem","name","nutritionItem",1,"w-100",3,"ngModel","dropdown","suggestions","type","field","placeholder","completeMethod","onClear","search","ngModelChange"],[1,"btn","btn-sm","btn-outline-success","btn-block",3,"click"],[1,"badge","badge-warning"],[1,"form-inline"],[1,"form-group","w-100"],["id","nutritionItem","name","nutritionItem",1,"custom-select","form-control",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","view-rtl",4,"ngIf"],["class","view-ltr",4,"ngIf"],["type","number",1,"form-control","rounded","w-100",3,"ngModel","ngClass","placeholder","ngModelChange"],[1,"btn","btn-link",3,"click"],[1,"fa","fa-pen","text-primary"],[1,"btn-sm","btn","btn-outline-success","auto-hide",3,"click"],[1,"alert","alert-info","text-center","col-12"],[1,"alert","alert-danger","text-center","col-12"],[1,"nutrition-footer-old"],[1,"mb-0","w-100"],["class","mx-3 btn btn-outline-success add-btn",3,"click",4,"ngIf"],["class","totals",4,"ngIf"],[1,"mx-3","btn","btn-outline-success","add-btn",3,"click"],[1,"totals"],[1,"d-inline-block",3,"defaultCalories","proteins","carbs","fats"],["class","badge badge-warning d-inline-block ",4,"ngIf"],["class","badge badge-warning d-inline-block",4,"ngIf"],[1,"badge","badge-warning","d-inline-block"],[1,"col-4"],[1,"text-center","col"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"row","app-bg-gray-light"],[1,"col","mx-auto"],[1,"mt-2","fade-in-top","row"],[1,"form-group","col-md-12"],["for","mealName"],["autofocus","","formControlName","mealName","id","mealName","maxlength","255","minlength","1",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"value"],[1,"col","text-center","mt-5","pt-5"],[1,"fab","fa-nutritionix","text-primary",2,"font-size","48px"],[1,"text-muted"],[3,"productSelected"],[1,"col","text-center","text-center","mt-5","pt-5"],[1,"col-sm-12","modal-footer","mt-0","p-1"],["type","button",1,"btn","btn-secondary","btn-cancel"],["abpClose",""],["Class","btn btn-success btn-save",3,"click"]],template:function(t,i){1&t&&(o.TgZ(0,"abp-modal",0),o.NdJ("visibleChange",function(t){return i.isModalOpen=t}),o.YNc(1,q,3,3,"ng-template",null,1,o.W1O),o.YNc(3,Zt,3,2,"ng-template",null,2,o.W1O),o.qZA(),o.TgZ(5,"app-nutrition",3,4),o.NdJ("onSaved",function(t){return i.onCreateNewNutrition(t)}),o.qZA()),2&t&&(o.Q6J("visible",i.isModalOpen)("busy",i.isModalBusy),o.xp6(5),o.Q6J("hideList",!0))},directives:[m.zS,A.J,v.O5,v.sg,v.mk,I.r,N.Wj,y.Fj,y.JJ,y.On,M.m,N.Zt,N.Bh,C.Qc,y.EJ,y.YN,y.Kr,y.wV,y._Y,y.JL,n.YzZ,y.sg,P.hL,n.Uqp,y.u,P.J5,y.nD,y.wO,w.A],pipes:[n.fuE,v.Ov,T.H,v.JJ],styles:[".has-error[_ngcontent-%COMP%]{border:1px solid red}.program-popup[_ngcontent-%COMP%]   .badge-inner[_ngcontent-%COMP%]{background-color:#fff;color:#000;font-size:100%}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]{padding:20px 16px;border:1px solid #e5e5e5;border-radius:8px;margin-bottom:0}.program-popup[_ngcontent-%COMP%]   fieldset.selected-fieldset[_ngcontent-%COMP%]{background:#ffc10733!important;border:1px solid #ffc107}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{width:auto;border:1px solid #d5d5d5;border-radius:50px;padding:3px 14px;background:#fff;margin-bottom:0;font-size:14px;position:relative;z-index:2}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .delete-nutrition-day-item[_ngcontent-%COMP%]{text-align:left;transition:all .4s ease-in-out;transform:translateY(-50px);height:24px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .delete-nutrition-day-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50%;padding:0;width:24px;height:24px;line-height:24px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .delete-nutrition-day-item[_ngcontent-%COMP%]   button.auto-hide[_ngcontent-%COMP%]{opacity:0;height:0}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]:hover   .delete-nutrition-day-item[_ngcontent-%COMP%]   .auto-hide[_ngcontent-%COMP%]{opacity:1;height:24px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]{padding:10px 0;border-bottom:1px solid #e5e5e5}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]:first-of-type{padding-top:0}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]:last-of-type{margin-bottom:20px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]   .input-containers[_ngcontent-%COMP%]{align-items:center}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]   .input-containers[_ngcontent-%COMP%]   .input-group-append[_ngcontent-%COMP%]{vertical-align:middle;display:inline-block;margin-right:6px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]   .action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff}@media screen and (min-width:991px){.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]   .action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50%;padding:0!important;width:25px;height:25px;line-height:25px}}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .nutritions-con[_ngcontent-%COMP%]   .nutrition-row[_ngcontent-%COMP%]   .action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:last-child){margin-left:10px}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .excercise-footer[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:center}.program-popup[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]   .excercise-footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:10px}.program-popup[_ngcontent-%COMP%]   .nutrition-footer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;align-items:center}.program-popup[_ngcontent-%COMP%]   .nutrition-footer[_ngcontent-%COMP%]   .totals[_ngcontent-%COMP%]{margin-top:15px}.program-popup[_ngcontent-%COMP%]   .nutrition-footer[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{transform:translateY(18px)}.program-popup[_ngcontent-%COMP%]   .nutrition-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50px;background:#fff;position:relative;z-index:1}.program-popup[_ngcontent-%COMP%]   .nutrition-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#00824e}.img-fluid[_ngcontent-%COMP%]{max-width:58px}.alert[_ngcontent-%COMP%]{padding:3px}.alert.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da}[_nghost-%COMP%]     .modal{display:block!important}[_nghost-%COMP%]     .modal-header{padding:0 16px}[_nghost-%COMP%]     .modal-dialog{overflow-y:visible!important;overflow-y:initial!important}[_nghost-%COMP%]     .modal-body{height:80vh;overflow-y:auto;padding:0 14px 6px}.badge.badge-inner[_ngcontent-%COMP%]{display:block;margin:3px}.option-container[_ngcontent-%COMP%]{width:100%;margin-top:-26px;margin-bottom:15px}.cdk-drag-preview[_ngcontent-%COMP%]{z-index:10000!important;transform:rotate3d(10,10,10,-2deg);box-shadow:10px 10px 10px rgba(0,0,0,.1)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),t})();var At=e(6194),It=e(98462),Mt=e(11520),Ct=e(28157),Pt=e(28451);function wt(t,i){1&t&&(o.TgZ(0,"h3"),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::MoveToLibrary")," "))}function Tt(t,i){if(1&t&&(o.TgZ(0,"span",16),o._uU(1),o.qZA()),2&t){const t=o.oxw().$implicit;o.xp6(1),o.hij(" ",t.selectionCount," ")}}function qt(t,i){if(1&t&&(o.TgZ(0,"p",14),o._uU(1),o.qZA(),o.YNc(2,Tt,2,1,"span",15)),2&t){const t=i.$implicit;o.xp6(1),o.hij(" ",t.nutriitionProgramName," "),o.xp6(1),o.Q6J("ngIf",t.selectionCount>0)}}function Ot(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"form",3),o.NdJ("ngSubmit",function(){return o.CHM(t),o.oxw().submitForm()}),o.TgZ(1,"div",4),o.TgZ(2,"div",5),o.TgZ(3,"label",6),o._uU(4),o.ALo(5,"abpLocalization"),o.qZA(),o.TgZ(6,"p-autoComplete",7),o.NdJ("onClear",function(){return o.CHM(t),o.oxw().onClear()})("completeMethod",function(i){return o.CHM(t),o.oxw().startSearchProgram(i)})("search",function(i){return o.CHM(t),o.oxw().startSearchProgram(i)}),o.ALo(7,"abpLocalization"),o.YNc(8,qt,3,2,"ng-template",8),o.qZA(),o.qZA(),o.qZA(),o.TgZ(9,"div",9),o.TgZ(10,"button",10,11),o._uU(12),o.ALo(13,"abpLocalization"),o.qZA(),o.TgZ(14,"button",12),o._UZ(15,"i",13),o._uU(16),o.ALo(17,"abpLocalization"),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.Q6J("formGroup",t.form),o.xp6(4),o.hij(" ",o.lcZ(5,8,"::NutritionProgram")," "),o.xp6(2),o.s9C("placeholder",o.lcZ(7,10,"::NutritionProgram")),o.Q6J("suggestions",t.AllPrograms)("type",t.searchType())("dropdown",!0),o.xp6(6),o.hij(" ",o.lcZ(13,12,"AbpUi::Cancel")," "),o.xp6(4),o.hij(" ",o.lcZ(17,14,"::Ok")," ")}}let St=(()=>{class t{constructor(t,i,e,n,o,a,r,s,l,d,c){this.list=t,this.track=i,this.service=e,this.traineeService=n,this.confirmation=o,this.dateService=a,this.localCacheService=r,this.toaster=s,this.l=l,this.assignNutritionProgramService=d,this.fb=c,this.isModalBusy=!1,this.isModalOpen=!1}ngOnInit(){}buildForm(){this.form=this.fb.group({nutritionProgramId:[null,[y.kI.required]]})}submitForm(){var t;let i=this;if(this.form.invalid)return;const e=this.form.get("nutritionProgramId").value,n={assignedProgramId:this.assignedProgramId,dayDates:this.days.map(t=>t.toISOString()).toString(),dayIds:this.days.map(t=>t.toISOString()).toString(),programId:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:e};this.service.moveToLibe(n).pipe((0,Mt.x)(()=>this.isModalBusy=!1)).subscribe(t=>{i.toaster.success("::Success"),setTimeout(()=>{i.hideForm()},1)})}hideForm(){this.isModalOpen=!1,setTimeout(()=>{this.form.reset()},100)}showForm(){this.buildForm(),this.isModalOpen=!0}create(t,i){var e;this.days=t.map(t=>t.day.startDate),this.assignedProgramId=null!==(e=null==i?void 0:i.id)&&void 0!==e?e:i,this.showForm()}startSearchProgram(t){this.service.getNutritionProgramLookup(t.query,0,0,!0).subscribe(t=>{this.AllPrograms=t.items})}onSelect(t){}onClear(){}searchType(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)?"text":"search"}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(n.XNV),o.Y36(n.vR3),o.Y36(p.Jq),o.Y36(Ct.s),o.Y36(m.YP),o.Y36(a.R),o.Y36(f.F),o.Y36(m.MJ),o.Y36(n.oQ8),o.Y36(d.v),o.Y36(y.qu))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-move-to-lib-nutrition-program"]],outputs:{create:"create"},features:[o._Bn([a.R])],decls:5,vars:2,consts:[["size","md",3,"busy","visible","visibleChange"],["abpHeader",""],["abpBody",""],["validateOnSubmit","",1,"move-to-lib-nutrition-program",3,"formGroup","ngSubmit"],[1,"mt-2","fade-in-top","row"],[1,"form-group","col-12"],["for","app-user-coordinator-app-user-id",2,"display","block"],["formControlName","nutritionProgramId","styleClass","dropdown-with-table","id","coachAppUserId","name","coachAppUserId","dataKey","id","field","nutriitionProgramName","forceSelection","true",1,"",3,"suggestions","type","dropdown","placeholder","onClear","completeMethod","search"],["pTemplate","item"],[1,"col-12","modal-footer"],["type","button",1,"btn","btn-secondary","btn-cancel"],["abpClose",""],["type","submit",1,"btn","btn-success","btn-save"],[1,"fa","fa-check"],[1,"program-name"],["class","badge badge-secondary","style","display: inline-block;",4,"ngIf"],[1,"badge","badge-secondary",2,"display","inline-block"]],template:function(t,i){1&t&&(o.TgZ(0,"abp-modal",0),o.NdJ("visibleChange",function(t){return i.isModalOpen=t}),o.YNc(1,wt,3,3,"ng-template",null,1,o.W1O),o.YNc(3,Ot,18,16,"ng-template",null,2,o.W1O),o.qZA()),2&t&&o.Q6J("busy",i.isModalBusy)("visible",i.isModalOpen)},directives:[m.zS,y._Y,y.JL,n.YzZ,y.sg,P.hL,C.Qc,y.JJ,y.u,P.J5,M.m,Pt.jx,v.O5],pipes:[n.fuE],styles:["@media (max-width:768px){  .move-to-lib-nutrition-program .p-autocomplete-panel{max-width:100%}}  .move-to-lib-nutrition-program .program-name{white-space:normal}  .move-to-lib-nutrition-program .badge{min-width:40px;font-size:90%;text-align:center}  .move-to-lib-nutrition-program .calories{font-size:80%;display:inline-block;width:30px;white-space:normal;line-height:9px;vertical-align:sub;padding-right:5px;color:#999}"]}),t})();var _t=e(46140);function Ut(t,i){if(1&t&&(o.TgZ(0,"h1",8),o._uU(1),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.hij(" ",t.assignedNutritionDayModel.totalDayCaloriesMin," ")}}const kt=function(t,i,e){return{"text-primary":t,"text-warning":i,"text-danger":e}};function Lt(t,i){if(1&t&&(o.TgZ(0,"h3",9),o._uU(1),o.qZA()),2&t){const t=o.oxw(2);o.Q6J("ngClass",o.kEZ(3,kt,!t.isShowAlert(1.05),t.isShowAlert(1.05)&&!t.isShowAlert(1.1),t.isShowAlert(1.1))),o.xp6(1),o.AsE(" ",t.assignedNutritionDayModel.totalDayCaloriesMin," ~ ",t.assignedNutritionDayModel.totalDayCaloriesMax," ")}}function Ft(t,i){if(1&t&&(o.TgZ(0,"div",10),o._uU(1),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.hij(" ",t.assignedNutritionDayModel.nutritionProgramName," ")}}function Jt(t,i){1&t&&(o.TgZ(0,"span",11),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()),2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::Updated")," "))}function Yt(t,i){if(1&t&&(o.TgZ(0,"div",1),o.TgZ(1,"h5",2),o._uU(2),o.ALo(3,"abpLocalization"),o.qZA(),o.YNc(4,Ut,2,1,"h1",3),o.YNc(5,Lt,2,7,"h3",4),o.TgZ(6,"div",5),o._uU(7),o.ALo(8,"abpLocalization"),o.qZA(),o.YNc(9,Ft,2,1,"div",6),o.YNc(10,Jt,3,3,"span",7),o.qZA()),2&t){const t=o.oxw();o.xp6(2),o.hij(" ",o.lcZ(3,6,"::NutritionValue")," "),o.xp6(2),o.Q6J("ngIf",t.assignedNutritionDayModel.totalDayCaloriesMin===t.assignedNutritionDayModel.totalDayCaloriesMax),o.xp6(1),o.Q6J("ngIf",t.assignedNutritionDayModel.totalDayCaloriesMin!==t.assignedNutritionDayModel.totalDayCaloriesMax),o.xp6(2),o.hij(" ",o.lcZ(8,8,"::CalorieItem")," "),o.xp6(2),o.Q6J("ngIf",t.assignedNutritionDayModel.nutritionProgramName),o.xp6(1),o.Q6J("ngIf",t.assignedNutritionDayModel.nutritionProgramId&&t.assignedNutritionDayModel.lastModificationTime)}}let Et=(()=>{class t{constructor(t,i,e,n,o,a){this.list=t,this.track=i,this.service=e,this.confirmation=n,this.dateService=o,this.fb=a,this.trackByAssignedNutritionDayItemModel=(t,i)=>null==i?void 0:i.id,this.trackByAssignedNutritionDayItemDetailModel=(t,i)=>null==i?void 0:i.id,this.isSummary=!0}get assignedNutritionDayModel(){return this._assignedNutritionDayModel}set assignedNutritionDayModel(t){this._assignedNutritionDayModel=t,this.name=t.name}ngOnInit(){}get name(){return this._name}set name(t){this._name=t}save(){let t=this,i=this.assignedNutritionDayModel.convertToDto();i.name=this.name,this.service.update(this.assignedNutritionDayModel.id,i).subscribe(i=>{this.assignedNutritionDayModel.name=i.name,this.assignedNutritionDayModel.name=i.name,this.assignedNutritionDayModel.id=i.id;let e=new s.h(i.id,i.name,this.day,this.assignedNutritionDayModel);t.day.clearItems(),t.day.addItem(e)})}isShowAlert(t){return!!this.assignedNutritionDayModel&&this.assignedNutritionDayModel.totalDayCaloriesMax>this.assignedNutritionDayModel.totalDayCaloriesMin*t}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(n.XNV),o.Y36(n.vR3),o.Y36(p.BA),o.Y36(m.YP),o.Y36(a.R),o.Y36(y.qu))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-assigned-nutrition-program-day"]],inputs:{day:"day",assignedNutritionDayModel:"assignedNutritionDayModel",isSummary:"isSummary"},features:[o._Bn([n.XNV,a.R])],decls:1,vars:1,consts:[["class","text-center",4,"ngIf"],[1,"text-center"],[1,"m-0"],["class","text-primary m-0",4,"ngIf"],["class","m-0",3,"ngClass",4,"ngIf"],[1,"text-muted","mb-3"],["class","badge badge-light text-wraped",4,"ngIf"],["class","badge badge-primary",4,"ngIf"],[1,"text-primary","m-0"],[1,"m-0",3,"ngClass"],[1,"badge","badge-light","text-wraped"],[1,"badge","badge-primary"]],template:function(t,i){1&t&&o.YNc(0,Yt,11,10,"div",0),2&t&&o.Q6J("ngIf",i.assignedNutritionDayModel)},directives:[v.O5,v.mk],pipes:[n.fuE],encapsulation:2}),t})();const Qt=["modal"],zt=["board"],Bt=["multiplay"];function jt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",16),o.NdJ("click",function(){o.CHM(t);const i=o.oxw(2);return o.MAs(7).create(i.traineeUserId,null)}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::AssignNutritionProgram")," "))}function Ht(t,i){if(1&t&&(o.TgZ(0,"div",9),o._UZ(1,"div",10),o.TgZ(2,"div",11),o.TgZ(3,"div",12),o.TgZ(4,"div",10),o._UZ(5,"i",13),o.TgZ(6,"h5"),o._uU(7),o.ALo(8,"abpLocalization"),o.qZA(),o.TgZ(9,"p",14),o._uU(10),o.ALo(11,"abpLocalization"),o.qZA(),o.YNc(12,jt,3,3,"button",15),o.qZA(),o.qZA(),o.qZA(),o._UZ(13,"div",10),o.qZA()),2&t){const t=o.oxw();o.xp6(7),o.hij(" ",o.lcZ(8,3,"::NotAssignedNutrotionTip")," "),o.xp6(3),o.hij(" ",o.lcZ(11,5,"::NotAssignedNutrotionTip2")," "),o.xp6(2),o.Q6J("ngIf",!t.isCurrentUserAdmin)}}function $t(t,i){1&t&&(o.TgZ(0,"div",9),o._UZ(1,"div",10),o.TgZ(2,"div",11),o.TgZ(3,"div",12),o.TgZ(4,"div",10),o._UZ(5,"i",13),o.TgZ(6,"h5"),o._uU(7),o.ALo(8,"abpLocalization"),o.qZA(),o.TgZ(9,"p",14),o._uU(10),o.ALo(11,"abpLocalization"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o._UZ(12,"div",10),o.qZA()),2&t&&(o.xp6(7),o.hij(" ",o.lcZ(8,2,"::AssingingTip")," "),o.xp6(3),o.hij(" ",o.lcZ(11,4,"::AssingingTip2")," "))}function Gt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",22),o.NdJ("click",function(){o.CHM(t),o.oxw();const i=o.MAs(1),e=o.oxw();return o.MAs(13).create(i.selectedItems,e.selected)}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::MoveToLibrary"),""))}function Vt(t,i){if(1&t&&o._UZ(0,"app-assigned-nutrition-program-day",23),2&t){const t=i.extraData,e=i.day,n=o.oxw(2);o.Q6J("assignedNutritionDayModel",t)("isSummary",n.isSummary)("day",e)}}function Rt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"button",30),o.NdJ("click",function(){o.CHM(t);const i=o.oxw(3);return o.MAs(7).create(i.traineeUserId,null)}),o._uU(1),o.ALo(2,"abpLocalization"),o.qZA()}2&t&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"::AssignNutritionProgram")," "))}function Wt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"div",24),o.TgZ(1,"div",25),o.TgZ(2,"div",26),o.YNc(3,Rt,3,3,"button",27),o.TgZ(4,"button",28),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).refreshCache()}),o._UZ(5,"i",29),o.qZA(),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(2);o.xp6(3),o.Q6J("ngIf",!t.isCurrentUserAdmin)}}function Xt(t,i){if(1&t){const t=o.EpF();o.TgZ(0,"app-board-container",17,18),o.NdJ("weekCreated",function(i){return o.CHM(t),o.oxw().weekCreated(i)})("weekDeleted",function(i){return o.CHM(t),o.oxw().weekDeleted(i)})("itemDeletedBulk",function(i){return o.CHM(t),o.oxw().itemDeletedBulk(i)})("itemDeleted",function(i){return o.CHM(t),o.oxw().itemDeleted(i)})("itemCreated",function(i){return o.CHM(t),o.oxw().itemCreated(i)})("itemCopiedMoved",function(i){return o.CHM(t),o.oxw().itemCopiedMoved(i)})("itemEdited",function(i){return o.CHM(t),o.oxw().itemEdited(i)}),o.YNc(2,Gt,3,3,"ng-template",null,19,o.W1O),o.YNc(4,Vt,1,3,"ng-template",null,20,o.W1O),o.YNc(6,Wt,6,1,"ng-template",null,21,o.W1O),o.qZA()}2&t&&o.Q6J("isDayFullHight",!1)}let Kt=(()=>{class t{constructor(t,i,e,n,a,r,s,l,d,u,g,p,m,h,f){this.list=t,this.track=i,this.programService=e,this.dayService=n,this.confirmation=a,this.dateService=r,this.route=s,this.assignNutritionProgramService=l,this.localCacheService=d,this.router=u,this.langService=g,this.toaster=p,this.permissionService=m,this.analyticsService=h,this.fb=f,this.refresh=new o.vpe,this.isModalBusy=!1,this.isModalOpen=!1,this.isReadOnly=!1,this.isLoading=!0,this.isAssigned=!0,this.programConstrains=new c.C,this.isSummary=!0,this.randomId=0,this.isShowPastModal=!1,this.ttl=900,this.isForceRefresh=!1}ngOnInit(){let t=this;this.analyticsService.log(g.O.View_Program_assigned_nutrition),this.loadProgram(),this.sub=this.assignNutritionProgramService.onAssigned.subscribe(i=>{t.onAssigned(i)})}loadProgram(){this.loadProgramByUserId(!0)}loadProgramByUserId(t){const i=this;let e={};e.traineeId=this.traineeUserId,this.programService.getCurrent(e).pipe((0,u.z)(i.localCacheService,`AssignedNutritionProg${e.traineeId}`,1)).subscribe(e=>{if(i.scheduledNutritionProgramId=e.scheduledNutritionProgramId,i.scheduledNutritionProgramId)return i.isLoading=!1,void setTimeout(()=>{i.loadProgramByUserId(t)},5e3);e.assignedNutritionProgramId?(this.selected=e.assignedNutritionProgramId,this.programConstrains.numberOfMeals=e.numberOfMeals,this.programConstrains.caloriesFrom=e.caloriesFrom,this.programConstrains.caloriesTo=e.caloriesTo,this.programConstrains.traineeId=this.traineeUserId,i.loadSimpleDays(()=>i.initialProgram())):this.isAssigned=!1})}loadSimpleDays(t){const i=this;let e={};e.assignedNutritionProgramId=this.selected,e.maxResultCount=1e3,i.dayService.getListSimple(i.selected).subscribe(e=>{i.selectedDaysSimple=e,this.selectedDays={items:[],totalCount:0},t()})}initialProgram(){let t=this,i=r.w.TwoWeeks;this.isLoading=!1,setTimeout(()=>{t.board.setup(2,i,!1,new Date,"assigned-nut",this.traineeUserId.toString())},10)}dataChanged(t){setTimeout(()=>{this.sub&&this.sub.unsubscribe(),this.refresh.emit()},1e3)}dayDataChanged(t){this.loadProgramByUserId(!1)}weekCreated(t){const i=this;t.days.forEach((t,e)=>{var n,o;t.InitiateItems();let a=this.selectedDays.items.filter(i=>this.dateService.isSameDate(new Date(i.assignedNutritionProgramDay.calendarDate),t.startDate));if(a.length>0){const i=a[0].assignedNutritionProgramDay;t.addItem(new s.h(i.id,i.name,t,new l.k(i.nutritionProgramName,i.nutritionProgramId,i)))}else{let e=((null===(n=i.selectedDaysSimple)||void 0===n?void 0:n.items)||[]).filter(i=>this.dateService.isSameDate(new Date(i.calendarDate),t.startDate));if(e.length>0){const n=i.getSelectedDay(e[0]);if(n){const e=n.assignedNutritionProgramDay;i.selectedDays.items=(null===(o=i.selectedDays)||void 0===o?void 0:o.items)||[];const a={};a.assignedNutritionProgramDay=e,i.setSelectedDay(a),t.addItem(new s.h(e.id,e.name,t,new l.k(e.nutritionProgramName,e.nutritionProgramId,e)))}else i.dayService.getWithDetailsAsync(this.selected,e[0].id,e[0].calendarDate).subscribe(e=>{var n;i.selectedDays.items=(null===(n=i.selectedDays)||void 0===n?void 0:n.items)||[];const o={};o.assignedNutritionProgramDay=e,i.selectedDays.items.push(o),t.addItem(new s.h(e.id,e.name,t,new l.k(e.nutritionProgramName,e.nutritionProgramId,e)))})}}})}weekDeleted(t){}itemDeletedBulk(t){let i={};i.ids=t.map(t=>t.itemId),this.dayService.deleteBulk(i).subscribe()}itemDeleted(t){}itemEdited(t){this.modal.update(t.day,t.extraData,this.programConstrains)}itemCreated(t){this.modal.create(t,this.selected,this.programConstrains)}itemCopiedMoved(t){let i=[];t.data.forEach(t=>{let e;e={},console.log("itemCopiedMoved",t,t.day,t.item.extraData.assignedNutritionProgramId),e.newDayDate=this.dateService.removeUtcDate(t.day.startDate).toISOString(),e.oldDayId=t.item.itemId,e.oldDayDate=this.dateService.removeUtcDate(t.item.day.startDate).toISOString(),e.OldProgramId=t.item.extraData.assignedNutritionProgramId,i.push(e)});let e={};e.copy=t.isCopy,e.programId=this.selected,e.moveData=i,this.pastData=t.data,this.pastDataInput=e,this.isShowPastModal=!0,e.copy&&1===this.pastDataInput.moveData.length?this.multiplay.show(1):(this.pastDataInput.adjustValues=0,this.pastConfimed())}onMultiplyConfirm(t){let i=t-1;i=i<0?0:i,this.pastDataInput.multiplyFactor=i,this.pastConfimed()}getDayKey(t){const i=`assinged_nt_${t.assignedNutritionProgramId}_${t.calendarDate}`.replace("T00:00:00Z","").replace("T00:00:00","");return console.log("key",i),i}setSelectedDay(t){this.selectedDays.items.push(t);try{const i=this.getDayKey(t.assignedNutritionProgramDay),e=JSON.stringify({on:Date(),data:t});this.localCacheService.put(i,e,this.ttl)}catch(i){this.clearStorage()}}clearStorage(){for(var t in console.log("clearing storage"),this.localCacheService.clearAll(),localStorage)t.startsWith("assinged_")&&localStorage.removeItem(t)}getSelectedDay(t){var i,e;const n=this.getDayKey(t),o=this.localCacheService.get(n);if(!o||0===o.length)return null;const a=JSON.parse(o);return(null===(e=null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.assignedNutritionProgramDay)||void 0===e?void 0:e.calendarDate)&&a.on?(a.data.assignedNutritionProgramDay.calendarDate=new Date(a.data.assignedNutritionProgramDay.calendarDate),this.isForceRefresh?(setTimeout(()=>{this.isForceRefresh=!1},2e3),null):a.data):null}refreshCache(){const t=this;t.clearStorage(),t.selectedDays.items=[],t.selectedDaysSimple.items=[],t.loadSimpleDays(()=>{t.isForceRefresh=!0,t.board.calendarService.boardDto.weeks.forEach((i,e)=>{i.isVisible&&t.weekCreated(i)})})}pastConfimed(){const t=this,i=t.pastDataInput;let e=[];t.pastData.forEach(i=>{let n;n={},n.newDayDate=t.dateService.removeUtcDate(i.day.startDate).toISOString(),n.oldDayId=i.item.itemId,n.oldDayDate=this.dateService.removeUtcDate(i.item.day.startDate).toISOString(),n.OldProgramId=i.item.extraData.assignedNutritionProgramId,console.log("pastConfimed",i,i.item.extraData.assignedNutritionProgramId),e.push(n)}),t.programService.moveItemByInput(i).subscribe(i=>{t.pastData.forEach(i=>{t.selectedDays.items=t.selectedDays.items.filter(t=>t.assignedNutritionProgramDay.id!=i.item.itemId),t.board.deattachItem(i.item)}),i.items.forEach(i=>{t.selectedDays.items=t.selectedDays.items.filter(t=>t.assignedNutritionProgramDay.id!=i.assignedNutritionProgramDay.id),t.setSelectedDay(i);let e=new s.h(i.assignedNutritionProgramDay.id,i.assignedNutritionProgramDay.name,void 0,new l.k(i.assignedNutritionProgramDay.nutritionProgramName,i.assignedNutritionProgramDay.nutritionProgramId,i.assignedNutritionProgramDay));t.board.attachItemOnDate(e,new Date(i.assignedNutritionProgramDay.calendarDate))}),t.toaster.success("::Pasted","::ItemsPasteSuccessfully"),t.analyticsService.log(g.O.do_past_Program_assigned_nutrition)})}onAssigned(t){setTimeout(()=>{this.sub&&this.sub.unsubscribe(),this.refresh.emit()},100)}get isCurrentUserAdmin(){return this.permissionService.getGrantedPolicy("PhysicAdmin")}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(n.XNV),o.Y36(n.vR3),o.Y36(p.Jq),o.Y36(p.BA),o.Y36(m.YP),o.Y36(a.R),o.Y36(h.gz),o.Y36(d.v),o.Y36(f.F),o.Y36(h.F0),o.Y36(b.C),o.Y36(m.MJ),o.Y36(n.$AH),o.Y36(g.y),o.Y36(y.qu))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-assigned-nutrition-program-manage"]],viewQuery:function(t,i){if(1&t&&(o.Gf(Qt,5),o.Gf(zt,5),o.Gf(Bt,5)),2&t){let t;o.iGM(t=o.CRH())&&(i.modal=t.first),o.iGM(t=o.CRH())&&(i.board=t.first),o.iGM(t=o.CRH())&&(i.multiplay=t.first)}},inputs:{traineeUserId:"traineeUserId"},outputs:{refresh:"refresh"},features:[o._Bn([n.XNV,a.R,d.v])],decls:14,vars:11,consts:[["class","d-flex bg-white rounded border",4,"ngIf"],[3,"hidden"],[3,"isDayFullHight","weekCreated","weekDeleted","itemDeletedBulk","itemDeleted","itemCreated","itemCopiedMoved","itemEdited",4,"ngIf"],[3,"dataChanged"],["modal",""],["assign",""],[3,"step","modalTitle","modalLabel","onConfirm"],["multiplay",""],["moveToLib",""],[1,"d-flex","bg-white","rounded","border"],[1,"col"],[1,"col-xl-4","col-lg-6"],[1,"py-5","fade-in-top","text-center"],[1,"fa","fa-exclamation-triangle","fa-3x","text-primary","mb-4"],[1,"text-muted"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"btn","btn-success",3,"click"],[3,"isDayFullHight","weekCreated","weekDeleted","itemDeletedBulk","itemDeleted","itemCreated","itemCopiedMoved","itemEdited"],["board",""],["selectionPanelContent",""],["itemContent",""],["navContent",""],[1,"btn","btn-sm","btn-success",3,"click"],[3,"assignedNutritionDayModel","isSummary","day"],[1,"d-flex","justify-content-sm-end"],[1,"custom-control","custom-switch","p-0"],[1,"btn-group"],["class","btn btn-outline-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-refresh"],[1,"btn","btn-outline-success","btn-sm",3,"click"]],template:function(t,i){1&t&&(o.YNc(0,Ht,14,7,"div",0),o.YNc(1,$t,13,6,"div",0),o.TgZ(2,"div",1),o.YNc(3,Xt,8,1,"app-board-container",2),o.TgZ(4,"app-assigned-nutrition-program-modal-day",3,4),o.NdJ("dataChanged",function(t){return i.dayDataChanged(t)}),o.qZA(),o._UZ(6,"app-assign-nutrition-program",null,5),o.TgZ(8,"past-adjust",6,7),o.NdJ("onConfirm",function(t){return i.onMultiplyConfirm(t)}),o.ALo(10,"abpLocalization"),o.ALo(11,"abpLocalization"),o.qZA(),o.qZA(),o._UZ(12,"app-move-to-lib-nutrition-program",null,8)),2&t&&(o.Q6J("ngIf",i.isLoading&&!i.isAssigned),o.xp6(1),o.Q6J("ngIf",!i.isLoading&&i.scheduledNutritionProgramId),o.xp6(1),o.Q6J("hidden",i.scheduledNutritionProgramId),o.xp6(1),o.Q6J("ngIf",!i.isLoading&&i.isAssigned),o.xp6(5),o.s9C("modalTitle",o.lcZ(10,7,"::MultiplyValues")),o.s9C("modalLabel",o.lcZ(11,9,"::Multiply")),o.Q6J("step",1))},directives:[v.O5,xt,At.v,It.m,St,_t.U,Et],pipes:[n.fuE],encapsulation:2}),t})()},77266:function(t,i,e){"use strict";e.d(i,{k:function(){return l}});var n=e(69244),o=e(35366),a=e(63491);class r{constructor(t){var i;this.onDeleted=new o.vpe,this.isEditing=!0,this.isDeleted=!1,this.id=t.id,this.nutrition=t.nutrition,this.nutritionNote=t.nutritionNote,this.quantity=t.quantity,this.optionId=t.optionId,this.done=t.done,this.actualCalorie=this.done?t.quantity*(null===(i=t.nutrition)||void 0===i?void 0:i.calories):0}getCalorie(){return this.nutrition?this.nutrition.calories*this.quantity:null}getCarbs(){return this.nutrition?this.nutrition.carbs*this.quantity:null}getProteins(){return this.nutrition?this.nutrition.proteins*this.quantity:null}getFats(){return this.nutrition?this.nutrition.fats*this.quantity:null}getNutritionTotals(){let t=new a.C;const i=this.quantity||0;return this.nutrition&&(t.calorie=this.nutrition.calories*i,t.carbs=this.nutrition.carbs*i,t.fats=this.nutrition.fats*i,t.proteins=this.nutrition.proteins*i),t}getImage(){var t;return null===(t=this.nutrition)||void 0===t?void 0:t.imageAttachmentId}edit(){this.isEditing=!0,this.backup={nutrition:this.nutrition,quantity:this.quantity}}cancel(){this.backup&&this.backup.nutrition?(this.isEditing=!1,this.nutrition=this.backup.nutrition,this.quantity=this.backup.quantity):this.delete()}quantityIsInvalid(){return!this.quantity||this.quantity<0}nutritionIsInvalid(){return!this.nutrition}hasErrors(){return this.quantityIsInvalid()||this.nutritionIsInvalid()}save(){this.hasErrors()||(this.isEditing=!1)}delete(){this.isDeleted=!0,this.onDeleted.emit()}convertToDto(){var t;let i={};return i.id=this.id,i.nutritionId=null===(t=this.nutrition)||void 0===t?void 0:t.id,i.nutritionNote=this.nutritionNote,i.optionId=this.optionId,i.nutrition=this.nutrition,i.quantity=this.quantity||void 0,i}get NutritionNoteVisible(){var t;return this._NutritionNoteVisible||(null!==(t=this.nutritionNote)&&void 0!==t?t:"").length>0}set NutritionNoteVisible(t){this._NutritionNoteVisible=t,t||(this.nutritionNote=void 0)}}class s{constructor(t){this.onDeleted=new o.vpe,this.details=[],this.visibleOption2=!1,this.visibleOption3=!1,this.selectedOptionId=1,this.isDeleted=!1,this.actualCalorie=0,this.isAddingNewItem=!1,this.id=t.id,this.name=t.mealName,this.mealNotes1=t.mealNotes1,this.mealNotes2=t.mealNotes2,this.mealNotes3=t.mealNotes3,this.selectedOptionId=t.selectedOptionId||1,t.assignedNutritionProgramDayItemDetails&&t.assignedNutritionProgramDayItemDetails.length>0?t.assignedNutritionProgramDayItemDetails.forEach(t=>{this.appendGroup(t)}):this.addFakeData()}get detailsUnDeletedForActiveOption(){return this.details.filter(t=>!t.isDeleted&&t.optionId==this.selectedOptionId)}get detailsUnDeleted(){return this.details.filter(t=>!t.isDeleted)}GetDetailsUnDeletedForActiveOptionVisible(t){return!(2!==t||!this.visibleOption2)||!(3!==t||!this.visibleOption3)||this.details.filter(i=>!i.isDeleted&&i.optionId==t).length>0}addOption(){return this.GetDetailsUnDeletedForActiveOptionVisible(2)?this.GetDetailsUnDeletedForActiveOptionVisible(3)?void 0:(this.visibleOption3=!0,void(this.selectedOptionId=3)):(this.visibleOption2=!0,void(this.selectedOptionId=2))}addFakeData(){}appendGroup(t){t.optionId=t.optionId||this.selectedOptionId;let i=new r(t);return this.details.push(i),this.listenToDelete(i),i}listenToDelete(t){t.onDeleted.subscribe(t=>{0==this.detailsUnDeleted.length&&this.delete()})}isEditing(){let t=!1;return this.detailsUnDeleted.forEach(i=>{t=t||i.isEditing}),t}delete(){this.isDeleted=!0,this.onDeleted.emit()}addNewDetail(t){const i=this.selectedOptionId;if(this.detailsUnDeleted.length>0){const e=this.detailsUnDeleted[this.detailsUnDeleted.length-1];if(e.optionId===i&&!e.nutrition)return e.nutrition=t,void(e.quantity=1);if(e.optionId===i&&e.nutrition.id==t.id)return void(e.quantity=(e.quantity||0)+1)}let e={};t&&(console.log("adding-detail-1",t),e.nutrition=t,e.nutritionId=t.id,e.optionId=i,e.quantity=1),this.appendGroup(e).edit()}isValid(){let t=!0;return this.detailsUnDeleted.forEach(t=>{t.save()}),this.detailsUnDeleted.forEach(i=>{t&&(t=!i.hasErrors())}),this.detailsUnDeleted.forEach(t=>{t.edit()}),t}convertToDto(){let t={};return t.id=this.id,t.mealName=this.name,t.mealNotes1=this.mealNotes1,t.mealNotes2=this.mealNotes2,t.mealNotes3=this.mealNotes3,t.selectedOptionId=this.selectedOptionId,t.assignedNutritionProgramDayItemDetails=[],this.detailsUnDeleted.forEach(i=>{t.assignedNutritionProgramDayItemDetails.push(i.convertToDto())}),t}getCalorie(){let t=0,i=0;return this.detailsUnDeletedForActiveOption.forEach(e=>{t+=e.getCalorie(),i+=e.actualCalorie||0}),this.actualCalorie=i,t}getCarbs(){let t=0,i=0;return this.detailsUnDeletedForActiveOption.forEach(e=>{t+=e.getCarbs(),i+=e.actualCalorie||0}),t}getProteins(){let t=0,i=0;return this.detailsUnDeletedForActiveOption.forEach(e=>{t+=e.getProteins(),i+=e.actualCalorie||0}),t}getFats(){let t=0,i=0;return this.detailsUnDeletedForActiveOption.forEach(e=>{t+=e.getFats(),i+=e.actualCalorie||0}),t}getNutritionTotals(){let t=new a.C;return this.detailsUnDeletedForActiveOption.forEach(i=>{t.add(i.getNutritionTotals())}),t}get mealNotes(){return 1===this.selectedOptionId?this.mealNotes1:2===this.selectedOptionId?this.mealNotes2:3===this.selectedOptionId?this.mealNotes3:void 0}set mealNotes(t){1===this.selectedOptionId&&(this.mealNotes1=t),2===this.selectedOptionId&&(this.mealNotes2=t),3===this.selectedOptionId&&(this.mealNotes3=t)}}class l{constructor(t,i,e){this.nutritionProgramName=t,this.nutritionProgramId=i,this.onDelete=new o.vpe,this.nutritionDayItems=[],this.isEditingMealName=!1,this.actualCalorie=0,e&&(this.id=e.id,this.dayNumber=e.dayNumber,this.name=e.name||" ",this.calendarDate=e.calendarDate,this.lastModificationTime=e.lastModificationTime,this.completePercent=e.completePercent,this.totalDayCaloriesMin=e.totalDayCaloriesMin,this.totalDayCaloriesMax=e.totalDayCaloriesMax,this.assignedNutritionProgramId=e.assignedNutritionProgramId,e.assignedNutritionProgramDayItems&&e.assignedNutritionProgramDayItems.length>0?e.assignedNutritionProgramDayItems.forEach(t=>{this.add(t)}):this.addFakeData())}get nutritionDayItemsUnDeleted(){return this.nutritionDayItems.filter(t=>!t.isDeleted)}addFakeData(){}add(t){const i=this,e=i.nutritionDayItemsUnDeleted.filter(i=>i.name==t.mealName);if(e.length>0)return e[0];let n=new s(t);return n.onDeleted.subscribe(t=>{i.onDelete.emit(i.nutritionDayItemsUnDeleted.length)}),this.nutritionDayItems.push(n),n}addNewDetail(t){let i={};i.mealName=t,this.add(i).addNewDetail()}convertToDto(){let t={};return t.id=this.id,t.dayNumber=this.dayNumber,t.assignedNutritionProgramId=this.assignedNutritionProgramId,t.calendarDate=this.calendarDate,t.totalDayCaloriesMin=this.totalDayCaloriesMin,t.totalDayCaloriesMax=this.totalDayCaloriesMax,t.lastModificationTime=this.lastModificationTime,t.completePercent=this.completePercent,t.nutritionProgramId=this.nutritionProgramId,t.name=this.name,t.assignedNutritionProgramDayItems=[],this.nutritionDayItemsUnDeleted.forEach(i=>{t.assignedNutritionProgramDayItems.push(i.convertToDto())}),t}isAllSuperSetsValid(){let t=!0;return this.nutritionDayItemsUnDeleted.forEach(t=>{t.isValid()}),this.nutritionDayItemsUnDeleted.forEach(i=>{t&&(t=i.isValid())}),t}isEditing(){let t=!1;return this.nutritionDayItemsUnDeleted.forEach(i=>{t=t||i.isEditing()}),t}getCalorie(){let t=0,i=0;return this.nutritionDayItemsUnDeleted.forEach(e=>{t+=e.getCalorie(),i+=e.actualCalorie||0}),this.actualCalorie=i,t}getCarbs(){let t=0,i=0;return this.nutritionDayItemsUnDeleted.forEach(e=>{t+=e.getCarbs(),i+=e.actualCalorie||0}),t}getProteins(){let t=0,i=0;return this.nutritionDayItemsUnDeleted.forEach(e=>{t+=e.getProteins(),i+=e.actualCalorie||0}),t}getFats(){let t=0,i=0;return this.nutritionDayItemsUnDeleted.forEach(e=>{t+=e.getFats(),i+=e.actualCalorie||0}),t}getNutritionTotals(){let t=new a.C;return this.nutritionDayItemsUnDeleted.forEach(i=>{t.add(i.getNutritionTotals())}),t}up(t){const i=[...this.nutritionDayItemsUnDeleted],e=i.indexOf(t);(0,n.bA)(i,e,e+1),this.nutritionDayItems=i}down(t){const i=[...this.nutritionDayItemsUnDeleted],e=i.indexOf(t);(0,n.bA)(i,e,e-1),this.nutritionDayItems=i}}}}]);