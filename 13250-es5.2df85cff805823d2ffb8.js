!function(){function e(i,a,o){return(e=t()?Reflect.construct:function(e,t,i){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return i&&n(o,i.prototype),o}).apply(null,arguments)}function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[13250],{13250:function(t,n,a){"use strict";a.r(n),a.d(n,{CreateEdition:function(){return it},CreateTenant:function(){return We},DEFAULT_SAAS_CREATE_FORM_PROPS:function(){return wt},DEFAULT_SAAS_EDIT_FORM_PROPS:function(){return Et},DEFAULT_SAAS_ENTITY_ACTIONS:function(){return Nt},DEFAULT_SAAS_ENTITY_PROPS:function(){return Ft},DEFAULT_SAAS_TOOLBAR_ACTIONS:function(){return kt},DeleteEdition:function(){return ot},DeleteTenant:function(){return et},EditionService:function(){return ut},EditionsComponent:function(){return pt},EditionsUsageWidgetComponent:function(){return gt},GetEditionById:function(){return nt},GetEditions:function(){return tt},GetLatestTenants:function(){return st},GetTenantById:function(){return Ke},GetTenants:function(){return $e},GetUsageStatistics:function(){return rt},LatestTenantsWidgetComponent:function(){return vt},SAAS_CREATE_FORM_PROP_CONTRIBUTORS:function(){return _t},SAAS_EDIT_FORM_PROP_CONTRIBUTORS:function(){return Lt},SAAS_ENTITY_ACTION_CONTRIBUTORS:function(){return qt},SAAS_ENTITY_PROP_CONTRIBUTORS:function(){return Mt},SAAS_TOOLBAR_ACTION_CONTRIBUTORS:function(){return Ot},SaasExtensionsGuard:function(){return It},SaasModule:function(){return Bt},SaasState:function(){return lt},SaasStateService:function(){return Yt},TenantService:function(){return ct},TenantsComponent:function(){return ft},UpdateEdition:function(){return at},UpdateTenant:function(){return Xe},"\u02750":function(){return dt},"\u0275a":function(){return ft},"\u0275ba":function(){return Mt},"\u0275bb":function(){return _t},"\u0275bc":function(){return Lt},"\u0275c":function(){return lt},"\u0275d":function(){return ct},"\u0275e":function(){return ut},"\u0275f":function(){return $e},"\u0275g":function(){return We},"\u0275h":function(){return Xe},"\u0275i":function(){return et},"\u0275j":function(){return tt},"\u0275k":function(){return it},"\u0275l":function(){return at},"\u0275m":function(){return ot},"\u0275n":function(){return rt},"\u0275o":function(){return st},"\u0275t":function(){return pt},"\u0275u":function(){return gt},"\u0275v":function(){return vt},"\u0275w":function(){return Jt},"\u0275x":function(){return It},"\u0275y":function(){return qt},"\u0275z":function(){return Ot}});var r=a(64762),c=a(46700),l=a(55679),d=a(97116),p=a(35366),f=a(48400),g=a(44019),v=a(11520),h=a(44689),m=a(90611),y=a(79996),T=a(88414),b=a(31041),S=a(40878),C=a(78512),Z=a(83845),A=a(10135),x=a(61116);function N(e,t){1&e&&(p.TgZ(0,"h3"),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()),2&e&&(p.xp6(1),p.Oqu(p.lcZ(2,1,"AbpFeatureManagement::Features")))}function k(e,t){1&e&&p.GkF(0)}var F=function(e){return{$implicit:e}};function w(e,t){if(1&e){var n=p.EpF();p.ynx(0),p.TgZ(1,"div",22),p.TgZ(2,"input",23),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw().$implicit.value=e})("ngModelChange",function(e){p.CHM(n);var t=p.oxw().$implicit;return p.oxw(5).onCheckboxClick(e,t)}),p.qZA(),p.TgZ(3,"label",24),p._uU(4),p.qZA(),p.YNc(5,k,1,0,"ng-container",25),p.qZA(),p.BQk()}if(2&e){var i=p.oxw().$implicit;p.oxw(3);var a=p.MAs(6);p.xp6(2),p.Q6J("id",i.name)("ngModel",i.value),p.xp6(1),p.Q6J("htmlFor",i.name),p.xp6(1),p.Oqu(i.displayName),p.xp6(1),p.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",p.VKq(6,F,i.description))}}function E(e,t){1&e&&p.GkF(0)}function q(e,t){if(1&e){var n=p.EpF();p.ynx(0),p.TgZ(1,"div",26),p.TgZ(2,"label",27),p._uU(3),p.qZA(),p.TgZ(4,"input",28),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw().$implicit.value=e}),p.qZA(),p.YNc(5,E,1,0,"ng-container",25),p.qZA(),p.BQk()}if(2&e){var i=p.oxw().$implicit;p.oxw(3);var a=p.MAs(6);p.xp6(2),p.Q6J("htmlFor",i.name),p.xp6(1),p.Oqu(i.displayName),p.xp6(1),p.Q6J("id",i.name)("ngModel",i.value)("abpFeatureManagementFreeText",i),p.xp6(1),p.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",p.VKq(7,F,i.description))}}function O(e,t){if(1&e&&(p.TgZ(0,"option",32),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()),2&e){var n=t.$implicit;p.Q6J("ngValue",n.value),p.xp6(1),p.hij(" ",p.lcZ(2,2,(null==n.displayText?null:n.displayText.resourceName)+"::"+(null==n.displayText?null:n.displayText.name)),"")}}function M(e,t){1&e&&p.GkF(0)}function _(e,t){if(1&e){var n=p.EpF();p.ynx(0),p.TgZ(1,"div",26),p.TgZ(2,"label",27),p._uU(3),p.qZA(),p.TgZ(4,"select",30),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw(2).$implicit.value=e}),p.YNc(5,O,3,4,"option",31),p.qZA(),p.YNc(6,M,1,0,"ng-container",25),p.qZA(),p.BQk()}if(2&e){var i=p.oxw(2).$implicit;p.oxw(3);var a=p.MAs(6),o=p.oxw(2);p.xp6(2),p.Q6J("htmlFor",i.name),p.xp6(1),p.Oqu(i.displayName),p.xp6(1),p.Q6J("id",i.name)("ngModel",i.value),p.xp6(1),p.Q6J("ngForOf",null==i.valueType.itemSource?null:i.valueType.itemSource.items)("ngForTrackBy",o.track.by("value")),p.xp6(1),p.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",p.VKq(8,F,i.description))}}function L(e,t){if(1&e&&(p.ynx(0),p.YNc(1,_,7,10,"ng-container",29),p.BQk()),2&e){var n=p.oxw().$implicit;p.xp6(1),p.Q6J("ngIf",null==n.valueType.itemSource||null==n.valueType.itemSource.items?null:n.valueType.itemSource.items.length)}}function I(e,t){if(1&e&&(p.ynx(0),p._uU(1),p.BQk()),2&e){var n=p.oxw().$implicit;p.xp6(1),p.Oqu(n.displayName)}}function U(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"div",19),p.NdJ("keyup.enter",function(){return p.CHM(n),p.oxw(5).save()}),p.YNc(1,w,6,8,"ng-container",20),p.YNc(2,q,6,9,"ng-container",20),p.YNc(3,L,2,1,"ng-container",20),p.YNc(4,I,2,1,"ng-container",21),p.qZA()}if(2&e){var i=t.$implicit,a=p.oxw(5);p.Q6J("ngStyle",i.style)("ngSwitch",null==i.valueType?null:i.valueType.name),p.xp6(1),p.Q6J("ngSwitchCase",a.valueTypes.ToggleStringValueType),p.xp6(1),p.Q6J("ngSwitchCase",a.valueTypes.FreeTextStringValueType),p.xp6(1),p.Q6J("ngSwitchCase",a.valueTypes.SelectionStringValueType)}}function J(e,t){if(1&e&&(p.TgZ(0,"h4"),p._uU(1),p.qZA(),p._UZ(2,"hr",17),p.YNc(3,U,5,5,"div",18)),2&e){var n=p.oxw().$implicit,i=p.oxw(3);p.xp6(1),p.Oqu(i.selectedGroupDisplayName),p.xp6(2),p.Q6J("ngForOf",i.features[n.name])("ngForTrackBy",i.track.by("id"))}}function B(e,t){if(1&e&&(p.TgZ(0,"li",14),p.TgZ(1,"a",15),p._uU(2),p.qZA(),p.YNc(3,J,4,3,"ng-template",16),p.qZA()),2&e){var n=t.$implicit;p.Q6J("ngbNavItem",n.displayName),p.xp6(2),p.Oqu(n.displayName)}}function Y(e,t){if(1&e&&(p.TgZ(0,"small",34),p._uU(1),p.qZA()),2&e){var n=p.oxw().$implicit;p.xp6(1),p.Oqu(n)}}function Q(e,t){1&e&&p.YNc(0,Y,2,1,"small",33),2&e&&p.Q6J("ngIf",t.$implicit)}function P(e,t){1&e&&(p.TgZ(0,"div",35),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()),2&e&&(p.xp6(1),p.hij(" ",p.lcZ(2,1,"AbpFeatureManagement::NoFeatureFoundMessage")," "))}function D(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"div",5),p.TgZ(1,"div",6),p.TgZ(2,"ul",7,8),p.NdJ("activeIdChange",function(e){return p.CHM(n),p.oxw(2).selectedGroupDisplayName=e}),p.YNc(4,B,4,2,"li",9),p.qZA(),p.qZA(),p.YNc(5,Q,1,1,"ng-template",null,10,p.W1O),p.TgZ(7,"div",11),p._UZ(8,"div",12),p.qZA(),p.YNc(9,P,3,3,"div",13),p.qZA()}if(2&e){var i=p.MAs(3),a=p.oxw(2);p.xp6(2),p.Q6J("activeId",a.selectedGroupDisplayName),p.xp6(2),p.Q6J("ngForOf",a.groups)("ngForTrackBy",a.track.by("name")),p.xp6(4),p.Q6J("ngbNavOutlet",i),p.xp6(1),p.Q6J("ngIf",!a.groups.length)}}function R(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"abp-button",39),p.NdJ("click",function(){return p.CHM(n),p.oxw(3).save()}),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()}if(2&e){var i=p.oxw(3);p.Q6J("disabled",i.modalBusy),p.xp6(1),p.hij(" ",p.lcZ(2,2,"AbpFeatureManagement::Save")," ")}}function G(e,t){if(1&e&&(p.TgZ(0,"button",36,37),p._uU(2),p.ALo(3,"abpLocalization"),p.qZA(),p.YNc(4,R,3,4,"abp-button",38)),2&e){var n=p.oxw(2);p.xp6(2),p.hij(" ",p.lcZ(3,2,"AbpFeatureManagement::Cancel")," "),p.xp6(2),p.Q6J("ngIf",n.groups.length)}}function V(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"abp-modal",1),p.NdJ("visibleChange",function(e){return p.CHM(n),p.oxw().visible=e}),p.YNc(1,N,3,3,"ng-template",null,2,p.W1O),p.YNc(3,D,10,5,"ng-template",null,3,p.W1O),p.YNc(5,G,5,4,"ng-template",null,4,p.W1O),p.qZA()}if(2&e){var i=p.oxw();p.Q6J("visible",i.visible)("busy",i.modalBusy)}}var j=function(){var e=function e(t){var n=this;u(this,e),this.restService=t,this.apiName="AbpFeatureManagement",this.get=function(e,t){return n.restService.request({method:"GET",url:"/api/feature-management/features",params:{providerName:e,providerKey:t}},{apiName:n.apiName})},this.update=function(e,t,i){return n.restService.request({method:"PUT",url:"/api/feature-management/features",params:{providerName:e,providerKey:t},body:i},{apiName:n.apiName})}};return e.\u0275fac=function(t){return new(t||e)(p.LFG(c.vgb))},e.\u0275prov=(0,p.Yz7)({factory:function(){return new e((0,p.LFG)(c.vgb))},token:e,providedIn:"root"}),e}(),z=function(e){return e.ToggleStringValueType="ToggleStringValueType",e.FreeTextStringValueType="FreeTextStringValueType",e.SelectionStringValueType="SelectionStringValueType",e}({}),H=function(){var e=function(){function e(t,n,i,a,o){u(this,e),this.track=t,this.service=n,this.store=i,this.configState=a,this.appConfigService=o,this.groups=[],this.valueTypes=z,this.visibleChange=new p.vpe,this.modalBusy=!1}return s(e,[{key:"visible",get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.visibleChange.emit(e),e&&this.openModal())}},{key:"openModal",value:function(){if(!this.providerName)throw new Error("providerName is required.");this.getFeatures()}},{key:"getFeatures",value:function(){var e=this;this.service.get(this.providerName,this.providerKey).subscribe(function(t){e.groups=t.groups.map(function(e){return{name:e.name,displayName:e.displayName}}),e.selectedGroupDisplayName=e.groups[0].displayName,e.features=t.groups.reduce(function(e,t){return Object.assign(Object.assign({},e),o({},t.name,(n=t.features,i=document.body.dir,a="margin-".concat("rtl"===i?"right":"left",".px"),n.map(function(e){var t,n=(null===(t=e.valueType)||void 0===t?void 0:t.name)===z.ToggleStringValueType?"true"===(e.value||"").toLowerCase():e.value;return Object.assign(Object.assign({},e),{value:n,initialValue:n,style:o({},a,20*e.depth)})}))));var n,i,a},{})})}},{key:"save",value:function(){var e=this;if(!this.modalBusy){var t=[];Object.keys(this.features).forEach(function(n){e.features[n].forEach(function(e){e.value!==e.initialValue&&t.push({name:e.name,value:"".concat(e.value)})})}),t.length?(this.modalBusy=!0,this.service.update(this.providerName,this.providerKey,{features:t}).pipe((0,v.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.visible=!1,e.providerKey||e.appConfigService.get().pipe((0,g.b)(function(t){return e.configState.setState(t)})).subscribe()})):this.visible=!1}}},{key:"onCheckboxClick",value:function(e,t){e?this.checkToggleAncestors(t):this.uncheckToggleDescendants(t)}},{key:"uncheckToggleDescendants",value:function(e){var t=this;this.findAllDescendantsOfByType(e,z.ToggleStringValueType).forEach(function(e){return t.setFeatureValue(e,!1)})}},{key:"checkToggleAncestors",value:function(e){var t=this;this.findAllAncestorsOfByType(e,z.ToggleStringValueType).forEach(function(e){return t.setFeatureValue(e,!0)})}},{key:"findAllAncestorsOfByType",value:function(e,t){for(var n=this.findParentByType(e,t),i=[];n;)i.push(n),n=this.findParentByType(n,t);return i}},{key:"findAllDescendantsOfByType",value:function(e,t){for(var n=[],a=[e];a.length;){var o=a.pop(),r=this.findChildrenByType(o,t);n.push.apply(n,i(r)),a.push.apply(a,i(r))}return n}},{key:"findParentByType",value:function(e,t){return this.getCurrentGroup().find(function(n){return n.valueType.name===t&&n.name===e.parentName})}},{key:"findChildrenByType",value:function(e,t){return this.getCurrentGroup().filter(function(n){return n.valueType.name===t&&n.parentName===e.name})}},{key:"getCurrentGroup",value:function(){var e;return null!==(e=this.features[this.selectedGroupDisplayName])&&void 0!==e?e:[]}},{key:"setFeatureValue",value:function(e,t){e.value=t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(p.Y36(c.vR3),p.Y36(j),p.Y36(f.yh),p.Y36(c.XJE),p.Y36(c.xa_))},e.\u0275cmp=p.Xpm({type:e,selectors:[["abp-feature-management"]],inputs:{visible:"visible",providerKey:"providerKey",providerName:"providerName"},outputs:{visibleChange:"visibleChange"},exportAs:["abpFeatureManagement"],decls:1,vars:1,consts:[["size","lg",3,"visible","busy","visibleChange",4,"ngIf"],["size","lg",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"row"],[1,"col-md-4"],["ngbNav","","orientation","vertical",1,"nav-pills",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem",4,"ngFor","ngForOf","ngForTrackBy"],["descTmp",""],[1,"col-md-8"],[3,"ngbNavOutlet"],["class","mx-3",4,"ngIf"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2","mb-3"],["class","mt-2",3,"ngStyle","ngSwitch","keyup.enter",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-2",3,"ngStyle","ngSwitch","keyup.enter"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"custom-checkbox","custom-control"],["type","checkbox",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"htmlFor"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"form-group"],[3,"htmlFor"],["type","text",1,"form-control",3,"id","ngModel","abpFeatureManagementFreeText","ngModelChange"],[4,"ngIf"],[1,"form-control","custom-select",3,"id","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngValue"],["class","form-text text-muted",4,"ngIf"],[1,"form-text","text-muted"],[1,"mx-3"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click",4,"ngIf"],["iconClass","fa fa-check",3,"disabled","click"]],template:function(e,t){1&e&&p.YNc(0,V,7,2,"abp-modal",0),2&e&&p.Q6J("ngIf",t.visible)},directives:function(){return[x.O5,l.zS,A.Pz,x.sg,A.tO,A.nv,A.Vx,A.uN,x.PC,x.RF,x.n9,x.ED,b.Wl,b.JJ,b.On,x.tP,b.Fj,K,b.EJ,b.YN,b.Kr,l.r0]},pipes:function(){return[c.fuE]},encapsulation:2}),e}();var $={numeric:"number",default:"text"},K=function(){var e=function(){function e(){u(this,e)}return s(e,[{key:"feature",get:function(){return this._feature},set:function(e){this._feature=e,this.setInputType()}},{key:"setInputType",value:function(){var e,t,n,i,a=null===(n=null===(t=null===(e=this.feature)||void 0===e?void 0:e.valueType)||void 0===t?void 0:t.validator)||void 0===n?void 0:n.name.toLowerCase();this.type=null!==(i=$[a])&&void 0!==i?i:$.default}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=p.lG2({type:e,selectors:[["input","abpFeatureManagementFreeText",""]],hostVars:1,hostBindings:function(e,t){2&e&&p.Ikx("type",t.type)},inputs:{feature:["abpFeatureManagementFreeText","feature"]},exportAs:["inputAbpFeatureManagementFreeText"]}),e}(),W=function(){var e=function e(){u(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[c.IR2,l.e2,A.Oz,f.$l.forFeature([])]]}),e}(),X=a(99046),ee=a(56410);function te(e,t){if(1&e){var n=p.EpF();p.ynx(0),p.TgZ(1,"div",6),p.TgZ(2,"div",7),p.TgZ(3,"h1",8),p._uU(4),p.ALo(5,"abpLocalization"),p.qZA(),p.qZA(),p.TgZ(6,"div",9),p._UZ(7,"abp-breadcrumb"),p.qZA(),p.TgZ(8,"div",10),p._UZ(9,"abp-page-toolbar",11),p.qZA(),p.qZA(),p.TgZ(10,"div",12),p.TgZ(11,"div",13),p.TgZ(12,"div",14),p.TgZ(13,"div",15),p.TgZ(14,"div",10),p.TgZ(15,"div",16),p.TgZ(16,"input",17),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw().list.filter=e}),p.ALo(17,"abpLocalization"),p.qZA(),p.TgZ(18,"div",18),p.TgZ(19,"button",19),p.NdJ("click",function(){return p.CHM(n),p.oxw().list.get()}),p._UZ(20,"i",20),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(21,"div",13),p._UZ(22,"abp-extensible-table",21),p.ALo(23,"async"),p.qZA(),p.qZA(),p.BQk()}if(2&e){var i=t.ngIf,a=p.oxw();p.xp6(4),p.Oqu(p.lcZ(5,7,"Saas::Editions")),p.xp6(5),p.Q6J("record",i),p.xp6(7),p.Q6J("placeholder",p.lcZ(17,9,"AbpUi::PagerSearch"))("ngModel",a.list.filter),p.xp6(6),p.Q6J("data",i)("recordsTotal",p.lcZ(23,11,a.totalCount$))("list",a.list)}}function ne(e,t){if(1&e&&(p.TgZ(0,"h3"),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()),2&e){var n=p.oxw();p.xp6(1),p.Oqu(p.lcZ(2,1,null!=n.selected&&n.selected.id?"Saas::Edit":"Saas::NewEdition"))}}function ie(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"form",22),p.NdJ("ngSubmit",function(){return p.CHM(n),p.oxw().save()}),p.TgZ(1,"div",23),p._UZ(2,"abp-extensible-form",24),p.qZA(),p.qZA()}if(2&e){var i=p.oxw();p.Q6J("formGroup",i.editionForm),p.xp6(2),p.Q6J("selectedRecord",i.selected)}}function ae(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"button",25,26),p._uU(2),p.ALo(3,"abpLocalization"),p.qZA(),p.TgZ(4,"abp-button",27),p.NdJ("click",function(){return p.CHM(n),p.oxw().save()}),p._uU(5),p.ALo(6,"abpLocalization"),p.qZA()}if(2&e){var i=p.oxw();p.xp6(2),p.hij(" ",p.lcZ(3,3,"Saas::Cancel")," "),p.xp6(2),p.Q6J("disabled",null==i.editionForm?null:i.editionForm.invalid),p.xp6(1),p.Oqu(p.lcZ(6,5,"AbpIdentity::Save"))}}function oe(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"abp-feature-management",28),p.NdJ("visibleChange",function(e){return p.CHM(n),p.oxw().visibleFeatures=e}),p.qZA()}if(2&e){var i=p.oxw();p.Q6J("visible",i.visibleFeatures)("providerKey",i.providerKey)}}var re=function(){return{value:"E"}},se=function(e){return{value:e}},ue=function(e){return{value:e,twoWay:!0}},ce=function(e,t,n){return{providerName:e,providerKey:t,visible:n}},le=function(e){return{visibleChange:e}},de=function(e,t){return{inputs:e,outputs:t,componentKey:"FeatureManagement.FeatureManagementComponent"}},pe=["tenantModalTemplate"],fe=["connectionStringModalTemplate"];function ge(e,t){if(1&e){var n=p.EpF();p.ynx(0),p.TgZ(1,"div",8),p.TgZ(2,"div",9),p.TgZ(3,"h1",10),p._uU(4),p.ALo(5,"abpLocalization"),p.qZA(),p.qZA(),p.TgZ(6,"div",11),p._UZ(7,"abp-breadcrumb"),p.qZA(),p.TgZ(8,"div",12),p._UZ(9,"abp-page-toolbar",13),p.qZA(),p.qZA(),p.TgZ(10,"div",14),p.TgZ(11,"div",15),p.TgZ(12,"div",16),p.TgZ(13,"div",17),p.TgZ(14,"div",12),p.TgZ(15,"div",18),p.TgZ(16,"input",19),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw().list.filter=e}),p.ALo(17,"abpLocalization"),p.qZA(),p.TgZ(18,"div",20),p.TgZ(19,"button",21),p.NdJ("click",function(){return p.CHM(n),p.oxw().list.get()}),p._UZ(20,"i",22),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(21,"div",15),p._UZ(22,"abp-extensible-table",23),p.ALo(23,"async"),p.qZA(),p.qZA(),p.BQk()}if(2&e){var i=t.ngIf,a=p.oxw();p.xp6(4),p.Oqu(p.lcZ(5,7,"Saas::Tenants")),p.xp6(5),p.Q6J("record",i),p.xp6(7),p.Q6J("placeholder",p.lcZ(17,9,"AbpUi::PagerSearch"))("ngModel",a.list.filter),p.xp6(6),p.Q6J("data",i)("recordsTotal",p.lcZ(23,11,a.totalCount$))("list",a.list)}}function ve(e,t){if(1&e&&(p.TgZ(0,"h3"),p._uU(1),p.ALo(2,"abpLocalization"),p.qZA()),2&e){var n=p.oxw();p.xp6(1),p.Oqu(p.lcZ(2,1,n.selectedModalContent.title))}}function he(e,t){1&e&&p.GkF(0)}function me(e,t){if(1&e&&p.YNc(0,he,1,0,"ng-container",24),2&e){var n=p.oxw();p.Q6J("ngTemplateOutlet",null==n.selectedModalContent?null:n.selectedModalContent.template)}}function ye(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"button",25,26),p._uU(2),p.ALo(3,"abpLocalization"),p.qZA(),p.TgZ(4,"abp-button",27),p.NdJ("click",function(){return p.CHM(n),p.oxw().save()}),p._uU(5),p.ALo(6,"abpLocalization"),p.qZA()}if(2&e){var i=p.oxw();p.xp6(2),p.hij(" ",p.lcZ(3,3,"Saas::Cancel")," "),p.xp6(2),p.Q6J("disabled",i.isDisabledSaveButton),p.xp6(1),p.Oqu(p.lcZ(6,5,"AbpIdentity::Save"))}}function Te(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"form",29),p.NdJ("ngSubmit",function(){return p.CHM(n),p.oxw(2).save()}),p.TgZ(1,"div",30),p._UZ(2,"abp-extensible-form",31),p.qZA(),p.qZA()}if(2&e){var i=p.oxw(2);p.Q6J("formGroup",i.tenantForm),p.xp6(2),p.Q6J("selectedRecord",i.selected)}}function be(e,t){if(1&e&&p.YNc(0,Te,3,2,"form",28),2&e){var n=p.oxw();p.Q6J("ngIf",n.tenantForm)}}function Se(e,t){1&e&&(p.TgZ(0,"div",33),p.TgZ(1,"label",38),p._uU(2),p.ALo(3,"abpLocalization"),p.qZA(),p._UZ(4,"input",39),p.qZA()),2&e&&(p.xp6(2),p.Oqu(p.lcZ(3,1,"Saas::DisplayName:DefaultConnectionString")))}function Ce(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"form",32),p.NdJ("ngSubmit",function(){return p.CHM(n),p.oxw().save()}),p.TgZ(1,"div",30),p.TgZ(2,"div",33),p.TgZ(3,"div",34),p.TgZ(4,"input",35),p.NdJ("ngModelChange",function(e){return p.CHM(n),p.oxw().onSharedDatabaseChange(e)}),p.qZA(),p.TgZ(5,"label",36),p._uU(6),p.ALo(7,"abpLocalization"),p.qZA(),p.qZA(),p.qZA(),p.YNc(8,Se,5,3,"div",37),p.qZA(),p.qZA()}if(2&e){var i=p.oxw();p.Q6J("formGroup",i.defaultConnectionStringForm),p.xp6(6),p.Oqu(p.lcZ(7,3,"Saas::DisplayName:UseSharedDatabase")),p.xp6(2),p.Q6J("ngIf",!i.useSharedDatabase)}}function Ze(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"abp-feature-management",40),p.NdJ("visibleChange",function(e){return p.CHM(n),p.oxw().visibleFeatures=e}),p.qZA()}if(2&e){var i=p.oxw();p.Q6J("visible",i.visibleFeatures)("providerKey",i.providerKey)}}var Ae=function(){return{value:"T"}};function xe(e,t){if(1&e){var n=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"div",2),p.TgZ(2,"div",3),p.TgZ(3,"h5",4),p._uU(4),p.ALo(5,"abpLocalization"),p.qZA(),p.qZA(),p.TgZ(6,"div",5),p.TgZ(7,"div",6),p.TgZ(8,"abp-chart",7,8),p.NdJ("initialized",function(e){return p.CHM(n),p.oxw().initialize(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()}if(2&e){var i=p.oxw();p.xp6(4),p.Oqu(p.lcZ(5,4,"Saas::EditionUsageStatistics")),p.xp6(4),p.Q6J("data",i.chartData)("width",i.width)("height",i.height)}}function Ne(e,t){if(1&e&&(p.TgZ(0,"tr"),p.TgZ(1,"th"),p._uU(2),p.qZA(),p.TgZ(3,"td"),p._uU(4),p.qZA(),p.TgZ(5,"td"),p._uU(6),p.qZA(),p.qZA()),2&e){var n=t.$implicit,i=t.index;p.xp6(2),p.Oqu(i+1),p.xp6(2),p.Oqu(n.name),p.xp6(2),p.Oqu(n.editionName)}}function ke(e,t){if(1&e&&(p.TgZ(0,"div",1),p.TgZ(1,"div",2),p.TgZ(2,"div",3),p.TgZ(3,"h5",4),p._uU(4,"Latest tenants"),p.qZA(),p.qZA(),p.TgZ(5,"div",5),p.TgZ(6,"div"),p.TgZ(7,"table",6),p.TgZ(8,"thead"),p.TgZ(9,"tr"),p.TgZ(10,"th"),p._uU(11,"#"),p.qZA(),p.TgZ(12,"th"),p._uU(13),p.ALo(14,"abpLocalization"),p.qZA(),p.TgZ(15,"th"),p._uU(16),p.ALo(17,"abpLocalization"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(18,"tbody"),p.YNc(19,Ne,7,3,"tr",7),p.ALo(20,"async"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e){var n=p.oxw();p.xp6(6),p.Udp("min-height",n.minHeight,"px"),p.xp6(7),p.Oqu(p.lcZ(14,6,"Saas::Name")),p.xp6(3),p.Oqu(p.lcZ(17,8,"Saas::EditionName")),p.xp6(3),p.Q6J("ngForOf",p.lcZ(20,10,n.datas$))("ngForTrackBy",n.trackByFn)}}var Fe,we,Ee,qe,Oe,Me,_e,Le,Ie,Ue,Je,Be,Ye,Qe,Pe,De,Re,Ge,Ve,je,ze,He,$e=((Pe=function e(t){u(this,e),this.payload=t}).type="[Saas] Get Tenant",Pe),Ke=((Qe=function e(t){u(this,e),this.payload=t}).type="[Saas] Get Tenant By Id",Qe),We=((Ye=function e(t){u(this,e),this.payload=t}).type="[Saas] Create Tenant",Ye),Xe=((Be=function e(t){u(this,e),this.payload=t}).type="[Saas] Update Tenant",Be),et=((Je=function e(t){u(this,e),this.payload=t}).type="[Saas] Delete Tenant",Je),tt=((Ue=function e(t){u(this,e),this.payload=t}).type="[Saas] Get Edition",Ue),nt=((Ie=function e(t){u(this,e),this.payload=t}).type="[Saas] Get Edition By Id",Ie),it=((Le=function e(t){u(this,e),this.payload=t}).type="[Saas] Create Edition",Le),at=((_e=function e(t){u(this,e),this.payload=t}).type="[Saas] Update Edition",_e),ot=((Me=function e(t){u(this,e),this.payload=t}).type="[Saas] Delete Edition",Me),rt=((Oe=function e(){u(this,e)}).type="[Saas] Get Usage Statistics",Oe),st=((qe=function e(){u(this,e)}).type="[Saas] Get Latest Tenatns",qe),ut=((Ee=function e(t){var n=this;u(this,e),this.restService=t,this.apiName="SaasHost",this.create=function(e){return n.restService.request({method:"POST",url:"/api/saas/editions",body:e},{apiName:n.apiName})},this.delete=function(e){return n.restService.request({method:"DELETE",url:"/api/saas/editions/".concat(e)},{apiName:n.apiName})},this.get=function(e){return n.restService.request({method:"GET",url:"/api/saas/editions/".concat(e)},{apiName:n.apiName})},this.getList=function(e){return n.restService.request({method:"GET",url:"/api/saas/editions",params:{filter:e.filter,sorting:e.sorting,skipCount:e.skipCount,maxResultCount:e.maxResultCount}},{apiName:n.apiName})},this.getUsageStatistics=function(){return n.restService.request({method:"GET",url:"/api/saas/editions/statistics/usage-statistic"},{apiName:n.apiName})},this.update=function(e,t){return n.restService.request({method:"PUT",url:"/api/saas/editions/".concat(e),body:t},{apiName:n.apiName})}}).\u0275fac=function(e){return new(e||Ee)(p.LFG(c.vgb))},Ee.\u0275prov=(0,p.Yz7)({factory:function(){return new Ee((0,p.LFG)(c.vgb))},token:Ee,providedIn:"root"}),Ee),ct=((we=function e(t){var n=this;u(this,e),this.restService=t,this.apiName="SaasHost",this.create=function(e){return n.restService.request({method:"POST",url:"/api/saas/tenants",body:e},{apiName:n.apiName})},this.delete=function(e){return n.restService.request({method:"DELETE",url:"/api/saas/tenants/".concat(e)},{apiName:n.apiName})},this.deleteDefaultConnectionString=function(e){return n.restService.request({method:"DELETE",url:"/api/saas/tenants/".concat(e,"/default-connection-string")},{apiName:n.apiName})},this.get=function(e){return n.restService.request({method:"GET",url:"/api/saas/tenants/".concat(e)},{apiName:n.apiName})},this.getDefaultConnectionString=function(e){return n.restService.request({method:"GET",url:"/api/saas/tenants/".concat(e,"/default-connection-string"),responseType:"text"},{apiName:n.apiName})},this.getList=function(e){return n.restService.request({method:"GET",url:"/api/saas/tenants",params:{filter:e.filter,getEditionNames:e.getEditionNames,sorting:e.sorting,skipCount:e.skipCount,maxResultCount:e.maxResultCount}},{apiName:n.apiName})},this.update=function(e,t){return n.restService.request({method:"PUT",url:"/api/saas/tenants/".concat(e),body:t},{apiName:n.apiName})},this.updateDefaultConnectionString=function(e,t){return n.restService.request({method:"PUT",url:"/api/saas/tenants/".concat(e,"/default-connection-string"),params:{defaultConnectionString:t}},{apiName:n.apiName})}}).\u0275fac=function(e){return new(e||we)(p.LFG(c.vgb))},we.\u0275prov=(0,p.Yz7)({factory:function(){return new we((0,p.LFG)(c.vgb))},token:we,providedIn:"root"}),we),lt=((Fe=function(){function e(t,n){u(this,e),this.tenantService=t,this.editionService=n}return s(e,[{key:"getTenants",value:function(e,t){var n=e.patchState,i=t.payload;return this.tenantService.getList(i).pipe((0,g.b)(function(e){return n({tenants:e})}))}},{key:"deleteTenant",value:function(e,t){var n=t.payload;return this.tenantService.delete(n)}},{key:"createTenant",value:function(e,t){var n=t.payload;return this.tenantService.create(n)}},{key:"updateTenant",value:function(e,t){var n=t.payload,i=n.id,a=(0,r._T)(n,["id"]);return this.tenantService.update(i,a)}},{key:"getEditions",value:function(e,t){var n=e.patchState,i=t.payload;return this.editionService.getList(i).pipe((0,g.b)(function(e){return n({editions:e})}))}},{key:"deleteEdition",value:function(e,t){var n=t.payload;return this.editionService.delete(n)}},{key:"createEdition",value:function(e,t){var n=t.payload;return this.editionService.create(n)}},{key:"updateEdition",value:function(e,t){var n=t.payload,i=n.id,a=(0,r._T)(n,["id"]);return this.editionService.update(i,a)}},{key:"getUsage",value:function(e){var t=e.patchState;return this.editionService.getUsageStatistics().pipe((0,g.b)(function(e){t({usageStatistics:e.data})}))}},{key:"getLatestTenants",value:function(e){var t=e.patchState;return this.tenantService.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).pipe((0,g.b)(function(e){t({latestTenants:e.items})}))}}],[{key:"getTenants",value:function(e){return e.tenants.items||[]}},{key:"getLatestTenants",value:function(e){return e.latestTenants}},{key:"getTenantsTotalCount",value:function(e){return e.tenants.totalCount||0}},{key:"getEditions",value:function(e){return e.editions.items||[]}},{key:"getEditionsTotalCount",value:function(e){return e.editions.totalCount||0}},{key:"getUsageStatistics",value:function(e){return e.usageStatistics}}]),e}()).\u0275fac=function(e){return new(e||Fe)(p.LFG(ct),p.LFG(ut))},Fe.\u0275prov=p.Yz7({token:Fe,factory:function(e){return Fe.\u0275fac(e)}}),(0,r.gn)([(0,f.aU)($e)],Fe.prototype,"getTenants",null),(0,r.gn)([(0,f.aU)(et)],Fe.prototype,"deleteTenant",null),(0,r.gn)([(0,f.aU)(We)],Fe.prototype,"createTenant",null),(0,r.gn)([(0,f.aU)(Xe)],Fe.prototype,"updateTenant",null),(0,r.gn)([(0,f.aU)(tt)],Fe.prototype,"getEditions",null),(0,r.gn)([(0,f.aU)(ot)],Fe.prototype,"deleteEdition",null),(0,r.gn)([(0,f.aU)(it)],Fe.prototype,"createEdition",null),(0,r.gn)([(0,f.aU)(at)],Fe.prototype,"updateEdition",null),(0,r.gn)([(0,f.aU)(rt)],Fe.prototype,"getUsage",null),(0,r.gn)([(0,f.aU)(st)],Fe.prototype,"getLatestTenants",null),(0,r.gn)([(0,f.Qf)()],Fe,"getTenants",null),(0,r.gn)([(0,f.Qf)()],Fe,"getLatestTenants",null),(0,r.gn)([(0,f.Qf)()],Fe,"getTenantsTotalCount",null),(0,r.gn)([(0,f.Qf)()],Fe,"getEditions",null),(0,r.gn)([(0,f.Qf)()],Fe,"getEditionsTotalCount",null),(0,r.gn)([(0,f.Qf)()],Fe,"getUsageStatistics",null),Fe=(0,r.gn)([(0,f.ZM)({name:"SaasState",defaults:{tenants:{},editions:{},latestTenants:[],usageStatistics:{}}})],Fe)),dt="Saas.EditionsComponent",pt=((Ve=function(){function e(t,n,i,a,o){var r=this;u(this,e),this.list=t,this.confirmationService=n,this.editionService=i,this.store=a,this.injector=o,this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=function(e){r.visibleFeatures=e}}return s(e,[{key:"ngOnInit",value:function(){this.hookToQuery()}},{key:"hookToQuery",value:function(){var e=this;this.list.hookToQuery(function(t){return e.store.dispatch(new tt(t))}).subscribe()}},{key:"createEditionForm",value:function(){var e=new d.lg(this.injector,this.selected);this.editionForm=(0,d.se)(e)}},{key:"onAddEdition",value:function(){this.selected={},this.createEditionForm(),this.isModalVisible=!0}},{key:"onEditEdition",value:function(e){var t=this;this.editionService.get(e).subscribe(function(e){t.selected=e,t.createEditionForm(),t.isModalVisible=!0})}},{key:"save",value:function(){var e=this;this.editionForm.valid&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new at(Object.assign(Object.assign(Object.assign({},this.selected),this.editionForm.value),{id:this.selected.id})):new it(this.editionForm.value)).pipe((0,v.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.list.get(),e.isModalVisible=!1}))}},{key:"delete",value:function(e){var t=this,n=e.id,i=e.displayName;this.confirmationService.warn("Saas::EditionDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[i]}).subscribe(function(e){e===l.Tv.Status.confirm&&t.store.dispatch(new ot(n)).subscribe(function(){return t.list.get()})})}},{key:"openFeaturesModal",value:function(e){var t=this;this.providerKey=e,setTimeout(function(){t.visibleFeatures=!0},0)}}]),e}()).\u0275fac=function(e){return new(e||Ve)(p.Y36(c.XNV),p.Y36(l.YP),p.Y36(ut),p.Y36(f.yh),p.Y36(p.zs3))},Ve.\u0275cmp=p.Xpm({type:Ve,selectors:[["abp-editions"]],features:[p._Bn([c.XNV,{provide:d.ex,useValue:dt}])],decls:10,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["providerName","E",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["providerName","E",3,"visible","providerKey","visibleChange"]],template:function(e,t){1&e&&(p.YNc(0,te,24,13,"ng-container",0),p.ALo(1,"async"),p.TgZ(2,"abp-modal",1),p.NdJ("visibleChange",function(e){return t.isModalVisible=e})("disappear",function(){return t.editionForm=null}),p.YNc(3,ne,3,3,"ng-template",null,2,p.W1O),p.YNc(5,ie,3,2,"ng-template",null,3,p.W1O),p.YNc(7,ae,7,7,"ng-template",null,4,p.W1O),p.qZA(),p.YNc(9,oe,1,2,"abp-feature-management",5)),2&e&&(p.Q6J("ngIf",p.lcZ(1,4,t.data$)),p.xp6(2),p.Q6J("visible",t.isModalVisible)("busy",t.modalBusy),p.xp6(7),p.Q6J("abpReplaceableTemplate",p.WLB(17,de,p.kEZ(11,ce,p.DdM(6,re),p.VKq(7,se,t.providerKey),p.VKq(9,ue,t.visibleFeatures)),p.VKq(15,le,t.onVisibleFeaturesChange))))},directives:[x.O5,l.zS,c.zLP,l.LI,d._V,b.Fj,b.JJ,b.On,d.m5,b._Y,b.JL,c.YzZ,X.hL,b.sg,d.gt,l.r0,H],pipes:[x.Ov,c.fuE],encapsulation:2}),(0,r.gn)([(0,f.Ph)(lt.getEditions)],Ve.prototype,"data$",void 0),(0,r.gn)([(0,f.Ph)(lt.getEditionsTotalCount)],Ve.prototype,"totalCount$",void 0),Ve),ft=((Ge=function(){function e(t,n,i,a,o,r){var s=this;u(this,e),this.list=t,this.confirmationService=n,this.tenantService=i,this.fb=a,this.store=o,this.injector=r,this.selectedModalContent={},this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=function(e){s.visibleFeatures=e}}return s(e,[{key:"useSharedDatabase",get:function(){return this.defaultConnectionStringForm.get("useSharedDatabase").value}},{key:"connectionString",get:function(){return this.defaultConnectionStringForm.get("defaultConnectionString").value}},{key:"hasSelectedTenant",get:function(){return Boolean(this.selected.id)}},{key:"isDisabledSaveButton",get:function(){return!(!this.selectedModalContent||!("saveConnStr"===this.selectedModalContent.type&&this.defaultConnectionStringForm&&this.defaultConnectionStringForm.invalid||"saveTenant"===this.selectedModalContent.type&&this.tenantForm&&this.tenantForm.invalid))}},{key:"ngOnInit",value:function(){this.hookToQuery()}},{key:"hookToQuery",value:function(){var e=this;this.list.hookToQuery(function(t){return e.store.dispatch(new $e(t))}).subscribe()}},{key:"createTenantForm",value:function(){var e=this;this.store.select(lt.getEditions).pipe((0,h.w)(function(t){return t.length?(0,S.of)(t):e.store.dispatch(new tt({maxResultCount:1e3}))})).subscribe(function(){var t=new d.lg(e.injector,e.selected);e.tenantForm=(0,d.se)(t)})}},{key:"createDefaultConnectionStringForm",value:function(){this.defaultConnectionStringForm=this.fb.group({useSharedDatabase:this._useSharedDatabase,defaultConnectionString:this.defaultConnectionString||""})}},{key:"openModal",value:function(e,t,n){this.selectedModalContent={title:e,template:t,type:n},this.isModalVisible=!0}},{key:"onEditConnectionString",value:function(e){var t=this;this.tenantService.get(e).pipe((0,g.b)(function(e){return t.selected=e}),(0,h.w)(function(){return t.tenantService.getDefaultConnectionString(e)})).subscribe(function(e){t._useSharedDatabase=!e,t.defaultConnectionString=e||"",t.createDefaultConnectionStringForm(),t.openModal("Saas::ConnectionStrings",t.connectionStringModalTemplate,"saveConnStr")})}},{key:"onAddTenant",value:function(){this.selected={},this.createTenantForm(),this.openModal("Saas::NewTenant",this.tenantModalTemplate,"saveTenant")}},{key:"onEditTenant",value:function(e){var t=this;this.tenantService.get(e).subscribe(function(e){t.selected=e,t.createTenantForm(),t.openModal("Saas::Edit",t.tenantModalTemplate,"saveTenant")})}},{key:"save",value:function(){var e=this.selectedModalContent.type;e&&("saveTenant"===e?this.saveTenant():"saveConnStr"===e&&this.saveConnectionString())}},{key:"saveConnectionString",value:function(){var e=this;this.modalBusy||(this.modalBusy=!0,this.useSharedDatabase||!this.useSharedDatabase&&!this.connectionString?this.tenantService.deleteDefaultConnectionString(this.selected.id).pipe((0,m.q)(1),(0,v.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.isModalVisible=!1}):this.tenantService.updateDefaultConnectionString(this.selected.id,this.connectionString).pipe((0,m.q)(1),(0,v.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.isModalVisible=!1}))}},{key:"saveTenant",value:function(){var e=this;this.tenantForm.valid&&!this.modalBusy&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Xe(Object.assign(Object.assign(Object.assign({},this.selected),this.tenantForm.value),{id:this.selected.id})):new We(this.tenantForm.value)).pipe((0,v.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.list.get(),e.isModalVisible=!1}))}},{key:"delete",value:function(e,t){var n=this;this.confirmationService.warn("Saas::TenantDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[t]}).subscribe(function(t){t===l.Tv.Status.confirm&&n.store.dispatch(new et(e)).subscribe(function(){return n.list.get()})})}},{key:"onSharedDatabaseChange",value:function(e){e||setTimeout(function(){var e=document.getElementById("defaultConnectionString");e&&e.focus()},0)}},{key:"openFeaturesModal",value:function(e){var t=this;this.providerKey=e,setTimeout(function(){t.visibleFeatures=!0},0)}}]),e}()).\u0275fac=function(e){return new(e||Ge)(p.Y36(c.XNV),p.Y36(l.YP),p.Y36(ct),p.Y36(b.qu),p.Y36(f.yh),p.Y36(p.zs3))},Ge.\u0275cmp=p.Xpm({type:Ge,selectors:[["abp-tenants"]],viewQuery:function(e,t){var n;1&e&&(p.Gf(pe,5),p.Gf(fe,5)),2&e&&(p.iGM(n=p.CRH())&&(t.tenantModalTemplate=n.first),p.iGM(n=p.CRH())&&(t.connectionStringModalTemplate=n.first))},features:[p._Bn([c.XNV,{provide:d.ex,useValue:"Saas.TenantsComponent"}])],decls:14,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["validateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"custom-checkbox","custom-control","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"custom-control-input",3,"ngModelChange"],["for","useSharedDatabase",1,"custom-control-label"],["class","form-group",4,"ngIf"],["for","defaultConnectionString"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(e,t){1&e&&(p.YNc(0,ge,24,13,"ng-container",0),p.ALo(1,"async"),p.TgZ(2,"abp-modal",1),p.NdJ("visibleChange",function(e){return t.isModalVisible=e})("disappear",function(){return t.tenantForm=null,t.defaultConnectionStringForm=null}),p.YNc(3,ve,3,3,"ng-template",null,2,p.W1O),p.YNc(5,me,1,1,"ng-template",null,3,p.W1O),p.YNc(7,ye,7,7,"ng-template",null,4,p.W1O),p.qZA(),p.YNc(9,be,1,1,"ng-template",null,5,p.W1O),p.YNc(11,Ce,9,5,"ng-template",null,6,p.W1O),p.YNc(13,Ze,1,2,"abp-feature-management",7)),2&e&&(p.Q6J("ngIf",p.lcZ(1,4,t.tenants$)),p.xp6(2),p.Q6J("visible",t.isModalVisible)("busy",t.modalBusy),p.xp6(11),p.Q6J("abpReplaceableTemplate",p.WLB(17,de,p.kEZ(11,ce,p.DdM(6,Ae),p.VKq(7,se,t.providerKey),p.VKq(9,ue,t.visibleFeatures)),p.VKq(15,le,t.onVisibleFeaturesChange))))},directives:[x.O5,l.zS,c.zLP,l.LI,d._V,b.Fj,b.JJ,b.On,d.m5,x.tP,l.r0,b._Y,b.JL,c.YzZ,X.hL,b.sg,d.gt,b.Wl,X.J5,b.u,c.Uqp,H],pipes:[x.Ov,c.fuE],encapsulation:2}),(0,r.gn)([(0,f.Ph)(lt.getTenants)],Ge.prototype,"tenants$",void 0),(0,r.gn)([(0,f.Ph)(lt.getTenantsTotalCount)],Ge.prototype,"totalCount$",void 0),(0,r.gn)([(0,f.Ph)(lt.getEditions)],Ge.prototype,"editions$",void 0),Ge),gt=((Re=function(){function e(t,n,i){var a=this;u(this,e),this.store=t,this.subscription=n,this.permissionService=i,this.initialized=new C.X(this),this.width=273,this.height=136,this.chartData={},this.draw=function(){a.permissionService.getGrantedPolicy("Saas.Editions")&&a.store.dispatch(new rt)},this.listenToData()}return s(e,[{key:"initialize",value:function(e){this.chart=e}},{key:"listenToData",value:function(){var e=this;this.subscription.addOne(this.data$,function(t){if(t&&"{}"!==JSON.stringify(t)){var n=Object.keys(t);setTimeout(function(){e.chartData={labels:n,datasets:[{data:n.map(function(e){return t[e]}),backgroundColor:(0,l.pc)(Object.keys(t).length)}]},e.chart.refresh()},0)}else e.chartData={}})}}]),e}()).\u0275fac=function(e){return new(e||Re)(p.Y36(f.yh),p.Y36(c.FFO),p.Y36(c.$AH))},Re.\u0275cmp=p.Xpm({type:Re,selectors:[["abp-editions-usage-widget"]],inputs:{width:"width",height:"height"},outputs:{initialized:"initialized"},features:[p._Bn([c.FFO])],decls:1,vars:1,consts:[["class","abp-widget-wrapper",4,"abpPermission"],[1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],["type","pie",1,"w-100",3,"data","width","height","initialized"],["chart",""]],template:function(e,t){1&e&&p.YNc(0,xe,10,6,"div",0),2&e&&p.Q6J("abpPermission","Saas.Editions")},directives:[c.l97,l.xH],pipes:[c.fuE],encapsulation:2}),(0,r.gn)([(0,f.Ph)(lt.getUsageStatistics)],Re.prototype,"data$",void 0),Re),vt=((De=function e(t,n){var i=this;u(this,e),this.store=t,this.permissionService=n,this.minHeight=136,this.trackByFn=function(e,t){return t.id},this.draw=function(){i.permissionService.getGrantedPolicy("Saas.Tenants")&&i.store.dispatch(new st)}}).\u0275fac=function(e){return new(e||De)(p.Y36(f.yh),p.Y36(c.$AH))},De.\u0275cmp=p.Xpm({type:De,selectors:[["abp-latest-tenants-widget"]],inputs:{minHeight:"minHeight"},decls:1,vars:1,consts:[["class","abp-widget-wrapper","data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",4,"abpPermission"],["data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"table","table-hover","table-sm"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(e,t){1&e&&p.YNc(0,ke,21,12,"div",0),2&e&&p.Q6J("abpPermission","Saas.Tenants")},directives:[c.l97,x.sg],pipes:[c.fuE,x.Ov],encapsulation:2}),(0,r.gn)([(0,f.Ph)(lt.getLatestTenants)],De.prototype,"datas$",void 0),De),ht=d.uk.createMany([{text:"Saas::Edit",action:function(e){e.getInjected(pt).onEditEdition(e.record.id)},permission:"Saas.Editions.Update"},{text:"Saas::Features",action:function(e){e.getInjected(pt).openFeaturesModal(e.record.id)},permission:"Saas.Editions.ManageFeatures"},{text:"Saas::ChangeHistory",action:function(e){e.getInjected(Z.kv)(e.record.id,"Volo.Saas.Edition")},permission:"Saas.Editions.ViewChangeHistory",visible:function(e){return Boolean(e.getInjected(Z.kv,null))}},{text:"Saas::Delete",action:function(e){e.getInjected(pt).delete(e.record)},permission:"Saas.Editions.Delete"}]),mt=d.QC.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",sortable:!0}]),yt=d.Od.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",validators:function(){return[b.kI.required,b.kI.maxLength(256)]}}]),Tt=yt,bt=d.JE.createMany([{text:"Saas::NewEdition",action:function(e){e.getInjected(pt).onAddEdition()},permission:"Saas.Editions.Create",icon:"fa fa-plus"}]),St=d.uk.createMany([{text:"Saas::Edit",action:function(e){e.getInjected(ft).onEditTenant(e.record.id)},permission:"Saas.Tenants.Update"},{text:"Saas::ConnectionStrings",action:function(e){e.getInjected(ft).onEditConnectionString(e.record.id)},permission:"Saas.Tenants.ManageConnectionStrings"},{text:"Saas::Features",action:function(e){e.getInjected(ft).openFeaturesModal(e.record.id)},permission:"Saas.Tenants.ManageFeatures"},{text:"Saas::ChangeHistory",action:function(e){e.getInjected(Z.kv)(e.record.id,"Volo.Saas.Tenant")},permission:"Saas.Tenants.ViewChangeHistory",visible:function(e){return Boolean(e.getInjected(Z.kv,null))}},{text:"Saas::Delete",action:function(e){e.getInjected(ft).delete(e.record.id,e.record.name)},permission:"Saas.Tenants.Delete"}]),Ct=d.QC.createMany([{type:"string",name:"name",displayName:"Saas::TenantName",sortable:!0,columnWidth:370},{type:"string",name:"editionName",displayName:"Saas::EditionName",columnWidth:370}]),Zt=d.Od.createMany([{type:"string",name:"name",id:"name",displayName:"Saas::TenantName",validators:function(){return[b.kI.required,b.kI.maxLength(256)]}},{type:"string",name:"editionId",displayName:"Saas::Edition",id:"edition",options:function(e){return e.getInjected(ft).editions$.pipe((0,y.U)(function(e){return[{key:"",value:""}].concat(i(e.map(function(e){return{key:e.displayName,value:e.id}})))}))}},{type:"email",name:"adminEmailAddress",displayName:"Saas::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:function(){return[b.kI.required,b.kI.maxLength(256),b.kI.email]}},{type:"password",name:"adminPassword",displayName:"Saas::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:function(e){return[b.kI.required].concat(i((0,l.dD)({get:e.getInjected})))}}]),At=Zt.slice(0,2),xt=d.JE.createMany([{text:"Saas::ManageHostFeatures",action:function(e){e.getInjected(ft).openFeaturesModal(null)},permission:"Saas.Tenants.ManageFeatures",icon:"fa fa-cog"},{text:"Saas::NewTenant",action:function(e){e.getInjected(ft).onAddTenant()},permission:"Saas.Tenants.Create",icon:"fa fa-plus"}]),Nt={"Saas.EditionsComponent":ht,"Saas.TenantsComponent":St},kt={"Saas.EditionsComponent":bt,"Saas.TenantsComponent":xt},Ft={"Saas.EditionsComponent":mt,"Saas.TenantsComponent":Ct},wt={"Saas.EditionsComponent":yt,"Saas.TenantsComponent":Zt},Et={"Saas.EditionsComponent":Tt,"Saas.TenantsComponent":At},qt=new p.OlP("SAAS_ENTITY_ACTION_CONTRIBUTORS"),Ot=new p.OlP("SAAS_TOOLBAR_ACTION_CONTRIBUTORS"),Mt=new p.OlP("SAAS_ENTITY_PROP_CONTRIBUTORS"),_t=new p.OlP("SAAS_CREATE_FORM_PROP_CONTRIBUTORS"),Lt=new p.OlP("SAAS_EDIT_FORM_PROP_CONTRIBUTORS"),It=((je=function(){function e(t){u(this,e),this.injector=t}return s(e,[{key:"canActivate",value:function(){var e=this.injector.get(d.X6),t=this.injector.get(qt,null)||{},n=this.injector.get(Ot,null)||{},i=this.injector.get(Mt,null)||{},a=this.injector.get(_t,null)||{},o=this.injector.get(Lt,null)||{},r=this.injector.get(c.XJE);return(0,d.ot)(r,"Saas").pipe((0,y.U)(function(e){return{"Saas.EditionsComponent":e.Edition,"Saas.TenantsComponent":e.Tenant}}),(0,d.V_)(r,"Saas"),(0,g.b)(function(r){(0,d.Fr)(e.entityActions,Nt,t),(0,d.Fr)(e.toolbarActions,kt,n),(0,d.Hp)(e.entityProps,Ft,r.prop,i),(0,d.Hp)(e.createFormProps,wt,r.createForm,a),(0,d.Hp)(e.editFormProps,Et,r.editForm,o)}),(0,T.h)(!0))}}]),e}()).\u0275fac=function(e){return new(e||je)(p.LFG(p.zs3))},je.\u0275prov=p.Yz7({token:je,factory:je.\u0275fac}),je),Ut=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:c.w6s,canActivate:[c.a1M,c.nG9,It],children:[{path:"tenants",component:c.c$y,data:{requiredPolicy:"Saas.Tenants",replaceableComponent:{key:"Saas.TenantsComponent",defaultComponent:ft}}},{path:"editions",component:c.c$y,data:{requiredPolicy:"Saas.Editions",replaceableComponent:{key:"Saas.EditionsComponent",defaultComponent:pt}}}]}],Jt=function(){var e=function e(){u(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[ee.Bz.forChild(Ut)],ee.Bz]}),e}(),Bt=((He=function(){function e(){u(this,e)}return s(e,null,[{key:"forChild",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[{provide:qt,useValue:t.entityActionContributors},{provide:Ot,useValue:t.toolbarActionContributors},{provide:Mt,useValue:t.entityPropContributors},{provide:_t,useValue:t.createFormPropContributors},{provide:Lt,useValue:t.editFormPropContributors},It]}}},{key:"forLazy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new c.Cgl(e.forChild(t))}}]),e}()).\u0275fac=function(e){return new(e||He)},He.\u0275mod=p.oAB({type:He}),He.\u0275inj=p.cJS({imports:[[Jt,f.$l.forFeature([lt]),X.h2,c.IR2,Z.vv,l.e2,A.XC,W]]}),He),Yt=((ze=function(){function t(e){u(this,t),this.store=e}return s(t,[{key:"getTenants",value:function(){return this.store.selectSnapshot(lt.getTenants)}},{key:"getLatestTenants",value:function(){return this.store.selectSnapshot(lt.getLatestTenants)}},{key:"getTenantsTotalCount",value:function(){return this.store.selectSnapshot(lt.getTenantsTotalCount)}},{key:"getEditions",value:function(){return this.store.selectSnapshot(lt.getEditions)}},{key:"getEditionsTotalCount",value:function(){return this.store.selectSnapshot(lt.getEditionsTotalCount)}},{key:"getUsageStatistics",value:function(){return this.store.selectSnapshot(lt.getUsageStatistics)}},{key:"dispatchGetTenants",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e($e,n))}},{key:"dispatchGetTenantById",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(Ke,n))}},{key:"dispatchCreateTenant",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(We,n))}},{key:"dispatchUpdateTenant",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(Xe,n))}},{key:"dispatchDeleteTenant",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(et,n))}},{key:"dispatchGetEditions",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(tt,n))}},{key:"dispatchGetEditionById",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(nt,n))}},{key:"dispatchCreateEdition",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(it,n))}},{key:"dispatchUpdateEdition",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(at,n))}},{key:"dispatchDeleteEdition",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.store.dispatch(e(ot,n))}},{key:"dispatchGetUsageStatistics",value:function(){return this.store.dispatch(new rt)}},{key:"dispatchGetLatestTenants",value:function(){return this.store.dispatch(new st)}}]),t}()).\u0275fac=function(e){return new(e||ze)(p.LFG(f.yh))},ze.\u0275prov=(0,p.Yz7)({factory:function(){return new ze((0,p.LFG)(f.yh))},token:ze,providedIn:"root"}),ze)}}])}();