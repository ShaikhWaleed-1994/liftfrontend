(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[56484,55e3],{56484:function(t,i,e){"use strict";e.r(i),e.d(i,{NotificationModule:function(){return Y}});var o=e(46700),n=e(55679),a=e(10135),s=e(99046),l=e(83845),c=e(73756),r=e(56410),u=e(2996),p=e(47701),d=e(11520),f=e(44019),h=e(43835),g=e(44689),m=e(35366),b=e(37527),Z=e(31041),v=e(92338),A=e(23733),x=e(17647),w=e(61116),T=e(55e3),q=e(40739),L=e(3183);function N(t,i){if(1&t){const t=m.EpF();m.TgZ(0,"button",19),m.NdJ("click",function(){return m.CHM(t),m.oxw().create()}),m._UZ(1,"i",20),m._uU(2),m.ALo(3,"abpLocalization"),m.qZA()}2&t&&(m.xp6(2),m.hij(" ",m.lcZ(3,1,"::NewNotification")," "))}function y(t,i){if(1&t&&m._UZ(0,"is-empty",23),2&t){const t=m.oxw().row;m.Q6J("value",t.notificationTextAr)}}function U(t,i){if(1&t&&m._UZ(0,"is-empty",23),2&t){const t=m.oxw().row;m.Q6J("value",t.notificationTextEn)}}function C(t,i){if(1&t&&(m.TgZ(0,"div",21),m.YNc(1,y,1,1,"is-empty",22),m.YNc(2,U,1,1,"is-empty",22),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.Q6J("ngIf",t.isArabic),m.xp6(1),m.Q6J("ngIf",!t.isArabic)}}function F(t,i){if(1&t&&(m.TgZ(0,"h3"),m._uU(1),m.ALo(2,"abpLocalization"),m.qZA()),2&t){const t=m.oxw();m.xp6(1),m.hij(" ",m.lcZ(2,1,t.selected?"AbpUi::Edit":"::NewNotification")," ")}}function _(t,i){if(1&t){const t=m.EpF();m.TgZ(0,"form",24),m.NdJ("ngSubmit",function(){return m.CHM(t),m.oxw().submitForm()}),m.TgZ(1,"div",25),m.TgZ(2,"div",26),m.TgZ(3,"label",27),m._uU(4),m.ALo(5,"abpLocalization"),m.qZA(),m._UZ(6,"input",28),m.qZA(),m.TgZ(7,"div",26),m.TgZ(8,"label",29),m._uU(9),m.ALo(10,"abpLocalization"),m.qZA(),m._UZ(11,"input",30),m.qZA(),m.TgZ(12,"div",26),m.TgZ(13,"label",31),m._uU(14),m.ALo(15,"abpLocalization"),m.qZA(),m._UZ(16,"input",32),m.qZA(),m.TgZ(17,"div",26),m.TgZ(18,"label",33),m._uU(19),m.ALo(20,"abpLocalization"),m.qZA(),m._UZ(21,"input",34),m.qZA(),m.TgZ(22,"div",26),m.TgZ(23,"label",35),m._uU(24),m.ALo(25,"abpLocalization"),m.qZA(),m._UZ(26,"sw-date-picker",36),m.qZA(),m.TgZ(27,"div",37),m._UZ(28,"input",38),m.TgZ(29,"label",39),m._uU(30),m.ALo(31,"abpLocalization"),m.qZA(),m.qZA(),m.TgZ(32,"div",26),m.TgZ(33,"label",40),m._uU(34),m.ALo(35,"abpLocalization"),m.qZA(),m._UZ(36,"sw-lookup-select",41),m.qZA(),m.TgZ(37,"div",26),m.TgZ(38,"label",42),m._uU(39),m.ALo(40,"abpLocalization"),m.qZA(),m._UZ(41,"sw-lookup-select",43),m.qZA(),m.qZA(),m.qZA()}if(2&t){const t=m.oxw();m.Q6J("formGroup",t.form),m.xp6(4),m.hij(" ",m.lcZ(5,11,"::NotificationTextAr")," "),m.xp6(5),m.hij(" ",m.lcZ(10,13,"::NotificationTextEn")," "),m.xp6(5),m.hij(" ",m.lcZ(15,15,"::WebRoute")," "),m.xp6(5),m.hij(" ",m.lcZ(20,17,"::MobileRoute")," "),m.xp6(5),m.hij(" ",m.lcZ(25,19,"::SentDate")," "),m.xp6(6),m.hij(" ",m.lcZ(31,21,"::HadSeen")," "),m.xp6(4),m.hij(" ",m.lcZ(35,23,"::AppUser")," "),m.xp6(2),m.Q6J("getFn",t.service.getAppUserLookup),m.xp6(3),m.hij(" ",m.lcZ(40,25,"::AppUser")," "),m.xp6(2),m.Q6J("getFn",t.service.getAppUserLookup)}}function J(t,i){if(1&t){const t=m.EpF();m.TgZ(0,"button",44,45),m._uU(2),m.ALo(3,"abpLocalization"),m.qZA(),m.TgZ(4,"abp-button",46),m.NdJ("click",function(){return m.CHM(t),m.oxw().submitForm()}),m._uU(5),m.ALo(6,"abpLocalization"),m.qZA()}if(2&t){const t=m.oxw();m.xp6(2),m.hij(" ",m.lcZ(3,3,"AbpUi::Cancel")," "),m.xp6(2),m.Q6J("disabled",null==t.form?null:t.form.invalid),m.xp6(1),m.hij(" ",m.lcZ(6,5,"AbpUi::Save")," ")}}const S=[{path:"",component:(()=>{class t{constructor(t,i,e,o,n,a,s,l,c){this.list=t,this.track=i,this.service=e,this.confirmation=o,this.dateService=n,this.fb=a,this.el=s,this.notificationIconService=l,this.sessionState=c,this.data={items:[],totalCount:0},this.isFiltersHidden=!0,this.isModalBusy=!1,this.isModalOpen=!1,this.headerHeight=0,this.rowHeight=75,this.pageLimit=10,this.isArabic=!0,this.lastOffsetY=0,this.lastDate=""}get showFilter(){return this._showFilter}set showFilter(t){this._showFilter=t,this.isFiltersHidden=!t}ngOnInit(){let t=this.sessionState.getLanguage();this.isArabic="ar"===t,this.onScroll(0)}onScroll(t){if(t){let i=this.lastOffsetY;if(this.lastOffsetY=t,t-i<10)return}const i=this.el.nativeElement.getBoundingClientRect().height-this.headerHeight;if(!this.isLoading&&t+i>=this.data.items.length*this.rowHeight){let t=this.pageLimit;if(0===this.data.items.length){const e=Math.ceil(i/this.rowHeight);t=Math.max(e,this.pageLimit)}this.loadPage(t)}}loadPage(t){this.isLoading=!0;let i={};i.maxResultCount=t,i.markAllAsSeen=!0,this.lastDate&&(i.beforeDate=this.lastDate),this.service.getNotificationList(i).pipe((0,p.b)(1e3)).subscribe(t=>{const e=[...this.data.items,...t.items];e.length>0&&(this.lastDate=e[e.length-1].sentDate),this.data.items=e,this.data.totalCount=t.totalCount,this.isLoading=!1,this.sessionState.getLanguage(),i.hadSeen=!1,i.markAllAsSeen=!1,this.notificationIconService.loadOldNotifications()})}clearFilters(){this.list.get()}buildForm(){var t;const{notificationTextAr:i,notificationTextEn:e,webRoute:o,sentDate:n,hadSeen:a}=(null===(t=this.selected)||void 0===t?void 0:t.notification)||{};this.form=this.fb.group({notificationTextAr:[null!=i?i:null,[]],notificationTextEn:[null!=e?e:null,[]],webRoute:[null!=o?o:null,[]],sentDate:[n?new Date(n):null,[]],hadSeen:[null!=a?a:null,[]]})}hideForm(){this.isModalOpen=!1,this.form.reset()}showForm(){this.buildForm(),this.isModalOpen=!0}submitForm(){if(this.form.invalid)return;const t=this.selected?this.service.update(this.selected.notification.id,this.form.value):this.service.create(this.form.value);this.isModalBusy=!0,t.pipe((0,d.x)(()=>this.isModalBusy=!1),(0,f.b)(()=>this.hideForm())).subscribe(this.list.get)}create(){this.selected=void 0,this.showForm()}update(t){this.selected=t,this.showForm()}delete(t){this.confirmation.warn("::DeleteConfirmationMessage","::AreYouSure",{messageLocalizationParams:[]}).pipe((0,h.h)(t=>t===n.Tv.Status.confirm),(0,g.w)(()=>this.service.delete(t.notification.id))).subscribe(this.list.get)}}return t.\u0275fac=function(i){return new(i||t)(m.Y36(o.XNV),m.Y36(o.vR3),m.Y36(b.g),m.Y36(n.YP),m.Y36(u.R),m.Y36(Z.qu),m.Y36(m.SBq),m.Y36(v.O),m.Y36(o.WxB))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-notification"]],features:[m._Bn([o.XNV,u.R])],decls:29,vars:22,consts:[[1,"app-notifications"],[1,"row","entry-row","align-items-center"],[1,"col-12","col-sm-auto","content-header-container"],[1,"content-header-title","custom-green"],[1,"col-lg-auto","pl-lg-0"],["hidden","",1,"col-lg"],[1,"text-lg-right","pt-2"],[1,"custom-control","custom-switch"],["type","checkbox","id","customSwitch1",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","customSwitch1",1,"custom-control-label"],["hidden","",1,"col-auto"],["class","btn btn-primary btn-sm","type","button",3,"click",4,"abpPermission"],["default","",1,"app-dataview",3,"rows","count","list","headerHeight","columnMode","footerHeight","loadingIndicator","scrollbarV","scroll"],["prop","notification.notificationTextAr",3,"name","cellClass"],["ngx-datatable-cell-template",""],["size","lg",3,"busy","visible","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-plus","mr-1"],[1,"text-wrap","break-all"],[3,"value",4,"ngIf"],[3,"value"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2","fade-in-top","row"],[1,"form-group","col-md-4"],["for","notification-notification-text-ar"],["id","notification-notification-text-ar","formControlName","notificationTextAr","autofocus","",1,"form-control"],["for","notification-notification-text-en"],["id","notification-notification-text-en","formControlName","notificationTextEn",1,"form-control"],["for","notification-web-route"],["id","notification-web-route","formControlName","webRoute",1,"form-control"],["for","notification-mobile-route"],["id","notification-mobile-route","formControlName","mobileRoute",1,"form-control"],["for","notification-sent-date"],["id","notification-sent-date","name","notification-sent-date","formControlName","sentDate"],[1,"form-group","form-check","custom-checkbox","custom-control"],["type","checkbox","id","notification-had-seen","formControlName","hadSeen",1,"form-check-input","custom-control-input"],["for","notification-had-seen",1,"custom-control-label"],["for","app-user-sender-app-user-id"],["formControlName","senderAppUserId",3,"getFn"],["for","app-user-receiver-app-user-id"],["formControlName","receiverAppUserId",3,"getFn"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"]],template:function(t,i){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h1",3),m._uU(4),m.ALo(5,"abpLocalization"),m.qZA(),m._UZ(6,"abp-breadcrumb"),m.qZA(),m._UZ(7,"div",4),m.TgZ(8,"div",5),m.TgZ(9,"div",6),m.TgZ(10,"div",7),m.TgZ(11,"input",8),m.NdJ("ngModelChange",function(t){return i.showFilter=t}),m.qZA(),m.TgZ(12,"label",9),m._uU(13),m.ALo(14,"abpLocalization"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(15,"div",10),m.TgZ(16,"div",6),m.YNc(17,N,4,3,"button",11),m.qZA(),m.qZA(),m.qZA(),m.TgZ(18,"ngx-datatable",12),m.NdJ("scroll",function(t){return i.onScroll(t.offsetY)}),m.TgZ(19,"ngx-datatable-column",13),m.ALo(20,"abpLocalization"),m.YNc(21,C,3,2,"ng-template",14),m.qZA(),m.qZA(),m.qZA(),m.TgZ(22,"abp-modal",15),m.NdJ("visibleChange",function(t){return i.isModalOpen=t}),m.YNc(23,F,3,3,"ng-template",null,16,m.W1O),m.YNc(25,_,42,27,"ng-template",null,17,m.W1O),m.YNc(27,J,7,7,"ng-template",null,18,m.W1O),m.qZA()),2&t&&(m.xp6(4),m.Oqu(m.lcZ(5,16,"::Notifications")),m.xp6(7),m.Q6J("ngModel",i.showFilter),m.xp6(2),m.Oqu(m.lcZ(14,18,"::SeeAdvancedFilters")),m.xp6(4),m.Q6J("abpPermission","Physic.Notifications.Create"),m.xp6(1),m.Q6J("rows",i.data.items)("count",i.data.totalCount)("list",i.list)("headerHeight",i.headerHeight)("columnMode","force")("footerHeight",0)("loadingIndicator",i.isLoading)("scrollbarV",!0),m.xp6(1),m.s9C("name",m.lcZ(20,20,"::NotificationTextAr")),m.Q6J("cellClass","notification-cell"),m.xp6(3),m.Q6J("busy",i.isModalBusy)("visible",i.isModalOpen))},directives:[n.LI,Z.Wl,Z.JJ,Z.On,A.m,o.l97,x.nE,n.x7,n.j3,x.UC,x.vq,n.zS,w.O5,T.K,Z._Y,Z.JL,o.YzZ,Z.sg,s.hL,Z.Fj,Z.u,s.J5,o.Uqp,q.L,L.X,n.r0],pipes:[o.fuE],styles:[".app-notifications .datatable-body-row .datatable-row-group{align-items:center}"]}),t})(),canActivate:[o.a1M,o.nG9]}];let k=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[r.Bz.forChild(S)],r.Bz]}),t})();var z=e(56137);let Y=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[k,o.IR2,n.e2,c.Ck,l.vv,s.h2,a.lQ,a.M,z.m,a.XC]]}),t})()},55e3:function(t,i,e){"use strict";e.d(i,{K:function(){return u}});var o=e(46700),n=e(2996),a=e(35366),s=e(61116);function l(t,i){if(1&t&&(a.TgZ(0,"span",2),a.TgZ(1,"span"),a._uU(2),a.qZA(),a.Hsn(3),a.qZA()),2&t){const t=a.oxw();a.xp6(2),a.Oqu(t.parsedDate)}}function c(t,i){if(1&t&&(a.TgZ(0,"span",3),a._uU(1),a.qZA()),2&t){const t=a.oxw();a.xp6(1),a.hij(" ",t.l("NotFound"),"\n")}}const r=["*"];let u=(()=>{class t{constructor(t,i){this.dateService=i,this.localization=t.get(o.oQ8)}get value(){return this._value}set value(t){this._value=t,this.parsedDate=this.value instanceof Date?this.dateService.parseDate(t):t}l(t){return this.localization.instant("::"+t)}isNotEmpty(){return!!this.value&&("string"!=typeof this.value||this.value.length>0)}}return t.\u0275fac=function(i){return new(i||t)(a.Y36(a.zs3),a.Y36(n.R))},t.\u0275cmp=a.Xpm({type:t,selectors:[["is-empty"]],inputs:{value:"value"},features:[a._Bn([n.R])],ngContentSelectors:r,decls:2,vars:2,consts:[["class","sw-dv-details",4,"ngIf"],["class","sw-dv-details empty-value custom-gray","style","font-size: 12px;font-style: italic;",4,"ngIf"],[1,"sw-dv-details"],[1,"sw-dv-details","empty-value","custom-gray",2,"font-size","12px","font-style","italic"]],template:function(t,i){1&t&&(a.F$t(),a.YNc(0,l,4,1,"span",0),a.YNc(1,c,2,1,"span",1)),2&t&&(a.Q6J("ngIf",i.isNotEmpty()),a.xp6(1),a.Q6J("ngIf",!i.isNotEmpty()))},directives:[s.O5],encapsulation:2}),t})()},3183:function(t,i,e){"use strict";e.d(i,{X:function(){return r}});var o=e(46700),n=e(35366),a=e(31041),s=e(23733),l=e(61116);function c(t,i){if(1&t&&(n.TgZ(0,"option",1),n._uU(1),n.qZA()),2&t){const t=i.$implicit,e=n.oxw();n.Q6J("ngValue",t.id),n.xp6(1),n.Oqu(t[e.lookupNameProp])}}let r=(()=>{class t extends o.ksn{constructor(){super(...arguments),this.lookupNameProp="displayName",this.disabled=!1,this.isLocalizable=!1,this.datas=[],this.pageQuery={maxResultCount:1e3,skipCount:0}}ngOnInit(){this.get()}get(){this.getFn&&this.getFn(this.pageQuery).subscribe(({items:t})=>{this.datas=t})}onFocus(t){}}return t.\u0275fac=function(){let i;return function(e){return(i||(i=n.n5z(t)))(e||t)}}(),t.\u0275cmp=n.Xpm({type:t,selectors:[["sw-lookup-select"]],inputs:{getFn:"getFn",lookupNameProp:"lookupNameProp",disabled:"disabled",isLocalizable:"isLocalizable",datas:"datas"},features:[n._Bn([{provide:a.JU,useExisting:(0,n.Gpc)(()=>t),multi:!0}]),n.qOj],decls:3,vars:3,consts:[[1,"custom-select","form-control",3,"disabled","ngModel","ngModelChange","focus"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(n.TgZ(0,"select",0),n.NdJ("ngModelChange",function(t){return i.value=t})("focus",function(t){return i.onFocus(t)}),n._UZ(1,"option",1),n.YNc(2,c,2,2,"option",2),n.qZA()),2&t&&(n.Q6J("disabled",i.disabled)("ngModel",i.value),n.xp6(2),n.Q6J("ngForOf",i.datas))},directives:[a.EJ,s.m,a.JJ,a.On,a.YN,a.Kr,l.sg],encapsulation:2}),t})()}}]);