(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[13250],{13250:function(t,e,n){"use strict";n.r(e),n.d(e,{CreateEdition:function(){return Ot},CreateTenant:function(){return Nt},DEFAULT_SAAS_CREATE_FORM_PROPS:function(){return ie},DEFAULT_SAAS_EDIT_FORM_PROPS:function(){return ae},DEFAULT_SAAS_ENTITY_ACTIONS:function(){return te},DEFAULT_SAAS_ENTITY_PROPS:function(){return ne},DEFAULT_SAAS_TOOLBAR_ACTIONS:function(){return ee},DeleteEdition:function(){return _t},DeleteTenant:function(){return wt},EditionService:function(){return Ut},EditionsComponent:function(){return Yt},EditionsUsageWidgetComponent:function(){return Dt},GetEditionById:function(){return qt},GetEditions:function(){return Et},GetLatestTenants:function(){return kt},GetTenantById:function(){return xt},GetTenants:function(){return At},GetUsageStatistics:function(){return Lt},LatestTenantsWidgetComponent:function(){return Pt},SAAS_CREATE_FORM_PROP_CONTRIBUTORS:function(){return ce},SAAS_EDIT_FORM_PROP_CONTRIBUTORS:function(){return ue},SAAS_ENTITY_ACTION_CONTRIBUTORS:function(){return se},SAAS_ENTITY_PROP_CONTRIBUTORS:function(){return re},SAAS_TOOLBAR_ACTION_CONTRIBUTORS:function(){return oe},SaasExtensionsGuard:function(){return le},SaasModule:function(){return ge},SaasState:function(){return Jt},SaasStateService:function(){return he},TenantService:function(){return It},TenantsComponent:function(){return Qt},UpdateEdition:function(){return Mt},UpdateTenant:function(){return Ft},"\u02750":function(){return Bt},"\u0275a":function(){return Qt},"\u0275ba":function(){return re},"\u0275bb":function(){return ce},"\u0275bc":function(){return ue},"\u0275c":function(){return Jt},"\u0275d":function(){return It},"\u0275e":function(){return Ut},"\u0275f":function(){return At},"\u0275g":function(){return Nt},"\u0275h":function(){return Ft},"\u0275i":function(){return wt},"\u0275j":function(){return Et},"\u0275k":function(){return Ot},"\u0275l":function(){return Mt},"\u0275m":function(){return _t},"\u0275n":function(){return Lt},"\u0275o":function(){return kt},"\u0275t":function(){return Yt},"\u0275u":function(){return Dt},"\u0275v":function(){return Pt},"\u0275w":function(){return pe},"\u0275x":function(){return le},"\u0275y":function(){return se},"\u0275z":function(){return oe}});var i=n(64762),a=n(46700),s=n(55679),o=n(97116),r=n(35366),c=n(48400),u=n(44019),l=n(11520),d=n(44689),p=n(90611),g=n(79996),h=n(88414),m=n(31041),f=n(40878),T=n(78512),v=n(83845),b=n(10135),S=n(61116);function y(t,e){1&t&&(r.TgZ(0,"h3"),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()),2&t&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"AbpFeatureManagement::Features")))}function Z(t,e){1&t&&r.GkF(0)}const C=function(t){return{$implicit:t}};function A(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"div",22),r.TgZ(2,"input",23),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw().$implicit.value=e})("ngModelChange",function(e){r.CHM(t);const n=r.oxw().$implicit;return r.oxw(5).onCheckboxClick(e,n)}),r.qZA(),r.TgZ(3,"label",24),r._uU(4),r.qZA(),r.YNc(5,Z,1,0,"ng-container",25),r.qZA(),r.BQk()}if(2&t){const t=r.oxw().$implicit;r.oxw(3);const e=r.MAs(6);r.xp6(2),r.Q6J("id",t.name)("ngModel",t.value),r.xp6(1),r.Q6J("htmlFor",t.name),r.xp6(1),r.Oqu(t.displayName),r.xp6(1),r.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",r.VKq(6,C,t.description))}}function x(t,e){1&t&&r.GkF(0)}function N(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"div",26),r.TgZ(2,"label",27),r._uU(3),r.qZA(),r.TgZ(4,"input",28),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw().$implicit.value=e}),r.qZA(),r.YNc(5,x,1,0,"ng-container",25),r.qZA(),r.BQk()}if(2&t){const t=r.oxw().$implicit;r.oxw(3);const e=r.MAs(6);r.xp6(2),r.Q6J("htmlFor",t.name),r.xp6(1),r.Oqu(t.displayName),r.xp6(1),r.Q6J("id",t.name)("ngModel",t.value)("abpFeatureManagementFreeText",t),r.xp6(1),r.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",r.VKq(7,C,t.description))}}function F(t,e){if(1&t&&(r.TgZ(0,"option",32),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()),2&t){const t=e.$implicit;r.Q6J("ngValue",t.value),r.xp6(1),r.hij(" ",r.lcZ(2,2,(null==t.displayText?null:t.displayText.resourceName)+"::"+(null==t.displayText?null:t.displayText.name)),"")}}function w(t,e){1&t&&r.GkF(0)}function E(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"div",26),r.TgZ(2,"label",27),r._uU(3),r.qZA(),r.TgZ(4,"select",30),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw(2).$implicit.value=e}),r.YNc(5,F,3,4,"option",31),r.qZA(),r.YNc(6,w,1,0,"ng-container",25),r.qZA(),r.BQk()}if(2&t){const t=r.oxw(2).$implicit;r.oxw(3);const e=r.MAs(6),n=r.oxw(2);r.xp6(2),r.Q6J("htmlFor",t.name),r.xp6(1),r.Oqu(t.displayName),r.xp6(1),r.Q6J("id",t.name)("ngModel",t.value),r.xp6(1),r.Q6J("ngForOf",null==t.valueType.itemSource?null:t.valueType.itemSource.items)("ngForTrackBy",n.track.by("value")),r.xp6(1),r.Q6J("ngTemplateOutlet",e)("ngTemplateOutletContext",r.VKq(8,C,t.description))}}function q(t,e){if(1&t&&(r.ynx(0),r.YNc(1,E,7,10,"ng-container",29),r.BQk()),2&t){const t=r.oxw().$implicit;r.xp6(1),r.Q6J("ngIf",null==t.valueType.itemSource||null==t.valueType.itemSource.items?null:t.valueType.itemSource.items.length)}}function O(t,e){if(1&t&&(r.ynx(0),r._uU(1),r.BQk()),2&t){const t=r.oxw().$implicit;r.xp6(1),r.Oqu(t.displayName)}}function M(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",19),r.NdJ("keyup.enter",function(){return r.CHM(t),r.oxw(5).save()}),r.YNc(1,A,6,8,"ng-container",20),r.YNc(2,N,6,9,"ng-container",20),r.YNc(3,q,2,1,"ng-container",20),r.YNc(4,O,2,1,"ng-container",21),r.qZA()}if(2&t){const t=e.$implicit,n=r.oxw(5);r.Q6J("ngStyle",t.style)("ngSwitch",null==t.valueType?null:t.valueType.name),r.xp6(1),r.Q6J("ngSwitchCase",n.valueTypes.ToggleStringValueType),r.xp6(1),r.Q6J("ngSwitchCase",n.valueTypes.FreeTextStringValueType),r.xp6(1),r.Q6J("ngSwitchCase",n.valueTypes.SelectionStringValueType)}}function _(t,e){if(1&t&&(r.TgZ(0,"h4"),r._uU(1),r.qZA(),r._UZ(2,"hr",17),r.YNc(3,M,5,5,"div",18)),2&t){const t=r.oxw().$implicit,e=r.oxw(3);r.xp6(1),r.Oqu(e.selectedGroupDisplayName),r.xp6(2),r.Q6J("ngForOf",e.features[t.name])("ngForTrackBy",e.track.by("id"))}}function L(t,e){if(1&t&&(r.TgZ(0,"li",14),r.TgZ(1,"a",15),r._uU(2),r.qZA(),r.YNc(3,_,4,3,"ng-template",16),r.qZA()),2&t){const t=e.$implicit;r.Q6J("ngbNavItem",t.displayName),r.xp6(2),r.Oqu(t.displayName)}}function k(t,e){if(1&t&&(r.TgZ(0,"small",34),r._uU(1),r.qZA()),2&t){const t=r.oxw().$implicit;r.xp6(1),r.Oqu(t)}}function U(t,e){1&t&&r.YNc(0,k,2,1,"small",33),2&t&&r.Q6J("ngIf",e.$implicit)}function I(t,e){1&t&&(r.TgZ(0,"div",35),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"AbpFeatureManagement::NoFeatureFoundMessage")," "))}function J(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",5),r.TgZ(1,"div",6),r.TgZ(2,"ul",7,8),r.NdJ("activeIdChange",function(e){return r.CHM(t),r.oxw(2).selectedGroupDisplayName=e}),r.YNc(4,L,4,2,"li",9),r.qZA(),r.qZA(),r.YNc(5,U,1,1,"ng-template",null,10,r.W1O),r.TgZ(7,"div",11),r._UZ(8,"div",12),r.qZA(),r.YNc(9,I,3,3,"div",13),r.qZA()}if(2&t){const t=r.MAs(3),e=r.oxw(2);r.xp6(2),r.Q6J("activeId",e.selectedGroupDisplayName),r.xp6(2),r.Q6J("ngForOf",e.groups)("ngForTrackBy",e.track.by("name")),r.xp6(4),r.Q6J("ngbNavOutlet",t),r.xp6(1),r.Q6J("ngIf",!e.groups.length)}}function B(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"abp-button",39),r.NdJ("click",function(){return r.CHM(t),r.oxw(3).save()}),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()}if(2&t){const t=r.oxw(3);r.Q6J("disabled",t.modalBusy),r.xp6(1),r.hij(" ",r.lcZ(2,2,"AbpFeatureManagement::Save")," ")}}function Y(t,e){if(1&t&&(r.TgZ(0,"button",36,37),r._uU(2),r.ALo(3,"abpLocalization"),r.qZA(),r.YNc(4,B,3,4,"abp-button",38)),2&t){const t=r.oxw(2);r.xp6(2),r.hij(" ",r.lcZ(3,2,"AbpFeatureManagement::Cancel")," "),r.xp6(2),r.Q6J("ngIf",t.groups.length)}}function Q(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"abp-modal",1),r.NdJ("visibleChange",function(e){return r.CHM(t),r.oxw().visible=e}),r.YNc(1,y,3,3,"ng-template",null,2,r.W1O),r.YNc(3,J,10,5,"ng-template",null,3,r.W1O),r.YNc(5,Y,5,4,"ng-template",null,4,r.W1O),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("visible",t.visible)("busy",t.modalBusy)}}let D=(()=>{class t{constructor(t){this.restService=t,this.apiName="AbpFeatureManagement",this.get=(t,e)=>this.restService.request({method:"GET",url:"/api/feature-management/features",params:{providerName:t,providerKey:e}},{apiName:this.apiName}),this.update=(t,e,n)=>this.restService.request({method:"PUT",url:"/api/feature-management/features",params:{providerName:t,providerKey:e},body:n},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(a.vgb))},t.\u0275prov=(0,r.Yz7)({factory:function(){return new t((0,r.LFG)(a.vgb))},token:t,providedIn:"root"}),t})();var P=function(t){return t.ToggleStringValueType="ToggleStringValueType",t.FreeTextStringValueType="FreeTextStringValueType",t.SelectionStringValueType="SelectionStringValueType",t}({});let G=(()=>{class t{constructor(t,e,n,i,a){this.track=t,this.service=e,this.store=n,this.configState=i,this.appConfigService=a,this.groups=[],this.valueTypes=P,this.visibleChange=new r.vpe,this.modalBusy=!1}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this.visibleChange.emit(t),t&&this.openModal())}openModal(){if(!this.providerName)throw new Error("providerName is required.");this.getFeatures()}getFeatures(){this.service.get(this.providerName,this.providerKey).subscribe(t=>{this.groups=t.groups.map(({name:t,displayName:e})=>({name:t,displayName:e})),this.selectedGroupDisplayName=this.groups[0].displayName,this.features=t.groups.reduce((t,e)=>Object.assign(Object.assign({},t),{[e.name]:V(e.features,document.body.dir)}),{})})}save(){if(this.modalBusy)return;const t=[];Object.keys(this.features).forEach(e=>{this.features[e].forEach(e=>{e.value!==e.initialValue&&t.push({name:e.name,value:`${e.value}`})})}),t.length?(this.modalBusy=!0,this.service.update(this.providerName,this.providerKey,{features:t}).pipe((0,l.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.visible=!1,this.providerKey||this.appConfigService.get().pipe((0,u.b)(t=>this.configState.setState(t))).subscribe()})):this.visible=!1}onCheckboxClick(t,e){t?this.checkToggleAncestors(e):this.uncheckToggleDescendants(e)}uncheckToggleDescendants(t){this.findAllDescendantsOfByType(t,P.ToggleStringValueType).forEach(t=>this.setFeatureValue(t,!1))}checkToggleAncestors(t){this.findAllAncestorsOfByType(t,P.ToggleStringValueType).forEach(t=>this.setFeatureValue(t,!0))}findAllAncestorsOfByType(t,e){let n=this.findParentByType(t,e);const i=[];for(;n;)i.push(n),n=this.findParentByType(n,e);return i}findAllDescendantsOfByType(t,e){const n=[],i=[t];for(;i.length;){const t=i.pop(),a=this.findChildrenByType(t,e);n.push(...a),i.push(...a)}return n}findParentByType(t,e){return this.getCurrentGroup().find(n=>n.valueType.name===e&&n.name===t.parentName)}findChildrenByType(t,e){return this.getCurrentGroup().filter(n=>n.valueType.name===e&&n.parentName===t.name)}getCurrentGroup(){var t;return null!==(t=this.features[this.selectedGroupDisplayName])&&void 0!==t?t:[]}setFeatureValue(t,e){t.value=e}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(a.vR3),r.Y36(D),r.Y36(c.yh),r.Y36(a.XJE),r.Y36(a.xa_))},t.\u0275cmp=r.Xpm({type:t,selectors:[["abp-feature-management"]],inputs:{visible:"visible",providerKey:"providerKey",providerName:"providerName"},outputs:{visibleChange:"visibleChange"},exportAs:["abpFeatureManagement"],decls:1,vars:1,consts:[["size","lg",3,"visible","busy","visibleChange",4,"ngIf"],["size","lg",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"row"],[1,"col-md-4"],["ngbNav","","orientation","vertical",1,"nav-pills",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem",4,"ngFor","ngForOf","ngForTrackBy"],["descTmp",""],[1,"col-md-8"],[3,"ngbNavOutlet"],["class","mx-3",4,"ngIf"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2","mb-3"],["class","mt-2",3,"ngStyle","ngSwitch","keyup.enter",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-2",3,"ngStyle","ngSwitch","keyup.enter"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"custom-checkbox","custom-control"],["type","checkbox",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"htmlFor"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"form-group"],[3,"htmlFor"],["type","text",1,"form-control",3,"id","ngModel","abpFeatureManagementFreeText","ngModelChange"],[4,"ngIf"],[1,"form-control","custom-select",3,"id","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngValue"],["class","form-text text-muted",4,"ngIf"],[1,"form-text","text-muted"],[1,"mx-3"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click",4,"ngIf"],["iconClass","fa fa-check",3,"disabled","click"]],template:function(t,e){1&t&&r.YNc(0,Q,7,2,"abp-modal",0),2&t&&r.Q6J("ngIf",e.visible)},directives:function(){return[S.O5,s.zS,b.Pz,S.sg,b.tO,b.nv,b.Vx,b.uN,S.PC,S.RF,S.n9,S.ED,m.Wl,m.JJ,m.On,S.tP,m.Fj,j,m.EJ,m.YN,m.Kr,s.r0]},pipes:function(){return[a.fuE]},encapsulation:2}),t})();function V(t,e){const n=`margin-${"rtl"===e?"right":"left"}.px`;return t.map(t=>{var e;const i=(null===(e=t.valueType)||void 0===e?void 0:e.name)===P.ToggleStringValueType?"true"===(t.value||"").toLowerCase():t.value;return Object.assign(Object.assign({},t),{value:i,initialValue:i,style:{[n]:20*t.depth}})})}const R={numeric:"number",default:"text"};let j=(()=>{class t{set feature(t){this._feature=t,this.setInputType()}get feature(){return this._feature}setInputType(){var t,e,n,i;const a=null===(n=null===(e=null===(t=this.feature)||void 0===t?void 0:t.valueType)||void 0===e?void 0:e.validator)||void 0===n?void 0:n.name.toLowerCase();this.type=null!==(i=R[a])&&void 0!==i?i:R.default}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=r.lG2({type:t,selectors:[["input","abpFeatureManagementFreeText",""]],hostVars:1,hostBindings:function(t,e){2&t&&r.Ikx("type",e.type)},inputs:{feature:["abpFeatureManagementFreeText","feature"]},exportAs:["inputAbpFeatureManagementFreeText"]}),t})(),z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[a.IR2,s.e2,b.Oz,c.$l.forFeature([])]]}),t})();var $=n(99046),H=n(56410);function K(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"div",6),r.TgZ(2,"div",7),r.TgZ(3,"h1",8),r._uU(4),r.ALo(5,"abpLocalization"),r.qZA(),r.qZA(),r.TgZ(6,"div",9),r._UZ(7,"abp-breadcrumb"),r.qZA(),r.TgZ(8,"div",10),r._UZ(9,"abp-page-toolbar",11),r.qZA(),r.qZA(),r.TgZ(10,"div",12),r.TgZ(11,"div",13),r.TgZ(12,"div",14),r.TgZ(13,"div",15),r.TgZ(14,"div",10),r.TgZ(15,"div",16),r.TgZ(16,"input",17),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw().list.filter=e}),r.ALo(17,"abpLocalization"),r.qZA(),r.TgZ(18,"div",18),r.TgZ(19,"button",19),r.NdJ("click",function(){return r.CHM(t),r.oxw().list.get()}),r._UZ(20,"i",20),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"div",13),r._UZ(22,"abp-extensible-table",21),r.ALo(23,"async"),r.qZA(),r.qZA(),r.BQk()}if(2&t){const t=e.ngIf,n=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,7,"Saas::Editions")),r.xp6(5),r.Q6J("record",t),r.xp6(7),r.Q6J("placeholder",r.lcZ(17,9,"AbpUi::PagerSearch"))("ngModel",n.list.filter),r.xp6(6),r.Q6J("data",t)("recordsTotal",r.lcZ(23,11,n.totalCount$))("list",n.list)}}function W(t,e){if(1&t&&(r.TgZ(0,"h3"),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Oqu(r.lcZ(2,1,null!=t.selected&&t.selected.id?"Saas::Edit":"Saas::NewEdition"))}}function X(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"form",22),r.NdJ("ngSubmit",function(){return r.CHM(t),r.oxw().save()}),r.TgZ(1,"div",23),r._UZ(2,"abp-extensible-form",24),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("formGroup",t.editionForm),r.xp6(2),r.Q6J("selectedRecord",t.selected)}}function tt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",25,26),r._uU(2),r.ALo(3,"abpLocalization"),r.qZA(),r.TgZ(4,"abp-button",27),r.NdJ("click",function(){return r.CHM(t),r.oxw().save()}),r._uU(5),r.ALo(6,"abpLocalization"),r.qZA()}if(2&t){const t=r.oxw();r.xp6(2),r.hij(" ",r.lcZ(3,3,"Saas::Cancel")," "),r.xp6(2),r.Q6J("disabled",null==t.editionForm?null:t.editionForm.invalid),r.xp6(1),r.Oqu(r.lcZ(6,5,"AbpIdentity::Save"))}}function et(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"abp-feature-management",28),r.NdJ("visibleChange",function(e){return r.CHM(t),r.oxw().visibleFeatures=e}),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("visible",t.visibleFeatures)("providerKey",t.providerKey)}}const nt=function(){return{value:"E"}},it=function(t){return{value:t}},at=function(t){return{value:t,twoWay:!0}},st=function(t,e,n){return{providerName:t,providerKey:e,visible:n}},ot=function(t){return{visibleChange:t}},rt=function(t,e){return{inputs:t,outputs:e,componentKey:"FeatureManagement.FeatureManagementComponent"}},ct=["tenantModalTemplate"],ut=["connectionStringModalTemplate"];function lt(t,e){if(1&t){const t=r.EpF();r.ynx(0),r.TgZ(1,"div",8),r.TgZ(2,"div",9),r.TgZ(3,"h1",10),r._uU(4),r.ALo(5,"abpLocalization"),r.qZA(),r.qZA(),r.TgZ(6,"div",11),r._UZ(7,"abp-breadcrumb"),r.qZA(),r.TgZ(8,"div",12),r._UZ(9,"abp-page-toolbar",13),r.qZA(),r.qZA(),r.TgZ(10,"div",14),r.TgZ(11,"div",15),r.TgZ(12,"div",16),r.TgZ(13,"div",17),r.TgZ(14,"div",12),r.TgZ(15,"div",18),r.TgZ(16,"input",19),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw().list.filter=e}),r.ALo(17,"abpLocalization"),r.qZA(),r.TgZ(18,"div",20),r.TgZ(19,"button",21),r.NdJ("click",function(){return r.CHM(t),r.oxw().list.get()}),r._UZ(20,"i",22),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"div",15),r._UZ(22,"abp-extensible-table",23),r.ALo(23,"async"),r.qZA(),r.qZA(),r.BQk()}if(2&t){const t=e.ngIf,n=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,7,"Saas::Tenants")),r.xp6(5),r.Q6J("record",t),r.xp6(7),r.Q6J("placeholder",r.lcZ(17,9,"AbpUi::PagerSearch"))("ngModel",n.list.filter),r.xp6(6),r.Q6J("data",t)("recordsTotal",r.lcZ(23,11,n.totalCount$))("list",n.list)}}function dt(t,e){if(1&t&&(r.TgZ(0,"h3"),r._uU(1),r.ALo(2,"abpLocalization"),r.qZA()),2&t){const t=r.oxw();r.xp6(1),r.Oqu(r.lcZ(2,1,t.selectedModalContent.title))}}function pt(t,e){1&t&&r.GkF(0)}function gt(t,e){if(1&t&&r.YNc(0,pt,1,0,"ng-container",24),2&t){const t=r.oxw();r.Q6J("ngTemplateOutlet",null==t.selectedModalContent?null:t.selectedModalContent.template)}}function ht(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"button",25,26),r._uU(2),r.ALo(3,"abpLocalization"),r.qZA(),r.TgZ(4,"abp-button",27),r.NdJ("click",function(){return r.CHM(t),r.oxw().save()}),r._uU(5),r.ALo(6,"abpLocalization"),r.qZA()}if(2&t){const t=r.oxw();r.xp6(2),r.hij(" ",r.lcZ(3,3,"Saas::Cancel")," "),r.xp6(2),r.Q6J("disabled",t.isDisabledSaveButton),r.xp6(1),r.Oqu(r.lcZ(6,5,"AbpIdentity::Save"))}}function mt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"form",29),r.NdJ("ngSubmit",function(){return r.CHM(t),r.oxw(2).save()}),r.TgZ(1,"div",30),r._UZ(2,"abp-extensible-form",31),r.qZA(),r.qZA()}if(2&t){const t=r.oxw(2);r.Q6J("formGroup",t.tenantForm),r.xp6(2),r.Q6J("selectedRecord",t.selected)}}function ft(t,e){if(1&t&&r.YNc(0,mt,3,2,"form",28),2&t){const t=r.oxw();r.Q6J("ngIf",t.tenantForm)}}function Tt(t,e){1&t&&(r.TgZ(0,"div",33),r.TgZ(1,"label",38),r._uU(2),r.ALo(3,"abpLocalization"),r.qZA(),r._UZ(4,"input",39),r.qZA()),2&t&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"Saas::DisplayName:DefaultConnectionString")))}function vt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"form",32),r.NdJ("ngSubmit",function(){return r.CHM(t),r.oxw().save()}),r.TgZ(1,"div",30),r.TgZ(2,"div",33),r.TgZ(3,"div",34),r.TgZ(4,"input",35),r.NdJ("ngModelChange",function(e){return r.CHM(t),r.oxw().onSharedDatabaseChange(e)}),r.qZA(),r.TgZ(5,"label",36),r._uU(6),r.ALo(7,"abpLocalization"),r.qZA(),r.qZA(),r.qZA(),r.YNc(8,Tt,5,3,"div",37),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("formGroup",t.defaultConnectionStringForm),r.xp6(6),r.Oqu(r.lcZ(7,3,"Saas::DisplayName:UseSharedDatabase")),r.xp6(2),r.Q6J("ngIf",!t.useSharedDatabase)}}function bt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"abp-feature-management",40),r.NdJ("visibleChange",function(e){return r.CHM(t),r.oxw().visibleFeatures=e}),r.qZA()}if(2&t){const t=r.oxw();r.Q6J("visible",t.visibleFeatures)("providerKey",t.providerKey)}}const St=function(){return{value:"T"}};function yt(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"div",1),r.TgZ(1,"div",2),r.TgZ(2,"div",3),r.TgZ(3,"h5",4),r._uU(4),r.ALo(5,"abpLocalization"),r.qZA(),r.qZA(),r.TgZ(6,"div",5),r.TgZ(7,"div",6),r.TgZ(8,"abp-chart",7,8),r.NdJ("initialized",function(e){return r.CHM(t),r.oxw().initialize(e)}),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&t){const t=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,4,"Saas::EditionUsageStatistics")),r.xp6(4),r.Q6J("data",t.chartData)("width",t.width)("height",t.height)}}function Zt(t,e){if(1&t&&(r.TgZ(0,"tr"),r.TgZ(1,"th"),r._uU(2),r.qZA(),r.TgZ(3,"td"),r._uU(4),r.qZA(),r.TgZ(5,"td"),r._uU(6),r.qZA(),r.qZA()),2&t){const t=e.$implicit,n=e.index;r.xp6(2),r.Oqu(n+1),r.xp6(2),r.Oqu(t.name),r.xp6(2),r.Oqu(t.editionName)}}function Ct(t,e){if(1&t&&(r.TgZ(0,"div",1),r.TgZ(1,"div",2),r.TgZ(2,"div",3),r.TgZ(3,"h5",4),r._uU(4,"Latest tenants"),r.qZA(),r.qZA(),r.TgZ(5,"div",5),r.TgZ(6,"div"),r.TgZ(7,"table",6),r.TgZ(8,"thead"),r.TgZ(9,"tr"),r.TgZ(10,"th"),r._uU(11,"#"),r.qZA(),r.TgZ(12,"th"),r._uU(13),r.ALo(14,"abpLocalization"),r.qZA(),r.TgZ(15,"th"),r._uU(16),r.ALo(17,"abpLocalization"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(18,"tbody"),r.YNc(19,Zt,7,3,"tr",7),r.ALo(20,"async"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t){const t=r.oxw();r.xp6(6),r.Udp("min-height",t.minHeight,"px"),r.xp6(7),r.Oqu(r.lcZ(14,6,"Saas::Name")),r.xp6(3),r.Oqu(r.lcZ(17,8,"Saas::EditionName")),r.xp6(3),r.Q6J("ngForOf",r.lcZ(20,10,t.datas$))("ngForTrackBy",t.trackByFn)}}let At=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Tenant",t})(),xt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Tenant By Id",t})(),Nt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Create Tenant",t})(),Ft=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Update Tenant",t})(),wt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Delete Tenant",t})(),Et=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Edition",t})(),qt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Edition By Id",t})(),Ot=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Create Edition",t})(),Mt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Update Edition",t})(),_t=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Delete Edition",t})(),Lt=(()=>{class t{}return t.type="[Saas] Get Usage Statistics",t})(),kt=(()=>{class t{}return t.type="[Saas] Get Latest Tenatns",t})(),Ut=(()=>{class t{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=t=>this.restService.request({method:"POST",url:"/api/saas/editions",body:t},{apiName:this.apiName}),this.delete=t=>this.restService.request({method:"DELETE",url:`/api/saas/editions/${t}`},{apiName:this.apiName}),this.get=t=>this.restService.request({method:"GET",url:`/api/saas/editions/${t}`},{apiName:this.apiName}),this.getList=t=>this.restService.request({method:"GET",url:"/api/saas/editions",params:{filter:t.filter,sorting:t.sorting,skipCount:t.skipCount,maxResultCount:t.maxResultCount}},{apiName:this.apiName}),this.getUsageStatistics=()=>this.restService.request({method:"GET",url:"/api/saas/editions/statistics/usage-statistic"},{apiName:this.apiName}),this.update=(t,e)=>this.restService.request({method:"PUT",url:`/api/saas/editions/${t}`,body:e},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(a.vgb))},t.\u0275prov=(0,r.Yz7)({factory:function(){return new t((0,r.LFG)(a.vgb))},token:t,providedIn:"root"}),t})(),It=(()=>{class t{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=t=>this.restService.request({method:"POST",url:"/api/saas/tenants",body:t},{apiName:this.apiName}),this.delete=t=>this.restService.request({method:"DELETE",url:`/api/saas/tenants/${t}`},{apiName:this.apiName}),this.deleteDefaultConnectionString=t=>this.restService.request({method:"DELETE",url:`/api/saas/tenants/${t}/default-connection-string`},{apiName:this.apiName}),this.get=t=>this.restService.request({method:"GET",url:`/api/saas/tenants/${t}`},{apiName:this.apiName}),this.getDefaultConnectionString=t=>this.restService.request({method:"GET",url:`/api/saas/tenants/${t}/default-connection-string`,responseType:"text"},{apiName:this.apiName}),this.getList=t=>this.restService.request({method:"GET",url:"/api/saas/tenants",params:{filter:t.filter,getEditionNames:t.getEditionNames,sorting:t.sorting,skipCount:t.skipCount,maxResultCount:t.maxResultCount}},{apiName:this.apiName}),this.update=(t,e)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${t}`,body:e},{apiName:this.apiName}),this.updateDefaultConnectionString=(t,e)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${t}/default-connection-string`,params:{defaultConnectionString:e}},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(a.vgb))},t.\u0275prov=(0,r.Yz7)({factory:function(){return new t((0,r.LFG)(a.vgb))},token:t,providedIn:"root"}),t})(),Jt=(()=>{let t=class{constructor(t,e){this.tenantService=t,this.editionService=e}static getTenants({tenants:t}){return t.items||[]}static getLatestTenants({latestTenants:t}){return t}static getTenantsTotalCount({tenants:t}){return t.totalCount||0}static getEditions({editions:t}){return t.items||[]}static getEditionsTotalCount({editions:t}){return t.totalCount||0}static getUsageStatistics({usageStatistics:t}){return t}getTenants({patchState:t},{payload:e}){return this.tenantService.getList(e).pipe((0,u.b)(e=>t({tenants:e})))}deleteTenant(t,{payload:e}){return this.tenantService.delete(e)}createTenant(t,{payload:e}){return this.tenantService.create(e)}updateTenant(t,e){var n=e.payload,{id:a}=n,s=(0,i._T)(n,["id"]);return this.tenantService.update(a,s)}getEditions({patchState:t},{payload:e}){return this.editionService.getList(e).pipe((0,u.b)(e=>t({editions:e})))}deleteEdition(t,{payload:e}){return this.editionService.delete(e)}createEdition(t,{payload:e}){return this.editionService.create(e)}updateEdition(t,e){var n=e.payload,{id:a}=n,s=(0,i._T)(n,["id"]);return this.editionService.update(a,s)}getUsage({patchState:t}){return this.editionService.getUsageStatistics().pipe((0,u.b)(e=>{t({usageStatistics:e.data})}))}getLatestTenants({patchState:t}){return this.tenantService.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).pipe((0,u.b)(e=>{t({latestTenants:e.items})}))}};return t.\u0275fac=function(e){return new(e||t)(r.LFG(It),r.LFG(Ut))},t.\u0275prov=r.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),(0,i.gn)([(0,c.aU)(At)],t.prototype,"getTenants",null),(0,i.gn)([(0,c.aU)(wt)],t.prototype,"deleteTenant",null),(0,i.gn)([(0,c.aU)(Nt)],t.prototype,"createTenant",null),(0,i.gn)([(0,c.aU)(Ft)],t.prototype,"updateTenant",null),(0,i.gn)([(0,c.aU)(Et)],t.prototype,"getEditions",null),(0,i.gn)([(0,c.aU)(_t)],t.prototype,"deleteEdition",null),(0,i.gn)([(0,c.aU)(Ot)],t.prototype,"createEdition",null),(0,i.gn)([(0,c.aU)(Mt)],t.prototype,"updateEdition",null),(0,i.gn)([(0,c.aU)(Lt)],t.prototype,"getUsage",null),(0,i.gn)([(0,c.aU)(kt)],t.prototype,"getLatestTenants",null),(0,i.gn)([(0,c.Qf)()],t,"getTenants",null),(0,i.gn)([(0,c.Qf)()],t,"getLatestTenants",null),(0,i.gn)([(0,c.Qf)()],t,"getTenantsTotalCount",null),(0,i.gn)([(0,c.Qf)()],t,"getEditions",null),(0,i.gn)([(0,c.Qf)()],t,"getEditionsTotalCount",null),(0,i.gn)([(0,c.Qf)()],t,"getUsageStatistics",null),t=(0,i.gn)([(0,c.ZM)({name:"SaasState",defaults:{tenants:{},editions:{},latestTenants:[],usageStatistics:{}}})],t),t})();const Bt="Saas.EditionsComponent";let Yt=(()=>{class t{constructor(t,e,n,i,a){this.list=t,this.confirmationService=e,this.editionService=n,this.store=i,this.injector=a,this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=t=>{this.visibleFeatures=t}}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.store.dispatch(new Et(t))).subscribe()}createEditionForm(){const t=new o.lg(this.injector,this.selected);this.editionForm=(0,o.se)(t)}onAddEdition(){this.selected={},this.createEditionForm(),this.isModalVisible=!0}onEditEdition(t){this.editionService.get(t).subscribe(t=>{this.selected=t,this.createEditionForm(),this.isModalVisible=!0})}save(){this.editionForm.valid&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Mt(Object.assign(Object.assign(Object.assign({},this.selected),this.editionForm.value),{id:this.selected.id})):new Ot(this.editionForm.value)).pipe((0,l.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1}))}delete({id:t,displayName:e}){this.confirmationService.warn("Saas::EditionDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[e]}).subscribe(e=>{e===s.Tv.Status.confirm&&this.store.dispatch(new _t(t)).subscribe(()=>this.list.get())})}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(a.XNV),r.Y36(s.YP),r.Y36(Ut),r.Y36(c.yh),r.Y36(r.zs3))},t.\u0275cmp=r.Xpm({type:t,selectors:[["abp-editions"]],features:[r._Bn([a.XNV,{provide:o.ex,useValue:Bt}])],decls:10,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["providerName","E",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["providerName","E",3,"visible","providerKey","visibleChange"]],template:function(t,e){1&t&&(r.YNc(0,K,24,13,"ng-container",0),r.ALo(1,"async"),r.TgZ(2,"abp-modal",1),r.NdJ("visibleChange",function(t){return e.isModalVisible=t})("disappear",function(){return e.editionForm=null}),r.YNc(3,W,3,3,"ng-template",null,2,r.W1O),r.YNc(5,X,3,2,"ng-template",null,3,r.W1O),r.YNc(7,tt,7,7,"ng-template",null,4,r.W1O),r.qZA(),r.YNc(9,et,1,2,"abp-feature-management",5)),2&t&&(r.Q6J("ngIf",r.lcZ(1,4,e.data$)),r.xp6(2),r.Q6J("visible",e.isModalVisible)("busy",e.modalBusy),r.xp6(7),r.Q6J("abpReplaceableTemplate",r.WLB(17,rt,r.kEZ(11,st,r.DdM(6,nt),r.VKq(7,it,e.providerKey),r.VKq(9,at,e.visibleFeatures)),r.VKq(15,ot,e.onVisibleFeaturesChange))))},directives:[S.O5,s.zS,a.zLP,s.LI,o._V,m.Fj,m.JJ,m.On,o.m5,m._Y,m.JL,a.YzZ,$.hL,m.sg,o.gt,s.r0,G],pipes:[S.Ov,a.fuE],encapsulation:2}),(0,i.gn)([(0,c.Ph)(Jt.getEditions)],t.prototype,"data$",void 0),(0,i.gn)([(0,c.Ph)(Jt.getEditionsTotalCount)],t.prototype,"totalCount$",void 0),t})(),Qt=(()=>{class t{constructor(t,e,n,i,a,s){this.list=t,this.confirmationService=e,this.tenantService=n,this.fb=i,this.store=a,this.injector=s,this.selectedModalContent={},this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=t=>{this.visibleFeatures=t}}get useSharedDatabase(){return this.defaultConnectionStringForm.get("useSharedDatabase").value}get connectionString(){return this.defaultConnectionStringForm.get("defaultConnectionString").value}get hasSelectedTenant(){return Boolean(this.selected.id)}get isDisabledSaveButton(){return!(!this.selectedModalContent||!("saveConnStr"===this.selectedModalContent.type&&this.defaultConnectionStringForm&&this.defaultConnectionStringForm.invalid||"saveTenant"===this.selectedModalContent.type&&this.tenantForm&&this.tenantForm.invalid))}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.store.dispatch(new At(t))).subscribe()}createTenantForm(){this.store.select(Jt.getEditions).pipe((0,d.w)(t=>t.length?(0,f.of)(t):this.store.dispatch(new Et({maxResultCount:1e3})))).subscribe(()=>{const t=new o.lg(this.injector,this.selected);this.tenantForm=(0,o.se)(t)})}createDefaultConnectionStringForm(){this.defaultConnectionStringForm=this.fb.group({useSharedDatabase:this._useSharedDatabase,defaultConnectionString:this.defaultConnectionString||""})}openModal(t,e,n){this.selectedModalContent={title:t,template:e,type:n},this.isModalVisible=!0}onEditConnectionString(t){this.tenantService.get(t).pipe((0,u.b)(t=>this.selected=t),(0,d.w)(()=>this.tenantService.getDefaultConnectionString(t))).subscribe(t=>{this._useSharedDatabase=!t,this.defaultConnectionString=t||"",this.createDefaultConnectionStringForm(),this.openModal("Saas::ConnectionStrings",this.connectionStringModalTemplate,"saveConnStr")})}onAddTenant(){this.selected={},this.createTenantForm(),this.openModal("Saas::NewTenant",this.tenantModalTemplate,"saveTenant")}onEditTenant(t){this.tenantService.get(t).subscribe(t=>{this.selected=t,this.createTenantForm(),this.openModal("Saas::Edit",this.tenantModalTemplate,"saveTenant")})}save(){const{type:t}=this.selectedModalContent;t&&("saveTenant"===t?this.saveTenant():"saveConnStr"===t&&this.saveConnectionString())}saveConnectionString(){this.modalBusy||(this.modalBusy=!0,this.useSharedDatabase||!this.useSharedDatabase&&!this.connectionString?this.tenantService.deleteDefaultConnectionString(this.selected.id).pipe((0,p.q)(1),(0,l.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1}):this.tenantService.updateDefaultConnectionString(this.selected.id,this.connectionString).pipe((0,p.q)(1),(0,l.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1}))}saveTenant(){this.tenantForm.valid&&!this.modalBusy&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Ft(Object.assign(Object.assign(Object.assign({},this.selected),this.tenantForm.value),{id:this.selected.id})):new Nt(this.tenantForm.value)).pipe((0,l.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1}))}delete(t,e){this.confirmationService.warn("Saas::TenantDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[e]}).subscribe(e=>{e===s.Tv.Status.confirm&&this.store.dispatch(new wt(t)).subscribe(()=>this.list.get())})}onSharedDatabaseChange(t){t||setTimeout(()=>{const t=document.getElementById("defaultConnectionString");t&&t.focus()},0)}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(a.XNV),r.Y36(s.YP),r.Y36(It),r.Y36(m.qu),r.Y36(c.yh),r.Y36(r.zs3))},t.\u0275cmp=r.Xpm({type:t,selectors:[["abp-tenants"]],viewQuery:function(t,e){if(1&t&&(r.Gf(ct,5),r.Gf(ut,5)),2&t){let t;r.iGM(t=r.CRH())&&(e.tenantModalTemplate=t.first),r.iGM(t=r.CRH())&&(e.connectionStringModalTemplate=t.first)}},features:[r._Bn([a.XNV,{provide:o.ex,useValue:"Saas.TenantsComponent"}])],decls:14,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["validateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"custom-checkbox","custom-control","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"custom-control-input",3,"ngModelChange"],["for","useSharedDatabase",1,"custom-control-label"],["class","form-group",4,"ngIf"],["for","defaultConnectionString"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(t,e){1&t&&(r.YNc(0,lt,24,13,"ng-container",0),r.ALo(1,"async"),r.TgZ(2,"abp-modal",1),r.NdJ("visibleChange",function(t){return e.isModalVisible=t})("disappear",function(){return e.tenantForm=null,e.defaultConnectionStringForm=null}),r.YNc(3,dt,3,3,"ng-template",null,2,r.W1O),r.YNc(5,gt,1,1,"ng-template",null,3,r.W1O),r.YNc(7,ht,7,7,"ng-template",null,4,r.W1O),r.qZA(),r.YNc(9,ft,1,1,"ng-template",null,5,r.W1O),r.YNc(11,vt,9,5,"ng-template",null,6,r.W1O),r.YNc(13,bt,1,2,"abp-feature-management",7)),2&t&&(r.Q6J("ngIf",r.lcZ(1,4,e.tenants$)),r.xp6(2),r.Q6J("visible",e.isModalVisible)("busy",e.modalBusy),r.xp6(11),r.Q6J("abpReplaceableTemplate",r.WLB(17,rt,r.kEZ(11,st,r.DdM(6,St),r.VKq(7,it,e.providerKey),r.VKq(9,at,e.visibleFeatures)),r.VKq(15,ot,e.onVisibleFeaturesChange))))},directives:[S.O5,s.zS,a.zLP,s.LI,o._V,m.Fj,m.JJ,m.On,o.m5,S.tP,s.r0,m._Y,m.JL,a.YzZ,$.hL,m.sg,o.gt,m.Wl,$.J5,m.u,a.Uqp,G],pipes:[S.Ov,a.fuE],encapsulation:2}),(0,i.gn)([(0,c.Ph)(Jt.getTenants)],t.prototype,"tenants$",void 0),(0,i.gn)([(0,c.Ph)(Jt.getTenantsTotalCount)],t.prototype,"totalCount$",void 0),(0,i.gn)([(0,c.Ph)(Jt.getEditions)],t.prototype,"editions$",void 0),t})(),Dt=(()=>{class t{constructor(t,e,n){this.store=t,this.subscription=e,this.permissionService=n,this.initialized=new T.X(this),this.width=273,this.height=136,this.chartData={},this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Editions")&&this.store.dispatch(new Lt)},this.listenToData()}initialize(t){this.chart=t}listenToData(){this.subscription.addOne(this.data$,t=>{if(!t||"{}"===JSON.stringify(t))return void(this.chartData={});const e=Object.keys(t);setTimeout(()=>{this.chartData={labels:e,datasets:[{data:e.map(e=>t[e]),backgroundColor:(0,s.pc)(Object.keys(t).length)}]},this.chart.refresh()},0)})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c.yh),r.Y36(a.FFO),r.Y36(a.$AH))},t.\u0275cmp=r.Xpm({type:t,selectors:[["abp-editions-usage-widget"]],inputs:{width:"width",height:"height"},outputs:{initialized:"initialized"},features:[r._Bn([a.FFO])],decls:1,vars:1,consts:[["class","abp-widget-wrapper",4,"abpPermission"],[1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],["type","pie",1,"w-100",3,"data","width","height","initialized"],["chart",""]],template:function(t,e){1&t&&r.YNc(0,yt,10,6,"div",0),2&t&&r.Q6J("abpPermission","Saas.Editions")},directives:[a.l97,s.xH],pipes:[a.fuE],encapsulation:2}),(0,i.gn)([(0,c.Ph)(Jt.getUsageStatistics)],t.prototype,"data$",void 0),t})(),Pt=(()=>{class t{constructor(t,e){this.store=t,this.permissionService=e,this.minHeight=136,this.trackByFn=(t,e)=>e.id,this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Tenants")&&this.store.dispatch(new kt)}}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(c.yh),r.Y36(a.$AH))},t.\u0275cmp=r.Xpm({type:t,selectors:[["abp-latest-tenants-widget"]],inputs:{minHeight:"minHeight"},decls:1,vars:1,consts:[["class","abp-widget-wrapper","data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",4,"abpPermission"],["data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"table","table-hover","table-sm"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,e){1&t&&r.YNc(0,Ct,21,12,"div",0),2&t&&r.Q6J("abpPermission","Saas.Tenants")},directives:[a.l97,S.sg],pipes:[a.fuE,S.Ov],encapsulation:2}),(0,i.gn)([(0,c.Ph)(Jt.getLatestTenants)],t.prototype,"datas$",void 0),t})();const Gt=o.uk.createMany([{text:"Saas::Edit",action:t=>{t.getInjected(Yt).onEditEdition(t.record.id)},permission:"Saas.Editions.Update"},{text:"Saas::Features",action:t=>{t.getInjected(Yt).openFeaturesModal(t.record.id)},permission:"Saas.Editions.ManageFeatures"},{text:"Saas::ChangeHistory",action:t=>{t.getInjected(v.kv)(t.record.id,"Volo.Saas.Edition")},permission:"Saas.Editions.ViewChangeHistory",visible:t=>Boolean(t.getInjected(v.kv,null))},{text:"Saas::Delete",action:t=>{t.getInjected(Yt).delete(t.record)},permission:"Saas.Editions.Delete"}]),Vt=o.QC.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",sortable:!0}]),Rt=o.Od.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",validators:()=>[m.kI.required,m.kI.maxLength(256)]}]),jt=Rt,zt=o.JE.createMany([{text:"Saas::NewEdition",action:t=>{t.getInjected(Yt).onAddEdition()},permission:"Saas.Editions.Create",icon:"fa fa-plus"}]),$t=o.uk.createMany([{text:"Saas::Edit",action:t=>{t.getInjected(Qt).onEditTenant(t.record.id)},permission:"Saas.Tenants.Update"},{text:"Saas::ConnectionStrings",action:t=>{t.getInjected(Qt).onEditConnectionString(t.record.id)},permission:"Saas.Tenants.ManageConnectionStrings"},{text:"Saas::Features",action:t=>{t.getInjected(Qt).openFeaturesModal(t.record.id)},permission:"Saas.Tenants.ManageFeatures"},{text:"Saas::ChangeHistory",action:t=>{t.getInjected(v.kv)(t.record.id,"Volo.Saas.Tenant")},permission:"Saas.Tenants.ViewChangeHistory",visible:t=>Boolean(t.getInjected(v.kv,null))},{text:"Saas::Delete",action:t=>{t.getInjected(Qt).delete(t.record.id,t.record.name)},permission:"Saas.Tenants.Delete"}]),Ht=o.QC.createMany([{type:"string",name:"name",displayName:"Saas::TenantName",sortable:!0,columnWidth:370},{type:"string",name:"editionName",displayName:"Saas::EditionName",columnWidth:370}]),Kt=o.Od.createMany([{type:"string",name:"name",id:"name",displayName:"Saas::TenantName",validators:()=>[m.kI.required,m.kI.maxLength(256)]},{type:"string",name:"editionId",displayName:"Saas::Edition",id:"edition",options:t=>t.getInjected(Qt).editions$.pipe((0,g.U)(t=>[{key:"",value:""},...t.map(t=>({key:t.displayName,value:t.id}))]))},{type:"email",name:"adminEmailAddress",displayName:"Saas::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[m.kI.required,m.kI.maxLength(256),m.kI.email]},{type:"password",name:"adminPassword",displayName:"Saas::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:t=>[m.kI.required,...(0,s.dD)({get:t.getInjected})]}]),Wt=Kt.slice(0,2),Xt=o.JE.createMany([{text:"Saas::ManageHostFeatures",action:t=>{t.getInjected(Qt).openFeaturesModal(null)},permission:"Saas.Tenants.ManageFeatures",icon:"fa fa-cog"},{text:"Saas::NewTenant",action:t=>{t.getInjected(Qt).onAddTenant()},permission:"Saas.Tenants.Create",icon:"fa fa-plus"}]),te={"Saas.EditionsComponent":Gt,"Saas.TenantsComponent":$t},ee={"Saas.EditionsComponent":zt,"Saas.TenantsComponent":Xt},ne={"Saas.EditionsComponent":Vt,"Saas.TenantsComponent":Ht},ie={"Saas.EditionsComponent":Rt,"Saas.TenantsComponent":Kt},ae={"Saas.EditionsComponent":jt,"Saas.TenantsComponent":Wt},se=new r.OlP("SAAS_ENTITY_ACTION_CONTRIBUTORS"),oe=new r.OlP("SAAS_TOOLBAR_ACTION_CONTRIBUTORS"),re=new r.OlP("SAAS_ENTITY_PROP_CONTRIBUTORS"),ce=new r.OlP("SAAS_CREATE_FORM_PROP_CONTRIBUTORS"),ue=new r.OlP("SAAS_EDIT_FORM_PROP_CONTRIBUTORS");let le=(()=>{class t{constructor(t){this.injector=t}canActivate(){const t=this.injector.get(o.X6),e=this.injector.get(se,null)||{},n=this.injector.get(oe,null)||{},i=this.injector.get(re,null)||{},s=this.injector.get(ce,null)||{},r=this.injector.get(ue,null)||{},c=this.injector.get(a.XJE);return(0,o.ot)(c,"Saas").pipe((0,g.U)(t=>({"Saas.EditionsComponent":t.Edition,"Saas.TenantsComponent":t.Tenant})),(0,o.V_)(c,"Saas"),(0,u.b)(a=>{(0,o.Fr)(t.entityActions,te,e),(0,o.Fr)(t.toolbarActions,ee,n),(0,o.Hp)(t.entityProps,ne,a.prop,i),(0,o.Hp)(t.createFormProps,ie,a.createForm,s),(0,o.Hp)(t.editFormProps,ae,a.editForm,r)}),(0,h.h)(!0))}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const de=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:a.w6s,canActivate:[a.a1M,a.nG9,le],children:[{path:"tenants",component:a.c$y,data:{requiredPolicy:"Saas.Tenants",replaceableComponent:{key:"Saas.TenantsComponent",defaultComponent:Qt}}},{path:"editions",component:a.c$y,data:{requiredPolicy:"Saas.Editions",replaceableComponent:{key:"Saas.EditionsComponent",defaultComponent:Yt}}}]}];let pe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[H.Bz.forChild(de)],H.Bz]}),t})(),ge=(()=>{class t{static forChild(e={}){return{ngModule:t,providers:[{provide:se,useValue:e.entityActionContributors},{provide:oe,useValue:e.toolbarActionContributors},{provide:re,useValue:e.entityPropContributors},{provide:ce,useValue:e.createFormPropContributors},{provide:ue,useValue:e.editFormPropContributors},le]}}static forLazy(e={}){return new a.Cgl(t.forChild(e))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[pe,c.$l.forFeature([Jt]),$.h2,a.IR2,v.vv,s.e2,b.XC,z]]}),t})(),he=(()=>{class t{constructor(t){this.store=t}getTenants(){return this.store.selectSnapshot(Jt.getTenants)}getLatestTenants(){return this.store.selectSnapshot(Jt.getLatestTenants)}getTenantsTotalCount(){return this.store.selectSnapshot(Jt.getTenantsTotalCount)}getEditions(){return this.store.selectSnapshot(Jt.getEditions)}getEditionsTotalCount(){return this.store.selectSnapshot(Jt.getEditionsTotalCount)}getUsageStatistics(){return this.store.selectSnapshot(Jt.getUsageStatistics)}dispatchGetTenants(...t){return this.store.dispatch(new At(...t))}dispatchGetTenantById(...t){return this.store.dispatch(new xt(...t))}dispatchCreateTenant(...t){return this.store.dispatch(new Nt(...t))}dispatchUpdateTenant(...t){return this.store.dispatch(new Ft(...t))}dispatchDeleteTenant(...t){return this.store.dispatch(new wt(...t))}dispatchGetEditions(...t){return this.store.dispatch(new Et(...t))}dispatchGetEditionById(...t){return this.store.dispatch(new qt(...t))}dispatchCreateEdition(...t){return this.store.dispatch(new Ot(...t))}dispatchUpdateEdition(...t){return this.store.dispatch(new Mt(...t))}dispatchDeleteEdition(...t){return this.store.dispatch(new _t(...t))}dispatchGetUsageStatistics(){return this.store.dispatch(new Lt)}dispatchGetLatestTenants(){return this.store.dispatch(new kt)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(c.yh))},t.\u0275prov=(0,r.Yz7)({factory:function(){return new t((0,r.LFG)(c.yh))},token:t,providedIn:"root"}),t})()}}]);