!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}function t(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[13624],{13624:function(n,t,s){"use strict";s.d(t,{Mm:function(){return j},xM:function(){return J}});var o=s(46700),a=s(55679),c=s(35366),l=s(48400),u=s(64762),p=s(40878),m=s(44019),d=s(79996),f=s(90611),h=s(44689),g=s(11520),v=s(83588),b=s(61116),y=s(31041);function k(e,n){if(1&e&&(c.TgZ(0,"h4"),c._uU(1),c.ALo(2,"abpLocalization"),c.qZA()),2&e){var t=c.oxw().ngIf;c.xp6(1),c.AsE(" ",c.lcZ(2,2,"AbpPermissionManagement::Permissions")," - ",t.entityName," ")}}function A(e,n){if(1&e){var t=c.EpF();c.TgZ(0,"a",22),c.NdJ("click",function(){c.CHM(t);var e=c.oxw().$implicit;return c.oxw(3).onChangeGroup(e)}),c.TgZ(1,"div"),c._uU(2),c.TgZ(3,"span"),c._uU(4),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=n.ngIf,r=c.oxw().$implicit,s=c.oxw(3);c.ekj("active",(null==s.selectedGroup?null:s.selectedGroup.name)===(null==r?null:r.name)),c.xp6(1),c.ekj("font-weight-bold",i.assignedCount),c.xp6(1),c.hij(" ",null==r?null:r.displayName," "),c.xp6(2),c.hij("(",i.assignedCount,")")}}var x=function(e){return{assignedCount:e}};function T(e,n){if(1&e&&(c.TgZ(0,"li",20),c.YNc(1,A,5,6,"a",21),c.qZA()),2&e){var t=n.$implicit,i=c.oxw(3);c.xp6(1),c.Q6J("ngIf",c.VKq(1,x,i.getAssignedCount(t.name)))}}function Z(e,n){if(1&e&&(c.TgZ(0,"span",28),c._uU(1),c.qZA()),2&e){var t=n.$implicit;c.xp6(1),c.AsE("",t.providerName,": ",t.providerKey,"")}}function C(e,n){if(1&e&&(c.ynx(0),c.YNc(1,Z,2,2,"span",27),c.BQk()),2&e){var t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngForOf",t.grantedProviders)}}function N(e,n){if(1&e){var t=c.EpF();c.TgZ(0,"div",23),c._UZ(1,"input",24,25),c.TgZ(3,"label",26),c.NdJ("click",function(){var e=c.CHM(t).$implicit,n=c.MAs(2);return c.oxw(3).onClickCheckbox(e,n.value)}),c._uU(4),c.YNc(5,C,2,1,"ng-container",1),c.qZA(),c.qZA()}if(2&e){var i=n.$implicit,r=c.oxw(3);c.Q6J("ngStyle",i.style),c.xp6(1),c.Q6J("checked",r.getChecked(i.name))("value",r.getChecked(i.name))("disabled",r.isGrantedByOtherProviderName(i.grantedProviders)),c.uIk("id",i.name),c.xp6(2),c.uIk("for",i.name),c.xp6(1),c.hij("",i.displayName," "),c.xp6(1),c.Q6J("ngIf",!r.hideBadges)}}function G(e,n){if(1&e){var t=c.EpF();c.TgZ(0,"div",5),c.TgZ(1,"input",6),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw(2).selectAllTab=e})("click",function(){return c.CHM(t),c.oxw(2).onClickSelectAll()}),c.qZA(),c.TgZ(2,"label",7),c._uU(3),c.ALo(4,"abpLocalization"),c.qZA(),c.qZA(),c._UZ(5,"hr",8),c.TgZ(6,"div",9),c.TgZ(7,"div",10),c.TgZ(8,"ul",11),c.YNc(9,T,2,3,"li",12),c.ALo(10,"async"),c.qZA(),c.qZA(),c.TgZ(11,"div",13),c.TgZ(12,"h4"),c._uU(13),c.qZA(),c._UZ(14,"hr",14),c.TgZ(15,"div",15),c.TgZ(16,"div",5),c.TgZ(17,"input",16),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw(2).selectThisTab=e})("click",function(){return c.CHM(t),c.oxw(2).onClickSelectThisTab()}),c.qZA(),c.TgZ(18,"label",17),c._uU(19),c.ALo(20,"abpLocalization"),c.qZA(),c.qZA(),c._UZ(21,"hr",18),c.YNc(22,N,6,8,"div",19),c.ALo(23,"async"),c.qZA(),c.qZA(),c.qZA()}if(2&e){var i=c.oxw(2);c.xp6(1),c.Q6J("ngModel",i.selectAllTab),c.xp6(2),c.Oqu(c.lcZ(4,9,"AbpPermissionManagement::SelectAllInAllTabs")),c.xp6(6),c.Q6J("ngForOf",c.lcZ(10,11,i.groups$))("ngForTrackBy",i.trackByFn),c.xp6(4),c.Oqu(null==i.selectedGroup?null:i.selectedGroup.displayName),c.xp6(4),c.Q6J("ngModel",i.selectThisTab),c.xp6(2),c.Oqu(c.lcZ(20,13,"AbpPermissionManagement::SelectAllInThisTab")),c.xp6(3),c.Q6J("ngForOf",c.lcZ(23,15,i.selectedGroupPermissions$))("ngForTrackBy",i.trackByFn)}}function w(e,n){if(1&e){var t=c.EpF();c.TgZ(0,"button",29,30),c._uU(2),c.ALo(3,"abpLocalization"),c.qZA(),c.TgZ(4,"abp-button",31),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).submit()}),c._uU(5),c.ALo(6,"abpLocalization"),c.qZA()}2&e&&(c.xp6(2),c.hij(" ",c.lcZ(3,2,"AbpIdentity::Cancel")," "),c.xp6(3),c.Oqu(c.lcZ(6,4,"AbpIdentity::Save")))}function P(e,n){1&e&&(c.ynx(0),c.YNc(1,k,3,4,"ng-template",null,2,c.W1O),c.YNc(3,G,24,17,"ng-template",null,3,c.W1O),c.YNc(5,w,7,6,"ng-template",null,4,c.W1O),c.BQk())}var S=function(e){return{entityName:e}},O=function(){var e=function e(n){r(this,e),this.payload=n};return e.type="[PermissionManagement] Get Permissions",e}(),M=function(){var e=function e(n){r(this,e),this.payload=n};return e.type="[PermissionManagement] Update Permissions",e}(),q=function(){var e=function e(n){var t=this;r(this,e),this.restService=n,this.apiName="AbpPermissionManagement",this.get=function(e,n){return t.restService.request({method:"GET",url:"/api/permission-management/permissions",params:{providerName:e,providerKey:n}},{apiName:t.apiName})},this.update=function(e,n,i){return t.restService.request({method:"PUT",url:"/api/permission-management/permissions",params:{providerName:e,providerKey:n},body:i},{apiName:t.apiName})}};return e.\u0275fac=function(n){return new(n||e)(c.LFG(o.vgb))},e.\u0275prov=(0,c.Yz7)({factory:function(){return new e((0,c.LFG)(o.vgb))},token:e,providedIn:"root"}),e}(),F=function(){var e=function(){function e(n){r(this,e),this.service=n}return i(e,[{key:"permissionManagementGet",value:function(e,n){var t=e.patchState,i=n.payload,r=(i=void 0===i?{}:i).providerKey,s=i.providerName;return this.service.get(s,r).pipe((0,m.b)(function(e){return t({permissionRes:e})}))}},{key:"permissionManagementUpdate",value:function(e,n){var t=n.payload;return this.service.update(t.providerName,t.providerKey,{permissions:t.permissions})}}],[{key:"getPermissionGroups",value:function(e){return e.permissionRes.groups||[]}},{key:"getEntityDisplayName",value:function(e){return e.permissionRes.entityDisplayName}}]),e}();return e.\u0275fac=function(n){return new(n||e)(c.LFG(q))},e.\u0275prov=c.Yz7({token:e,factory:function(n){return e.\u0275fac(n)}}),(0,u.gn)([(0,l.aU)(O)],e.prototype,"permissionManagementGet",null),(0,u.gn)([(0,l.aU)(M)],e.prototype,"permissionManagementUpdate",null),(0,u.gn)([(0,l.Qf)()],e,"getPermissionGroups",null),(0,u.gn)([(0,l.Qf)()],e,"getEntityDisplayName",null),e=(0,u.gn)([(0,l.ZM)({name:"PermissionManagementState",defaults:{permissionRes:{}}})],e)}(),j=function(){var n=function(){function n(e,t,i){r(this,n),this.store=e,this.configState=t,this.appConfigService=i,this.hideBadges=!1,this._visible=!1,this.visibleChange=new c.vpe,this.permissions=[],this.selectThisTab=!1,this.selectAllTab=!1,this.modalBusy=!1,this.trackByFn=function(e,n){return n.name}}return i(n,[{key:"visible",get:function(){return this._visible},set:function(e){var n=this;e!==this._visible&&(e?this.openModal().subscribe(function(){n._visible=!0,n.visibleChange.emit(!0)}):(this.selectedGroup=null,this._visible=!1,this.visibleChange.emit(!1)))}},{key:"selectedGroupPermissions$",get:function(){var e=this,n="margin-".concat("rtl"===document.body.dir?"right":"left",".px");return this.groups$.pipe((0,d.U)(function(n){return e.selectedGroup?n.find(function(n){return n.name===e.selectedGroup.name}).permissions:[]}),(0,d.U)(function(t){return t.map(function(i){return Object.assign(Object.assign({},i),{style:(r={},s=n,o=U(t,i),s in r?Object.defineProperty(r,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[s]=o,r),isGranted:e.permissions.find(function(e){return e.name===i.name}).isGranted});var r,s,o})}))}},{key:"getChecked",value:function(e){return(this.permissions.find(function(n){return n.name===e})||{isGranted:!1}).isGranted}},{key:"isGrantedByOtherProviderName",value:function(e){var n=this;return!!e.length&&e.findIndex(function(e){return e.providerName!==n.providerName})>-1}},{key:"onClickCheckbox",value:function(e,n){var t=this;e.isGranted&&this.isGrantedByOtherProviderName(e.grantedProviders)||setTimeout(function(){t.permissions=t.permissions.map(function(n){return e.name===n.name?Object.assign(Object.assign({},n),{isGranted:!n.isGranted}):e.name===n.parentName&&e.isGranted?Object.assign(Object.assign({},n),{isGranted:!1}):e.parentName!==n.name||e.isGranted?n:Object.assign(Object.assign({},n),{isGranted:!0})}),t.setTabCheckboxState(),t.setGrantCheckboxState()},0)}},{key:"setTabCheckboxState",value:function(){var e=this;this.selectedGroupPermissions$.pipe((0,f.q)(1)).subscribe(function(n){var t=n.filter(function(e){return e.isGranted}),i=document.querySelector("#select-all-in-this-tabs");t.length===n.length?(i.indeterminate=!1,e.selectThisTab=!0):0===t.length?(i.indeterminate=!1,e.selectThisTab=!1):i.indeterminate=!0})}},{key:"setGrantCheckboxState",value:function(){var e=this.permissions.filter(function(e){return e.isGranted}),n=document.querySelector("#select-all-in-all-tabs");e.length===this.permissions.length?(n.indeterminate=!1,this.selectAllTab=!0):0===e.length?(n.indeterminate=!1,this.selectAllTab=!1):n.indeterminate=!0}},{key:"onClickSelectThisTab",value:function(){var n=this;this.selectedGroupPermissions$.pipe((0,f.q)(1)).subscribe(function(t){t.forEach(function(t){if(!t.isGranted||!n.isGrantedByOtherProviderName(t.grantedProviders)){var i=n.permissions.findIndex(function(e){return e.name===t.name});n.permissions=[].concat(e(n.permissions.slice(0,i)),[Object.assign(Object.assign({},n.permissions[i]),{isGranted:!n.selectThisTab})],e(n.permissions.slice(i+1)))}})}),this.setGrantCheckboxState()}},{key:"onClickSelectAll",value:function(){var e=this;this.permissions=this.permissions.map(function(n){return Object.assign(Object.assign({},n),{isGranted:e.isGrantedByOtherProviderName(n.grantedProviders)||!e.selectAllTab})}),this.selectThisTab=!this.selectAllTab}},{key:"onChangeGroup",value:function(e){this.selectedGroup=e,this.setTabCheckboxState()}},{key:"submit",value:function(){var e=this,n=B(this.store.selectSnapshot(F.getPermissionGroups)),t=this.permissions.filter(function(e){return n.find(function(n){return n.name===e.name}).isGranted!==e.isGranted}).map(function(e){return{name:e.name,isGranted:e.isGranted}});t.length?(this.modalBusy=!0,this.store.dispatch(new M({providerKey:this.providerKey,providerName:this.providerName,permissions:t})).pipe((0,h.w)(function(){return e.shouldFetchAppConfig()?e.appConfigService.get().pipe((0,m.b)(function(n){return e.configState.setState(n)})):(0,p.of)(null)}),(0,g.x)(function(){return e.modalBusy=!1})).subscribe(function(){e.visible=!1})):this.visible=!1}},{key:"openModal",value:function(){var e=this;if(!this.providerKey||!this.providerName)throw new Error("Provider Key and Provider Name are required.");return this.store.dispatch(new O({providerKey:this.providerKey,providerName:this.providerName})).pipe((0,v.j)("PermissionManagementState","permissionRes"),(0,m.b)(function(n){e.selectedGroup=n.groups[0],e.permissions=B(n.groups)}))}},{key:"initModal",value:function(){this.setTabCheckboxState(),this.setGrantCheckboxState()}},{key:"getAssignedCount",value:function(e){return this.permissions.reduce(function(n,t){return t.name.split(".")[0]===e&&t.isGranted?n+1:n},0)}},{key:"shouldFetchAppConfig",value:function(){var e=this,n=this.configState.getOne("currentUser");return"R"===this.providerName?n.roles.some(function(n){return n===e.providerKey}):"U"===this.providerName&&n.id===this.providerKey}}]),n}();return n.\u0275fac=function(e){return new(e||n)(c.Y36(l.yh),c.Y36(o.XJE),c.Y36(o.xa_))},n.\u0275cmp=c.Xpm({type:n,selectors:[["abp-permission-management"]],inputs:{hideBadges:"hideBadges",visible:"visible",providerName:"providerName",providerKey:"providerKey"},outputs:{visibleChange:"visibleChange"},exportAs:["abpPermissionManagement"],decls:3,vars:7,consts:[[3,"visible","busy","visibleChange","init"],[4,"ngIf"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"custom-checkbox","custom-control","mb-2"],["type","checkbox","id","select-all-in-all-tabs","name","select-all-in-all-tabs",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","select-all-in-all-tabs",1,"custom-control-label"],[1,"mt-2","mb-2"],[1,"row"],[1,"overflow-scroll","col-md-4"],[1,"nav","nav-pills","flex-column"],["class","nav-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-8","overflow-scroll"],[1,"mt-2","mb-3"],[1,"pl-1","pt-1"],["type","checkbox","id","select-all-in-this-tabs","name","select-all-in-this-tabs",1,"custom-control-input",3,"ngModel","ngModelChange","click"],["for","select-all-in-this-tabs",1,"custom-control-label"],[1,"mb-3"],["class","custom-checkbox custom-control mb-2",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nav-item"],["class","nav-link pointer",3,"active","click",4,"ngIf"],[1,"nav-link","pointer",3,"click"],[1,"custom-checkbox","custom-control","mb-2",3,"ngStyle"],["type","checkbox",1,"custom-control-input",3,"checked","value","disabled"],["permissionCheckbox",""],[1,"custom-control-label",3,"click"],["class","badge badge-light",4,"ngFor","ngForOf"],[1,"badge","badge-light"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"click"]],template:function(e,n){1&e&&(c.TgZ(0,"abp-modal",0),c.NdJ("visibleChange",function(e){return n.visible=e})("init",function(){return n.initModal()}),c.YNc(1,P,7,0,"ng-container",1),c.ALo(2,"async"),c.qZA()),2&e&&(c.Q6J("visible",n.visible)("busy",n.modalBusy),c.xp6(1),c.Q6J("ngIf",c.VKq(5,S,c.lcZ(2,3,n.entityName$))))},directives:[a.zS,b.O5,y.Wl,y.JJ,y.On,b.sg,b.PC,a.r0],pipes:[b.Ov,o.fuE],styles:[".overflow-scroll[_ngcontent-%COMP%] {\n        max-height: 70vh;\n        overflow-y: scroll;\n      }"]}),(0,u.gn)([(0,l.Ph)(F.getPermissionGroups)],n.prototype,"groups$",void 0),(0,u.gn)([(0,l.Ph)(F.getEntityDisplayName)],n.prototype,"entityName$",void 0),n}();function U(e,n){var t=e.find(function(e){return e.name===n.parentName});return t&&t.parentName?20+U(e,t):t?20:0}function B(n){return n.reduce(function(n,t){return[].concat(e(n),e(t.permissions))},[])}var J=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[o.IR2,a.e2,l.$l.forFeature([F])]]}),e}()},83588:function(e,n,t){"use strict";t.d(n,{j:function(){return r}});var i=t(79996);function r(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r=n.length;if(0===r)throw new Error("list of properties cannot be empty.");return function(e){return(0,i.U)(function(e,n){return function(t){for(var i=t,r=0;r<n;r++){var s=null!=i?i[e[r]]:void 0;if(void 0===s)return;i=s}return i}}(n,r))(e)}}}}])}();