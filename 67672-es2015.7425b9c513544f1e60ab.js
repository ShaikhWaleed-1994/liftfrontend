(self.webpackChunkPhysic=self.webpackChunkPhysic||[]).push([[67672,55e3],{67672:function(e,t,i){"use strict";i.r(t),i.d(t,{InvoiceModule:function(){return F}});var o=i(46700),n=i(55679),a=i(10135),s=i(99046),c=i(83845),l=i(73756),r=i(56410),p=i(2996),u=i(43835),d=i(44689),g=i(35366);let v=(()=>{class e{constructor(e){this.restService=e,this.apiName="Default",this.revalidateInvoiceReport=e=>this.restService.request({method:"POST",url:"/api/app/invoices/revalidate-invoice-report",body:e},{apiName:this.apiName}),this.approve=e=>this.restService.request({method:"POST",url:"/api/app/invoices/approve-invoice",body:e},{apiName:this.apiName}),this.approveAllPendingInvoicesByDays=e=>this.restService.request({method:"POST",url:"/api/app/invoices/ApproveAllPendingInvoices",params:{days:e}},{apiName:this.apiName}),this.getAppUserLookup=e=>this.restService.request({method:"GET",url:"/api/app/invoices/app-user-lookup",params:{filter:e.filter,skipCount:e.skipCount,maxResultCount:e.maxResultCount}},{apiName:this.apiName}),this.getGeneralLookupLookup=e=>this.restService.request({method:"GET",url:"/api/app/invoices/general-lookup-lookup",params:{filter:e.filter,skipCount:e.skipCount,maxResultCount:e.maxResultCount}},{apiName:this.apiName}),this.getInvoicesNeedToApproveByDays=e=>this.restService.request({method:"GET",url:"/api/app/invoices/GetInvoicesNeedToApprove",params:{days:e}},{apiName:this.apiName}),this.getList=e=>this.restService.request({method:"GET",url:"/api/app/invoices",params:{invoicesId:e.invoicesId,filterText:e.filterText,tap_id:e.tap_id,appUserId:e.appUserId,invoiceStatusGeneralLookupId:e.invoiceStatusGeneralLookupId,invoiceTypeGeneralLookupId:e.invoiceTypeGeneralLookupId,sorting:e.sorting,skipCount:e.skipCount,maxResultCount:e.maxResultCount}},{apiName:this.apiName}),this.recheckInvoice=e=>this.restService.request({method:"POST",url:"/api/app/invoices/recheck-invoice",body:e},{apiName:this.apiName})}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(o.vgb))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Z=i(31041),m=i(23733),h=i(42163),A=i(17647),f=i(61116),T=i(55e3);function b(e,t){if(1&e&&(g.TgZ(0,"span",45),g._uU(1),g.qZA()),2&e){const e=g.oxw().row;g.xp6(1),g.hij(" ",e.invoice.tap_id," ")}}function q(e,t){if(1&e&&(g.YNc(0,b,2,1,"span",41),g.TgZ(1,"div",42),g._uU(2),g.ALo(3,"abpLocalization"),g.qZA(),g.TgZ(4,"span",43),g._UZ(5,"is-empty",44),g.qZA()),2&e){const e=t.row;g.Q6J("ngIf",e.invoice.tap_id),g.xp6(2),g.Oqu(g.lcZ(3,3,"::InvoiceRef")),g.xp6(3),g.Q6J("value",e.invoice.id)}}function x(e,t){if(1&e&&(g.TgZ(0,"div",42),g._uU(1),g.ALo(2,"abpLocalization"),g.qZA(),g.TgZ(3,"span",43),g._UZ(4,"is-empty",44),g.ALo(5,"date"),g.qZA()),2&e){const e=t.row;g.xp6(1),g.Oqu(g.lcZ(2,2,"::CreationTime")),g.xp6(3),g.Q6J("value",g.xi3(5,4,e.invoice.creationTime,"yyyy/MM/dd h:mm a "))}}function L(e,t){if(1&e&&(g.TgZ(0,"div",42),g._uU(1),g.ALo(2,"abpLocalization"),g.qZA(),g.TgZ(3,"span",43),g._UZ(4,"is-empty",44),g.ALo(5,"date"),g.qZA()),2&e){const e=t.row;g.xp6(1),g.Oqu(g.lcZ(2,2,"::lastModificationTime")),g.xp6(3),g.Q6J("value",g.xi3(5,4,e.invoice.lastModificationTime,"yyyy/MM/dd h:mm a "))}}function y(e,t){if(1&e&&(g.TgZ(0,"div",42),g._uU(1),g.ALo(2,"abpLocalization"),g.qZA(),g.TgZ(3,"span",43),g._UZ(4,"is-empty",44),g.qZA()),2&e){const e=t.row;g.xp6(1),g.Oqu(g.lcZ(2,2,"::Promocode")),g.xp6(3),g.Q6J("value",e.invoice.promocode)}}function k(e,t){if(1&e&&(g.TgZ(0,"div",42),g._uU(1),g.ALo(2,"abpLocalization"),g.qZA(),g.TgZ(3,"span",43),g._UZ(4,"is-empty",44),g.qZA()),2&e){const e=t.row;g.xp6(1),g.Oqu(g.lcZ(2,2,"::Discount")),g.xp6(3),g.Q6J("value",e.invoice.discount)}}function I(e,t){if(1&e&&(g.TgZ(0,"div",42),g._uU(1),g.ALo(2,"abpLocalization"),g.qZA(),g.TgZ(3,"span",43),g._UZ(4,"is-empty",44),g.qZA()),2&e){const e=t.row;g.xp6(1),g.Oqu(g.lcZ(2,2,"::Amount")),g.xp6(3),g.Q6J("value",e.invoice.amount)}}function U(e,t){if(1&e&&g._uU(0),2&e){const e=t.row;g.hij(" ",null==e.appUser?null:e.appUser.name," ")}}function C(e,t){if(1&e&&(g.TgZ(0,"div",46),g._uU(1),g.qZA(),g.TgZ(2,"div",46),g._uU(3),g.qZA()),2&e){const e=t.row;g.xp6(1),g.hij(" ",null==e.generalLookup?null:e.generalLookup.generalLookupName," "),g.xp6(2),g.hij(" ",null==e.generalLookup1?null:e.generalLookup1.generalLookupName," ")}}function w(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",48),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().row;return g.oxw().approve(t)}),g._UZ(1,"i",49),g.TgZ(2,"div"),g._uU(3),g.ALo(4,"abpLocalization"),g.qZA(),g.qZA()}2&e&&(g.xp6(3),g.Oqu(g.lcZ(4,1,"::Approve")))}function _(e,t){if(1&e){const e=g.EpF();g.YNc(0,w,5,3,"div",47),g.TgZ(1,"div",48),g.NdJ("click",function(){const t=g.CHM(e).row;return g.oxw().revalidateInvoiceReport(t)}),g._UZ(2,"i",49),g.TgZ(3,"div"),g._uU(4),g.ALo(5,"abpLocalization"),g.qZA(),g.qZA()}2&e&&(g.Q6J("ngIf",38!==t.row.invoice.invoiceStatusGeneralLookupId),g.xp6(4),g.Oqu(g.lcZ(5,2,"::revalidateInvoiceReport")))}const N=function(){return{standalone:!0}},M=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,a){this.list=e,this.track=t,this.service=i,this.confirmation=o,this.dateService=n,this.fb=a,this.data={items:[],totalCount:0},this.filters={},this.isFiltersHidden=!0,this.isModalBusy=!1,this.isModalOpen=!1}get showFilter(){return this._showFilter}set showFilter(e){this._showFilter=e,this.isFiltersHidden=!e}ngOnInit(){this.list.hookToQuery(e=>{let t=Object.assign({},this.filters),i=t.appUserId;return i&&i.id&&(t.appUserId=i.id),this.service.getList(Object.assign(Object.assign(Object.assign({},e),t),{filterText:e.filter}))}).subscribe(e=>this.data=e)}clearFilters(){this.filters={},this.list.get()}buildForm(){var e;const{tap_id:t,promocode:i,discount:o,appUserId:n,invoiceStatusGeneralLookupId:a,invoiceTypeGeneralLookupId:s}=(null===(e=this.selected)||void 0===e?void 0:e.invoice)||{};this.form=this.fb.group({tap_id:[null!=t?t:null,[]],promocode:[null!=i?i:null,[]],discount:[null!=o?o:null,[]],appUserId:[null!=n?n:null,[]],invoiceStatusGeneralLookupId:[null!=a?a:null,[]],invoiceTypeGeneralLookupId:[null!=s?s:null,[]]})}hideForm(){this.isModalOpen=!1,this.form.reset()}showForm(){this.buildForm(),this.isModalOpen=!0}submitForm(){}create(){this.selected=void 0,this.showForm()}update(e){this.selected=e,this.showForm()}approve(e){let t={};t.invoiceId=e.invoice.id,this.confirmation.warn("::MarkAsPaid","::AreYouSure",{messageLocalizationParams:[]}).pipe((0,u.h)(e=>e===n.Tv.Status.confirm),(0,d.w)(()=>this.service.approve(t))).subscribe(this.list.get)}revalidateInvoiceReport(e){let t={};t.invoiceId=e.invoice.id,this.confirmation.warn("::MarkAsPaid","::AreYouSure",{messageLocalizationParams:[]}).pipe((0,u.h)(e=>e===n.Tv.Status.confirm),(0,d.w)(()=>this.service.revalidateInvoiceReport(t))).subscribe(this.list.get)}startSearchUserByType(e){let t={};t.filter=e.query,this.service.getAppUserLookup(t).subscribe(e=>{this.AllUsers=e.items})}onSelect(e){}onClear(){this.filters.appUserId=void 0}searchType(){return/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)?"text":"search"}checkInvoice(){if(this.invoiceIdToCheck){let e={};e.invoicesId=this.invoiceIdToCheck,this.service.recheckInvoice(e).subscribe(e=>{1===e.paymentResult?alert("Success"):2===e.paymentResult?alert("InternalError"):3===e.paymentResult?alert("PaymentNotValid"):alert("Checking invoices is in progress, this may takes 10 minutes")})}}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(o.XNV),g.Y36(o.vR3),g.Y36(v),g.Y36(n.YP),g.Y36(p.R),g.Y36(Z.qu))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-invoice"]],features:[g._Bn([o.XNV,p.R])],decls:99,vars:77,consts:[[1,"row","entry-row","align-items-center"],[1,"col-12","col-sm-auto","content-header-container"],[1,"content-header-title","custom-green"],[1,"col-lg-auto","pl-lg-0"],[1,"col-lg"],[1,"text-lg-right","pt-2"],[1,"custom-control","custom-switch"],["type","checkbox","id","customSwitch1",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","customSwitch1",1,"custom-control-label"],[1,"col-auto"],["id","advanced-content-filters",3,"ngbCollapse"],[1,"card","mb-4"],[1,"card-body"],[3,"keyup.enter"],["filterForm",""],[1,"row"],[1,"col-md-4","col-sm-auto"],[1,"form-group"],["for","InvoiceIdsFilter"],["id","InvoiceIdsFilter",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["for","tap_idFilter"],["id","tap_idFilter",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["id","appUserIdFilter","name","appUserIdFilter","dataKey","id","field","displayName","forceSelection","true",1,"",3,"ngModel","ngModelOptions","suggestions","type","dropdown","placeholder","ngModelChange","onClear","completeMethod","search"],[1,"col-md-12","align-self-end","mb-3"],[1,"col"],["type","button",1,"btn","btn-outline-primary","btn-block",3,"click"],["type","button",1,"btn","btn-primary","btn-block",3,"click"],[1,"card"],["for","filterTextFilter"],[1,"input-group"],["id","filterTextFilter",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-success",3,"click"],["default","",1,"app-dataview",3,"rows","count","list"],["prop","invoice.amount",3,"name"],["ngx-datatable-cell-template",""],["prop","invoice.promocode",3,"name"],["prop","invoice.discount",3,"name"],["prop","appUser.name",3,"name"],["prop","generalLookup.generalLookupName",3,"name"],[3,"name","maxWidth","width","sortable"],["class","invoiceId","class","id-icon bg-primary",4,"ngIf"],[1,"custom-gray","custom-600"],[1,"custom-black","custom-600"],[3,"value"],[1,"id-icon","bg-primary"],[1,"badge","badge-info"],["class","action-item",3,"click",4,"ngIf"],[1,"action-item",3,"click"],[1,"fa","fa-check","custom-green","action-boarder"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"h1",2),g._uU(3),g.ALo(4,"abpLocalization"),g.qZA(),g._UZ(5,"abp-breadcrumb"),g.qZA(),g._UZ(6,"div",3),g.TgZ(7,"div",4),g.TgZ(8,"div",5),g.TgZ(9,"div",6),g.TgZ(10,"input",7),g.NdJ("ngModelChange",function(e){return t.showFilter=e}),g.qZA(),g.TgZ(11,"label",8),g._uU(12),g.ALo(13,"abpLocalization"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"div",9),g._UZ(15,"div",5),g.qZA(),g.qZA(),g.TgZ(16,"div",10),g.TgZ(17,"div",11),g.TgZ(18,"div",12),g.TgZ(19,"form",13,14),g.NdJ("keyup.enter",function(){return t.list.get()}),g.TgZ(21,"div",15),g.TgZ(22,"div",16),g.TgZ(23,"div",17),g.TgZ(24,"label",18),g._uU(25),g.ALo(26,"abpLocalization"),g.qZA(),g.TgZ(27,"textarea",19),g.NdJ("ngModelChange",function(e){return t.filters.invoicesId=e}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(28,"div",16),g.TgZ(29,"div",17),g.TgZ(30,"label",20),g._uU(31),g.ALo(32,"abpLocalization"),g.qZA(),g.TgZ(33,"input",21),g.NdJ("ngModelChange",function(e){return t.filters.tap_id=e}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(34,"div",16),g.TgZ(35,"div",17),g.TgZ(36,"label"),g._uU(37),g.ALo(38,"abpLocalization"),g.qZA(),g.TgZ(39,"p-autoComplete",22),g.NdJ("ngModelChange",function(e){return t.filters.appUserId=e})("onClear",function(){return t.onClear()})("completeMethod",function(e){return t.startSearchUserByType(e)})("search",function(e){return t.startSearchUserByType(e)}),g.ALo(40,"abpLocalization"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(41,"div",16),g._UZ(42,"div",17),g.qZA(),g.TgZ(43,"div",16),g._UZ(44,"div",17),g.qZA(),g.TgZ(45,"div",23),g.TgZ(46,"div",15),g._UZ(47,"div",24),g.TgZ(48,"div",9),g.TgZ(49,"button",25),g.NdJ("click",function(){return t.clearFilters()}),g.TgZ(50,"span"),g._uU(51),g.ALo(52,"abpLocalization"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(53,"div",9),g.TgZ(54,"button",26),g.NdJ("click",function(){return t.list.get()}),g.TgZ(55,"span"),g._uU(56),g.ALo(57,"abpLocalization"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(58,"div",27),g.TgZ(59,"div",12),g.TgZ(60,"div",15),g.TgZ(61,"div",24),g.TgZ(62,"div",17),g.TgZ(63,"label",28),g._uU(64),g.ALo(65,"abpLocalization"),g.qZA(),g.TgZ(66,"div",29),g.TgZ(67,"textarea",30),g.NdJ("ngModelChange",function(e){return t.invoiceIdToCheck=e}),g.qZA(),g.TgZ(68,"div",31),g.TgZ(69,"button",32),g.NdJ("click",function(){return t.checkInvoice()}),g._uU(70,"Check"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(71,"ngx-datatable",33),g.TgZ(72,"ngx-datatable-column",34),g.ALo(73,"abpLocalization"),g.YNc(74,q,6,5,"ng-template",35),g.qZA(),g.TgZ(75,"ngx-datatable-column",34),g.ALo(76,"abpLocalization"),g.YNc(77,x,6,7,"ng-template",35),g.qZA(),g.TgZ(78,"ngx-datatable-column",34),g.ALo(79,"abpLocalization"),g.YNc(80,L,6,7,"ng-template",35),g.qZA(),g.TgZ(81,"ngx-datatable-column",36),g.ALo(82,"abpLocalization"),g.YNc(83,y,5,4,"ng-template",35),g.qZA(),g.TgZ(84,"ngx-datatable-column",37),g.ALo(85,"abpLocalization"),g.YNc(86,k,5,4,"ng-template",35),g.qZA(),g.TgZ(87,"ngx-datatable-column",34),g.ALo(88,"abpLocalization"),g.YNc(89,I,5,4,"ng-template",35),g.qZA(),g.TgZ(90,"ngx-datatable-column",38),g.ALo(91,"abpLocalization"),g.YNc(92,U,1,1,"ng-template",35),g.qZA(),g.TgZ(93,"ngx-datatable-column",39),g.ALo(94,"abpLocalization"),g.YNc(95,C,4,2,"ng-template",35),g.qZA(),g.TgZ(96,"ngx-datatable-column",40),g.ALo(97,"abpLocalization"),g.YNc(98,_,6,4,"ng-template",35),g.qZA(),g.qZA()),2&e&&(g.xp6(3),g.Oqu(g.lcZ(4,37,"::Invoices")),g.xp6(7),g.Q6J("ngModel",t.showFilter),g.xp6(2),g.Oqu(g.lcZ(13,39,"::SeeAdvancedFilters")),g.xp6(4),g.Q6J("ngbCollapse",t.isFiltersHidden),g.xp6(9),g.hij(" ",g.lcZ(26,41,"::InvoiceIds")," "),g.xp6(2),g.Q6J("ngModel",t.filters.invoicesId)("ngModelOptions",g.DdM(73,N)),g.xp6(4),g.hij(" ",g.lcZ(32,43,"::tap_id")," "),g.xp6(2),g.Q6J("ngModel",t.filters.tap_id)("ngModelOptions",g.DdM(74,N)),g.xp6(4),g.hij(" ",g.lcZ(38,45,"::PaidBy")," "),g.xp6(2),g.s9C("placeholder",g.lcZ(40,47,"::PaidBy")),g.Q6J("ngModel",t.filters.appUserId)("ngModelOptions",g.DdM(75,N))("suggestions",t.AllUsers)("type",t.searchType())("dropdown",!0),g.xp6(12),g.Oqu(g.lcZ(52,49,"AbpUi::Clear")),g.xp6(5),g.Oqu(g.lcZ(57,51,"::Search")),g.xp6(8),g.hij(" ",g.lcZ(65,53,"::CheckFor")," "),g.xp6(3),g.Q6J("ngModel",t.invoiceIdToCheck)("ngModelOptions",g.DdM(76,N)),g.xp6(4),g.Q6J("rows",t.data.items)("count",t.data.totalCount)("list",t.list),g.xp6(1),g.s9C("name",g.lcZ(73,55,"::Amount")),g.xp6(3),g.s9C("name",g.lcZ(76,57,"::Amount")),g.xp6(3),g.s9C("name",g.lcZ(79,59,"::Amount")),g.xp6(3),g.s9C("name",g.lcZ(82,61,"::Promocode")),g.xp6(3),g.s9C("name",g.lcZ(85,63,"::Discount")),g.xp6(3),g.s9C("name",g.lcZ(88,65,"::Amount")),g.xp6(3),g.s9C("name",g.lcZ(91,67,"::AppUser")),g.xp6(3),g.s9C("name",g.lcZ(94,69,"::GeneralLookup")),g.xp6(3),g.Q6J("name",g.lcZ(97,71,"AbpUi::Actions"))("maxWidth",200)("width",200)("sortable",!1))},directives:[n.LI,Z.Wl,Z.JJ,Z.On,m.m,a._D,Z._Y,Z.JL,Z.F,Z.Fj,h.Qc,A.nE,n.x7,n.j3,A.UC,A.vq,f.O5,T.K],pipes:[o.fuE,f.uU],encapsulation:2}),e})(),canActivate:[o.a1M,o.nG9]}];let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[r.Bz.forChild(M)],r.Bz]}),e})();var z=i(56137);let F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[S,o.IR2,n.e2,l.Ck,c.vv,s.h2,a.lQ,a.M,z.m,a.XC]]}),e})()},55e3:function(e,t,i){"use strict";i.d(t,{K:function(){return p}});var o=i(46700),n=i(2996),a=i(35366),s=i(61116);function c(e,t){if(1&e&&(a.TgZ(0,"span",2),a.TgZ(1,"span"),a._uU(2),a.qZA(),a.Hsn(3),a.qZA()),2&e){const e=a.oxw();a.xp6(2),a.Oqu(e.parsedDate)}}function l(e,t){if(1&e&&(a.TgZ(0,"span",3),a._uU(1),a.qZA()),2&e){const e=a.oxw();a.xp6(1),a.hij(" ",e.l("NotFound"),"\n")}}const r=["*"];let p=(()=>{class e{constructor(e,t){this.dateService=t,this.localization=e.get(o.oQ8)}get value(){return this._value}set value(e){this._value=e,this.parsedDate=this.value instanceof Date?this.dateService.parseDate(e):e}l(e){return this.localization.instant("::"+e)}isNotEmpty(){return!!this.value&&("string"!=typeof this.value||this.value.length>0)}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.zs3),a.Y36(n.R))},e.\u0275cmp=a.Xpm({type:e,selectors:[["is-empty"]],inputs:{value:"value"},features:[a._Bn([n.R])],ngContentSelectors:r,decls:2,vars:2,consts:[["class","sw-dv-details",4,"ngIf"],["class","sw-dv-details empty-value custom-gray","style","font-size: 12px;font-style: italic;",4,"ngIf"],[1,"sw-dv-details"],[1,"sw-dv-details","empty-value","custom-gray",2,"font-size","12px","font-style","italic"]],template:function(e,t){1&e&&(a.F$t(),a.YNc(0,c,4,1,"span",0),a.YNc(1,l,2,1,"span",1)),2&e&&(a.Q6J("ngIf",t.isNotEmpty()),a.xp6(1),a.Q6J("ngIf",!t.isNotEmpty()))},directives:[s.O5],encapsulation:2}),e})()}}]);